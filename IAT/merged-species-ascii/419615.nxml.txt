###begin article-title 0
###xml 51 54 51 54 <italic xmlns:xlink="http://www.w3.org/1999/xlink">cis</italic>
Identification of sparsely distributed clusters of cis-regulatory elements in sets of co-expressed genes
###end article-title 0
###begin p 1
###xml 51 66 51 66 <email xmlns:xlink="http://www.w3.org/1999/xlink">kreiman@mit.edu</email>
Tel: +1 617 253 0547; Fax: +1 617 253 2964; Email: kreiman@mit.edu
###end p 1
###begin p 2
###xml 362 365 362 365 <italic xmlns:xlink="http://www.w3.org/1999/xlink">cis</italic>
###xml 968 974 <span type="species:ncbi:4932">yeasts</span>
###xml 986 992 <span type="species:ncbi:9606">humans</span>
Sequence information and high-throughput methods to measure gene expression levels open the door to explore transcriptional regulation using computational tools. Combinatorial regulation and sparseness of regulatory elements throughout the genome allow organisms to control the spatial and temporal patterns of gene expression. Here we study the organization of cis-regulatory elements in sets of co-regulated genes. We build an algorithm to search for combinations of transcription factor binding sites that are enriched in a set of potentially co-regulated genes with respect to the whole genome. No knowledge is assumed about involvement of specific sets of transcription factors. Instead, the search is exhaustively conducted over combinations of up to four binding sites obtained from databases or motif search algorithms. We evaluate the performance on random sets of genes as a negative control and on three biologically validated sets of co-regulated genes in yeasts, flies and humans. We show that we can detect DNA regions that play a role in the control of transcription. These results shed light on the structure of transcription regulatory regions in eukaryotes and can be directly applied to clusters of co-expressed genes obtained in gene expression studies. Supplementary information is available at .
###end p 2
###begin title 3
INTRODUCTION
###end title 3
###begin p 4
Transcriptional regulation plays a fundamental role in many biological processes ranging from development to immunity to learning and memory. Recent sequencing efforts suggest that the total number of genes does not correlate well with the behavioral complexity of an organism. This complexity may arise, partly at least, from more intricate genetic regulatory mechanisms. Two recent sources of information promise to accelerate progress in our understanding of gene expression and its regulation. First, we now have sequence information from multiple species. Second, it is now possible to interrogate the expression levels of thousands of genes simultaneously. Combining these two types of data allows us to ask which sequence elements govern the levels of mRNA molecules.
###end p 4
###begin p 5
###xml 142 143 142 143 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="bibr" rid="gkh614c1">1</xref>
###xml 144 145 144 145 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="bibr" rid="gkh614c4">4</xref>
###xml 245 248 245 248 <italic xmlns:xlink="http://www.w3.org/1999/xlink">cis</italic>
###xml 501 502 501 502 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="bibr" rid="gkh614c5">5</xref>
###xml 704 705 704 705 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="bibr" rid="gkh614c6">6</xref>
###xml 706 707 706 707 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="bibr" rid="gkh614c7">7</xref>
###xml 1051 1052 1051 1052 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="bibr" rid="gkh614c8">8</xref>
###xml 1053 1054 1053 1054 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="bibr" rid="gkh614c9">9</xref>
Gene expression by RNA polymerase II is orchestrated by multiple protein transcription factors (TFs) that bind specific sequences in the DNA (1-4). We refer to the DNA sequences to which these factors bind to enhance or inhibit transcription as cis elements. Three specific aspects of the TF-DNA interaction complicate the computational search for regulatory elements. Binding sites for a given TF are quite variable and we generally lack accurate models of the binding energy between the TF and DNA (5). Furthermore, TFs can bind DNA near the transcriptional start site (TSS), usually called the promoter region, but they can also act at a distance of tens of thousands of base pairs away from the TSS (6,7). These long-distance interactions substantially increase the noise in any procedure to search for regulatory elements. Finally, groups of TFs may cluster along the DNA to form modules responsible for specific regulatory roles and therefore the binding affinity of a particular TF may also depend on the sequence surrounding its binding site (8,9).
###end p 5
###begin p 6
###xml 118 120 118 120 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="bibr" rid="gkh614c10">10</xref>
###xml 121 123 121 123 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="bibr" rid="gkh614c15">15</xref>
###xml 672 673 672 673 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="bibr" rid="gkh614c3">3</xref>
###xml 674 675 674 675 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="bibr" rid="gkh614c8">8</xref>
###xml 676 677 676 677 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="bibr" rid="gkh614c9">9</xref>
###xml 678 680 678 680 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="bibr" rid="gkh614c16">16</xref>
###xml 996 998 996 998 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="bibr" rid="gkh614c17">17</xref>
###xml 267 273 <span type="species:ncbi:4932">yeasts</span>
###xml 488 494 <span type="species:ncbi:9606">humans</span>
###xml 498 502 <span type="species:ncbi:10090">mice</span>
###xml 515 520 <span type="species:ncbi:4932">yeast</span>
###xml 878 883 <span type="species:ncbi:9606">human</span>
Several computational techniques to search for individual TF binding sites, here called 'motifs', have been proposed (10-15). Some of these techniques have achieved considerable degrees of success, particularly when applied to sequences from prokaryotic organisms or yeasts, although in some cases the false positive rates still remain high. The extrapolation of these techniques to higher eukaryotes like mammals remains difficult for several reasons. Non-coding sequences are longer in humans or mice compared to yeast. Additionally, in several paradigmatic examples, transcriptional regulation has been shown to require the combinatorial interplay of multiple factors (3,8,9,16). The binding of a single TF in general cannot account for the complex spatial and temporal regulation of gene expression in higher eukaryotes. As an example, p65 was found to bind to 209 sites on human chromosome 22 alone by ChIP-chip analysis. Furthermore, it did not affect transcription at many of those sites (17).
###end p 6
###begin p 7
###xml 240 242 240 242 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="bibr" rid="gkh614c18">18</xref>
###xml 243 245 243 245 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="bibr" rid="gkh614c25">25</xref>
In some cases, the investigators know or strongly suspect that a particular group of TFs plays a role in the transcriptional regulation of the set of genes under study. Several algorithms have been proposed recently to study this scenario (18-25). Here we address a different variant of the problem where the biologist is faced with a set of genes without any knowledge about the TFs involved in their regulation. This setting may arise, for example, in a DNA microarray experiment where one of the outputs is a cluster of genes that share a similar expression pattern.
###end p 7
###begin p 8
###xml 128 131 128 131 <italic xmlns:xlink="http://www.w3.org/1999/xlink">cis</italic>
###xml 309 310 309 310 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="bibr" rid="gkh614c1">1</xref>
###xml 311 312 311 312 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="bibr" rid="gkh614c8">8</xref>
###xml 313 314 313 314 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="bibr" rid="gkh614c9">9</xref>
###xml 724 726 724 726 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="bibr" rid="gkh614c26">26</xref>
###xml 727 729 727 729 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="bibr" rid="gkh614c29">29</xref>
###xml 931 934 931 934 <italic xmlns:xlink="http://www.w3.org/1999/xlink">cis</italic>
###xml 1003 1004 1003 1004 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="fig" rid="gkh614f1">1</xref>
###xml 1317 1325 1317 1325 <italic xmlns:xlink="http://www.w3.org/1999/xlink">a priori</italic>
###xml 1193 1198 <span type="species:ncbi:4932">yeast</span>
###xml 1202 1208 <span type="species:ncbi:9606">humans</span>
Combinatorial regulation of transcription and sparseness of regulatory modules in the whole genome underlie the organization of cis elements in complex eukaryotic systems. Multiple TF binding sites are clustered together along the DNA forming modules that are required to control the expression of each gene (1,8,9). These modules of regulatory elements should occur infrequently throughout the whole genome. The rationale for this is that specificity requires a sparse code. Here we show that combinatorial regulation and sparseness can guide the search for regulatory elements in higher eukaryotes. The evolutionary conservation of important regulatory elements has been discussed and applied extensively (see for example 26-29). We therefore do not discuss comparisons across species in detail here but we incorporate conservation between species into our algorithm. We combine these three ideas into an algorithm to search for cis regulatory elements in sets of potentially co-regulated genes (Fig. 1). We illustrate the performance of the algorithm on random sets of genes as a negative control as well as on three separate sets of biologically validated co-regulated genes, ranging from yeast to humans. We show that we can correctly find many of the known regulatory regions in these sets of genes without any a priori knowledge about which TFs are involved or where to search.
###end p 8
###begin title 9
MATERIALS AND METHODS
###end title 9
###begin title 10
General overview
###end title 10
###begin p 11
###xml 12 13 12 13 <italic xmlns:xlink="http://www.w3.org/1999/xlink">S</italic>
###xml 17 18 17 18 <italic xmlns:xlink="http://www.w3.org/1999/xlink">n</italic>
###xml 18 19 18 19 <sub xmlns:xlink="http://www.w3.org/1999/xlink">S</sub>
###xml 175 176 175 176 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="fig" rid="gkh614f1">1</xref>
###xml 690 692 690 692 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="bibr" rid="gkh614c30">30</xref>
###xml 757 759 757 759 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="bibr" rid="gkh614c24">24</xref>
###xml 826 828 826 828 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="bibr" rid="gkh614c31">31</xref>
###xml 879 880 879 880 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="table" rid="gkh614tb2">2</xref>
###xml 682 688 <span type="species:ncbi:4932">yeasts</span>
###xml 803 808 <span type="species:ncbi:9606">human</span>
Given a set S of nS potentially co-regulated genes, our algorithm searches for common sequence patterns that occur more frequently than expected by chance (see scheme in Fig. 1). The search is based on locating co-occurrences of putative binding sites for TFs within short segments of DNA and ensuring that the co-occurring motifs are sparsely distributed throughout the genome. We tested the algorithm on different sequence sources including (i) artificial sequences with implanted modules, (ii) random sets of genes (negative control) and (iii) experimentally validated systems encompassing a wide range of sequence characteristics (positive controls): (iiia) the CLB2 cluster in yeasts (30), (iiib) a set of genes involved in pattern formation in flies (24) and (iiic) a set of genes co-expressed in human skeletal muscle (31). The list of genes in each set is shown in Table 2. Further characterization of the algorithm, performance details and a list of results for the different data sets are available as supplementary information at . All the code is available upon request from the authors.
###end p 11
###begin title 12
Sequences
###end title 12
###begin p 13
###xml 62 86 62 86 <italic xmlns:xlink="http://www.w3.org/1999/xlink">Saccharomyces cerevisiae</italic>
###xml 191 214 191 214 <italic xmlns:xlink="http://www.w3.org/1999/xlink">Drosophila melanogaster</italic>
###xml 873 875 873 875 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="bibr" rid="gkh614c13">13</xref>
###xml 876 878 876 878 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="bibr" rid="gkh614c26">26</xref>
###xml 879 881 879 881 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="bibr" rid="gkh614c32">32</xref>
###xml 882 884 882 884 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="bibr" rid="gkh614c33">33</xref>
###xml 973 975 973 975 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="bibr" rid="gkh614c34">34</xref>
###xml 62 86 <span type="species:ncbi:4932">Saccharomyces cerevisiae</span>
###xml 128 133 <span type="species:ncbi:9606">human</span>
###xml 138 142 <span type="species:ncbi:10090">mice</span>
###xml 191 214 <span type="species:ncbi:7227">Drosophila melanogaster</span>
###xml 730 735 <span type="species:ncbi:4932">yeast</span>
###xml 865 871 <span type="species:ncbi:4932">yeasts</span>
###xml 895 900 <span type="species:ncbi:9606">human</span>
###xml 905 910 <span type="species:ncbi:10090">mouse</span>
###xml 1005 1010 <span type="species:ncbi:10090">mouse</span>
###xml 1015 1020 <span type="species:ncbi:9606">human</span>
Sequences were retrieved from the following sources:  for the Saccharomyces cerevisiae sequences (release 01-21-2003);  for the human and mice RefSeq sequences (release 06-21-2003);  for the Drosophila melanogaster sequences (release 01-07-2003). The corresponding annotations were used to retrieve the best current estimation of the TSS for each gene. In cases of multiple alternative start sites, we used the one farthest upstream. We included in our search the upstream sequences, the first exon and the first intron. We restricted the search to the 5000 bp upstream of the TSS (see Discussion). If the first exon or intron was longer than 5000 bp they were trimmed to retain the 5000 bp closest to the TSS. In the CLB2 set in yeast the search was restricted to 1000 bp upstream of the TSS (extensive evidence suggests that this is the most important region for yeasts; 13,26,32,33). For the human and mouse genes, we restricted our analysis to the RefSeq set of genes (34). For the comparison between mouse and human genes, the orthology information was retrieved from the NCBI HomoloGene list ().
###end p 13
###begin title 14
Motif models and scanning
###end title 14
###begin p 15
###xml 177 178 177 178 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="bibr" rid="gkh614c5">5</xref>
###xml 179 181 179 181 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="bibr" rid="gkh614c35">35</xref>
###xml 356 357 356 357 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="bibr" rid="gkh614c5">5</xref>
###xml 358 360 358 360 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="bibr" rid="gkh614c36">36</xref>
###xml 486 488 486 488 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="bibr" rid="gkh614c37">37</xref>
###xml 601 603 601 603 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="bibr" rid="gkh614c13">13</xref>
###xml 612 614 612 614 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="bibr" rid="gkh614c12">12</xref>
###xml 634 636 634 636 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="bibr" rid="gkh614c11">11</xref>
###xml 723 724 723 724 <italic xmlns:xlink="http://www.w3.org/1999/xlink">S</italic>
###xml 806 811 <span type="species:ncbi:9606">human</span>
###xml 954 959 <span type="species:ncbi:10090">mouse</span>
###xml 1473 1478 <span type="species:ncbi:10090">mouse</span>
###xml 1480 1485 <span type="species:ncbi:9606">human</span>
###xml 1512 1517 <span type="species:ncbi:4932">yeast</span>
We used position weight matrices (PWM) to model the binding specificity of each motif. PWMs take into account the frequency of each nucleotide (A, C, G and T) at each position (5,35). PWMs assume independence between different nucleotide positions and attempt to provide a first level approximation of the interaction energy of a TF with its binding site (5,36). We used two sources of PWMs: (i) from a database of known transcription factor binding sites, TRANSFAC public release 6.0 (37); (ii) putative novel motifs. The novel motifs were obtained by using three motif-finding algorithms: alignACE (13), MEME (12) and MotifSampler (11). The input to the motif-finding algorithms was the set of sequences for the genes in S (the boundaries for the sequences were defined in the previous section). For the human muscle set, we ran the motif-finding algorithms on both the raw sequences and the sequences after masking those segments not conserved in the mouse orthologs. Sequence conservation was determined using BLAST. The parameters for alignACE were -numcols 10 and the GC frequency. The parameters for MEME were -minw 6, -maxw 20, -dna, -mod tcm, -nmotifs 100, -evt 1, -minsites 3, -maxsites 500, 6th order background model and -revcomp. The parameters for MotifSampler were 6th order background model and -n 10. The background models and GC frequency were computed from the upstream sequences of all genes in the corresponding genome (5000 bp upstream of the TSS for mouse, human and flies and 1000 bp for yeast). The output of the motif search algorithms depends on the random initial conditions. We therefore ran 10 iterations of each motif search algorithm on the same sequences (the number of novel non-redundant PWMs reported by the motif-finding programs decreases with each successive iteration; see supplementary information.
###end p 15
###begin p 16
###xml 550 552 550 552 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="bibr" rid="gkh614c13">13</xref>
###xml 623 624 623 624 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="bibr" rid="gkh614c5">5</xref>
###xml 838 839 838 839 <italic xmlns:xlink="http://www.w3.org/1999/xlink">T</italic>
###xml 862 863 862 863 <italic xmlns:xlink="http://www.w3.org/1999/xlink">L</italic>
###xml 867 868 867 868 <italic xmlns:xlink="http://www.w3.org/1999/xlink">m</italic>
###xml 868 869 868 869 <sub xmlns:xlink="http://www.w3.org/1999/xlink">1</sub>
###xml 880 881 872 873 <italic xmlns:xlink="http://www.w3.org/1999/xlink">m</italic>
###xml 881 882 873 874 <sub xmlns:xlink="http://www.w3.org/1999/xlink">T</sub>
The PWMs from the motif-finding algorithms and the motifs from TRANSFAC were merged. Redundancies (between PWMs obtained from different iterations of a motif-finding algorithm or different motif-finding algorithms or the motif-finding output and TRANSFAC) were removed by considering the similarity of the weight matrices. Similarity between two PWMs was assessed by the Spearman correlation coefficient between linearized weight matrices (in the best alignment). We used a threshold correlation coefficient of 0.70 to consider two motifs redundant (13). Furthermore, we only considered motifs with an information content (5) larger than 0.2331 bits/nt (this value corresponded to the lowest 5th percentile from the TRANSFAC database), a minimum length of 6 nt and a minimum of five sequences used to define the PWM. The resulting set of T non-redundant motifs, L = {m1,em leader,mT}, was then used to search for modules (see below).
###end p 16
###begin p 17
###xml 96 101 <span type="species:ncbi:9606">human</span>
Given a PWM, we scanned all the sequences and assigned a score to each sequence segment. In the human muscle set, scanning was performed on the masked sequences (similar results but with higher levels of noise were obtained when using the raw sequences; see supplementary information). The score was given by
###end p 17
###begin p 18
###xml 0 0 0 0 <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="gkh614equ1.gif"/>

###end p 18
###begin p 19
###xml 6 7 6 7 <italic xmlns:xlink="http://www.w3.org/1999/xlink">w</italic>
###xml 29 30 29 30 <italic xmlns:xlink="http://www.w3.org/1999/xlink">f</italic>
###xml 30 32 30 32 <sub xmlns:xlink="http://www.w3.org/1999/xlink">ni</sub>
###xml 71 72 71 72 <italic xmlns:xlink="http://www.w3.org/1999/xlink">n</italic>
###xml 85 86 85 86 <italic xmlns:xlink="http://www.w3.org/1999/xlink">i</italic>
###xml 88 89 88 89 <italic xmlns:xlink="http://www.w3.org/1999/xlink">n</italic>
###xml 94 95 93 94 <italic xmlns:xlink="http://www.w3.org/1999/xlink">A</italic>
###xml 96 97 95 96 <italic xmlns:xlink="http://www.w3.org/1999/xlink">C</italic>
###xml 98 99 97 98 <italic xmlns:xlink="http://www.w3.org/1999/xlink">G</italic>
###xml 100 101 99 100 <italic xmlns:xlink="http://www.w3.org/1999/xlink">T</italic>
###xml 107 108 106 107 <italic xmlns:xlink="http://www.w3.org/1999/xlink">i</italic>
###xml 123 124 114 115 <italic xmlns:xlink="http://www.w3.org/1999/xlink">w</italic>
###xml 212 213 203 204 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="bibr" rid="gkh614c5">5</xref>
###xml 219 220 210 211 <italic xmlns:xlink="http://www.w3.org/1999/xlink">b</italic>
###xml 220 221 211 212 <sub xmlns:xlink="http://www.w3.org/1999/xlink">n</sub>
###xml 261 262 252 253 <italic xmlns:xlink="http://www.w3.org/1999/xlink">n</italic>
###xml 264 265 255 256 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="bibr" rid="gkh614c5">5</xref>
###xml 571 573 558 560 <sub xmlns:xlink="http://www.w3.org/1999/xlink">th</sub>
where w is the motif length, fni indicates the frequency of nucleotide n at position i (n in {A,C,G,T} and i = 1,em leader,w; a pseudocount of one was added at each position to account for small sample bias; see 5) and bn is the overall frequency of nucleotide n (5). Binding of a TF to DNA is likely to be a continuum whereby the protein spends more time bound to higher affinity sequences. However, for the present implementation we chose a binary threshold that classified each PWM as present or absent at each position. As a threshold, we used the maximum score thetath that left out <5% of the sites used to build the PWM (attempting to achieve a low false negative rate). The search was conducted on both strands.
###end p 19
###begin title 20
Preliminary search for modules
###end title 20
###begin p 21
###xml 297 298 297 298 <italic xmlns:xlink="http://www.w3.org/1999/xlink">S</italic>
###xml 304 305 304 305 <italic xmlns:xlink="http://www.w3.org/1999/xlink">n</italic>
###xml 305 306 305 306 <sub xmlns:xlink="http://www.w3.org/1999/xlink">S</sub>
###xml 409 410 409 410 <italic xmlns:xlink="http://www.w3.org/1999/xlink">n</italic>
###xml 410 411 410 411 <sub xmlns:xlink="http://www.w3.org/1999/xlink">b</sub>
###xml 424 425 424 425 <italic xmlns:xlink="http://www.w3.org/1999/xlink">n</italic>
###xml 425 426 425 426 <sub xmlns:xlink="http://www.w3.org/1999/xlink">b</sub>
###xml 431 432 431 432 <italic xmlns:xlink="http://www.w3.org/1999/xlink">n</italic>
###xml 432 433 432 433 <sub xmlns:xlink="http://www.w3.org/1999/xlink">s</sub>
###xml 493 494 493 494 <italic xmlns:xlink="http://www.w3.org/1999/xlink">n</italic>
###xml 494 500 494 500 <sub xmlns:xlink="http://www.w3.org/1999/xlink">motifs</sub>
###xml 510 511 510 511 <italic xmlns:xlink="http://www.w3.org/1999/xlink">n</italic>
###xml 511 517 511 517 <sub xmlns:xlink="http://www.w3.org/1999/xlink">motifs</sub>
###xml 568 569 568 569 <italic xmlns:xlink="http://www.w3.org/1999/xlink">L</italic>
###xml 592 593 592 593 <italic xmlns:xlink="http://www.w3.org/1999/xlink">M</italic>
###xml 626 627 626 627 <italic xmlns:xlink="http://www.w3.org/1999/xlink">m</italic>
###xml 627 628 627 628 <sub xmlns:xlink="http://www.w3.org/1999/xlink">1</sub>
###xml 641 642 633 634 <italic xmlns:xlink="http://www.w3.org/1999/xlink">m</italic>
###xml 642 643 634 635 <italic xmlns:xlink="http://www.w3.org/1999/xlink">n</italic>
###xml 642 643 634 635 <sub xmlns:xlink="http://www.w3.org/1999/xlink"><italic>n</italic></sub>
###xml 651 652 643 644 <italic xmlns:xlink="http://www.w3.org/1999/xlink">n</italic>
###xml 655 656 647 648 <italic xmlns:xlink="http://www.w3.org/1999/xlink">n</italic>
###xml 656 662 648 654 <sub xmlns:xlink="http://www.w3.org/1999/xlink">motifs</sub>
###xml 664 665 656 657 <italic xmlns:xlink="http://www.w3.org/1999/xlink">m</italic>
###xml 665 666 657 658 <sub xmlns:xlink="http://www.w3.org/1999/xlink">i</sub>
###xml 670 671 661 662 <italic xmlns:xlink="http://www.w3.org/1999/xlink">L</italic>
###xml 782 785 773 776 <italic xmlns:xlink="http://www.w3.org/1999/xlink">max</italic>
###xml 785 786 776 777 <sub xmlns:xlink="http://www.w3.org/1999/xlink">d</sub>
###xml 800 803 791 794 <italic xmlns:xlink="http://www.w3.org/1999/xlink">max</italic>
###xml 803 804 794 795 <sub xmlns:xlink="http://www.w3.org/1999/xlink">d</sub>
###xml 974 975 965 966 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="bibr" rid="gkh614c3">3</xref>
###xml 976 978 967 969 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="bibr" rid="gkh614c24">24</xref>
###xml 979 981 970 972 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="bibr" rid="gkh614c31">31</xref>
###xml 982 984 973 975 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="bibr" rid="gkh614c38">38</xref>
###xml 1110 1111 1101 1102 <italic xmlns:xlink="http://www.w3.org/1999/xlink">n</italic>
###xml 1111 1113 1102 1104 <sub xmlns:xlink="http://www.w3.org/1999/xlink">tr</sub>
###xml 1123 1124 1114 1115 <italic xmlns:xlink="http://www.w3.org/1999/xlink">S</italic>
###xml 1126 1127 1117 1118 <italic xmlns:xlink="http://www.w3.org/1999/xlink">n</italic>
###xml 1127 1129 1118 1120 <sub xmlns:xlink="http://www.w3.org/1999/xlink">tr</sub>
###xml 1174 1175 1165 1166 <italic xmlns:xlink="http://www.w3.org/1999/xlink">S</italic>
###xml 1214 1215 1205 1206 <italic xmlns:xlink="http://www.w3.org/1999/xlink">p</italic>
For faster performance, we first compared the set of potentially co-regulated genes against a small background set of random genes before comparing against all genes in the genome (this reduces the number of modules to analyze in all genes in the genome by several orders of magnitude). For a set S with nS potentially co-regulated genes, a background set of genes was generated by extracting a random set of nb genes where nb = 20ns. We exhaustively explored all combinations of motifs up to nmotifs (we used nmotifs = 2, 3 or 4) from the set of non-redundant motifs L. A preliminary module M was defined as a set of motifs {m1, em leader, mn}, with n < nmotifs, mi in L, that fulfilled the following requirements. (i) The distance between adjacent motif occurrences was less than maxd. We explored maxd = 25, 50, 100 and 200 bp; these values are within the range of distances between binding sites observed in several experimentally validated studies in multiple species (3,24,31,38). (ii) The maximum overlap between adjacent motifs was half the motif length. (iii) The module had to be present in at least ntr genes in S (ntr = 4). (iv) The module had to be enriched in S with respect to the background set at p < 0.01 after Bonferroni correction by the total number of combinations (see definition of enrichment below). The motifs within a module were not required to be different and therefore this allowed the modules to represent homotypic interactions as well.
###end p 21
###begin title 22
Comparison to all genes
###end title 22
###begin p 23
###xml 28 29 28 29 <italic xmlns:xlink="http://www.w3.org/1999/xlink">M</italic>
###xml 35 36 35 36 <italic xmlns:xlink="http://www.w3.org/1999/xlink">x</italic>
###xml 67 68 67 68 <italic xmlns:xlink="http://www.w3.org/1999/xlink">S</italic>
###xml 99 100 99 100 <italic xmlns:xlink="http://www.w3.org/1999/xlink">n</italic>
###xml 100 102 100 102 <sub xmlns:xlink="http://www.w3.org/1999/xlink">tr</sub>
###xml 107 108 105 106 <italic xmlns:xlink="http://www.w3.org/1999/xlink">x</italic>
###xml 113 114 109 110 <italic xmlns:xlink="http://www.w3.org/1999/xlink">n</italic>
###xml 114 115 110 111 <sub xmlns:xlink="http://www.w3.org/1999/xlink">s</sub>
###xml 163 164 159 160 <italic xmlns:xlink="http://www.w3.org/1999/xlink">M</italic>
###xml 181 182 177 178 <italic xmlns:xlink="http://www.w3.org/1999/xlink">P</italic>
###xml 182 183 178 179 <sub xmlns:xlink="http://www.w3.org/1999/xlink">g</sub>
###xml 186 187 182 183 <italic xmlns:xlink="http://www.w3.org/1999/xlink">e</italic>
###xml 187 188 183 184 <sub xmlns:xlink="http://www.w3.org/1999/xlink">g</sub>
###xml 189 190 185 186 <italic xmlns:xlink="http://www.w3.org/1999/xlink">n</italic>
###xml 190 191 186 187 <sub xmlns:xlink="http://www.w3.org/1999/xlink">g</sub>
###xml 199 200 195 196 <italic xmlns:xlink="http://www.w3.org/1999/xlink">e</italic>
###xml 200 201 196 197 <sub xmlns:xlink="http://www.w3.org/1999/xlink">g</sub>
###xml 236 237 232 233 <italic xmlns:xlink="http://www.w3.org/1999/xlink">M</italic>
###xml 252 253 248 249 <italic xmlns:xlink="http://www.w3.org/1999/xlink">n</italic>
###xml 253 254 249 250 <sub xmlns:xlink="http://www.w3.org/1999/xlink">g</sub>
###xml 319 320 315 316 <italic xmlns:xlink="http://www.w3.org/1999/xlink">n</italic>
###xml 320 321 316 317 <sub xmlns:xlink="http://www.w3.org/1999/xlink">g</sub>
###xml 612 613 608 609 <italic xmlns:xlink="http://www.w3.org/1999/xlink">M</italic>
###xml 740 741 736 737 <italic xmlns:xlink="http://www.w3.org/1999/xlink">S</italic>
###xml 748 749 744 745 <italic xmlns:xlink="http://www.w3.org/1999/xlink">M</italic>
###xml 762 763 758 759 <italic xmlns:xlink="http://www.w3.org/1999/xlink">e</italic>
###xml 763 764 759 760 <sub xmlns:xlink="http://www.w3.org/1999/xlink">s</sub>
###xml 812 813 808 809 <italic xmlns:xlink="http://www.w3.org/1999/xlink">x</italic>
###xml 837 838 833 834 <italic xmlns:xlink="http://www.w3.org/1999/xlink">P</italic>
###xml 838 839 834 835 <sub xmlns:xlink="http://www.w3.org/1999/xlink">g</sub>
###xml 1003 1004 999 1000 <italic xmlns:xlink="http://www.w3.org/1999/xlink">n</italic>
###xml 1004 1005 1000 1001 <sub xmlns:xlink="http://www.w3.org/1999/xlink">s</sub>
###xml 1006 1007 1002 1003 <italic xmlns:xlink="http://www.w3.org/1999/xlink">n</italic>
###xml 1007 1008 1003 1004 <sub xmlns:xlink="http://www.w3.org/1999/xlink">g</sub>
###xml 1019 1021 1015 1017 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="bibr" rid="gkh614c39">39</xref>
###xml 335 339 <span type="species:ncbi:10090">mice</span>
###xml 352 358 <span type="species:ncbi:9606">humans</span>
###xml 390 395 <span type="species:ncbi:4932">yeast</span>
###xml 478 484 <span type="species:ncbi:9606">humans</span>
###xml 489 494 <span type="species:ncbi:10090">mouse</span>
For each preliminary module M, let x be the number of genes within S where the module was present (ntr </= x </= ns). We determined the frequency of occurrence of M in all genes as Pg = eg/ng, where eg is the number of genes containing M in the set of ng genes analyzed. For the enrichment with respect to 'all genes', ng = 16 969 for mice, 17 689 for humans, 13 639 for flies and 6327 for yeast (the exact number of genes in each species is still not settled, particularly for humans and mouse, but we refer to this number as 'all genes in the genome' throughout the text). We assumed as a null hypothesis that M was randomly distributed across all genes. We therefore defined the enrichment as the probability that the number of genes in S where M is present, es, is larger than or equal to the observed value x assuming the frequency Pg in all genes. This follows a hypergeometric distribution (sampling without replacement from a finite population) which converges to the binomial distribution when ns/ng is small (39). The probability of enrichment can be expressed as:
###end p 23
###begin p 24
###xml 0 0 0 0 <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="gkh614equ2.gif"/>

###end p 24
###begin p 25
###xml 61 62 61 62 <italic xmlns:xlink="http://www.w3.org/1999/xlink">M</italic>
###xml 279 281 279 281 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="bibr" rid="gkh614c40">40</xref>
This enrichment probability was computed for all the modules M from the preliminary module search step. We report all modules with enrichment probability <0.01. Given that multiple hypotheses are tested, we applied the Bonferroni correction using the total number of hypotheses (40). For the comparison to all genes, the total number of hypotheses was given by the number of preliminary modules. For the definition of the preliminary modules, the total number of hypotheses corresponded to the total number of motif combinations.
###end p 25
###begin title 26
Performance evaluation
###end title 26
###begin p 27
###xml 159 160 159 160 <italic xmlns:xlink="http://www.w3.org/1999/xlink">p</italic>
###xml 160 165 160 165 <sub xmlns:xlink="http://www.w3.org/1999/xlink">known</sub>
###xml 620 621 620 621 <italic xmlns:xlink="http://www.w3.org/1999/xlink">p</italic>
###xml 621 623 621 623 <sub xmlns:xlink="http://www.w3.org/1999/xlink">FA</sub>
###xml 719 720 719 720 <italic xmlns:xlink="http://www.w3.org/1999/xlink">M</italic>
###xml 1129 1130 1129 1130 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="fig" rid="gkh614f4">4</xref>
###xml 1290 1291 1290 1291 <italic xmlns:xlink="http://www.w3.org/1999/xlink">p</italic>
###xml 1291 1296 1291 1296 <sub xmlns:xlink="http://www.w3.org/1999/xlink">known</sub>
We examined two main values to evaluate the performance of our algorithm. First we considered whether we could detect the known regulatory regions. We defined pknown as the proportion of known regions that were detected. Secondly, we examined the rate of false positives. It is not easy to accurately determine the false positive rate without making strong assumptions about the biology of the system under study. Here we assume that none of the hitherto uncharacterized regions play a biological role. The assumption that we know all the regulatory regions leads to an upper bound on the false positive rate. We define pFA, the probability of false alarm, as the proportion of module predictions where the location of M overlaps with known regulatory regions in <50% of the genes. In other words, if an investigator were to conduct a follow-up experiment to study the putative regulatory regions predicted by each of the modules, then the probability of false alarms indicates the proportion of modules where more than half of the genes would not show any biological regulatory function. The 50% cut-off is arbitrary and Figure 4 and the supplementary information show the probability of false alarm for different values of this threshold. We separately report the false positive rate and pknown for all the predictions as well as for the top 10 predictions. We do not discuss here the computational performance of the algorithm; all the code was run on a Pentium IV, 2.8 GHz computer running Linux.
###end p 27
###begin title 28
RESULTS
###end title 28
###begin p 29
###xml 106 109 106 109 <italic xmlns:xlink="http://www.w3.org/1999/xlink">cis</italic>
###xml 376 377 376 377 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="fig" rid="gkh614f1">1</xref>
###xml 1155 1157 1155 1157 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="bibr" rid="gkh614c30">30</xref>
###xml 1158 1160 1158 1160 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="bibr" rid="gkh614c41">41</xref>
###xml 1161 1163 1161 1163 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="bibr" rid="gkh614c42">42</xref>
###xml 1403 1405 1403 1405 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="bibr" rid="gkh614c24">24</xref>
###xml 1480 1482 1480 1482 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="bibr" rid="gkh614c31">31</xref>
###xml 1033 1038 <span type="species:ncbi:4932">yeast</span>
###xml 1194 1199 <span type="species:ncbi:4932">yeast</span>
###xml 1472 1478 <span type="species:ncbi:9606">humans</span>
We incorporated the principles of combinatorial regulation and sparseness into an algorithm to search for cis-regulatory elements in a set of potentially co-regulated genes. We also added the power of evolutionary conservation to detect non-coding sequences from multiple species that show little variation through time. A schematic layout of the algorithm is shown in Figure 1. We tested the algorithm to search for putative regulatory sequences in both positive and negative control sets. The first positive control consisted of random sequences where clusters of motifs were artificially implanted. This served the purpose of calibrating the parameters of the algorithm and studying its performance for different degrees of degeneracy of the motifs, noise levels and distance constraints (data not shown). As a negative control, we selected random sets of genes and carried out the same analysis as with the other sets. This showed that the number of predictions expected by chance was small. We then studied the CLB2 gene set in yeast. This is a well-known case where the transcription of several genes in the set is regulated by the TFs SFF and MCM (30,41,42). Many characteristics of the yeast genome make searching for transcriptional regulatory signals easier than in higher eukaryotic organisms. Therefore, we next tested the algorithm in a set of genes involved in pattern formation in flies (24), as well as in a set of genes co-expressed in skeletal muscle in humans (31).
###end p 29
###begin title 30
Random sets of genes
###end title 30
###begin p 31
###xml 505 506 505 506 <italic xmlns:xlink="http://www.w3.org/1999/xlink">N</italic>
###xml 514 515 514 515 <italic xmlns:xlink="http://www.w3.org/1999/xlink">N</italic>
###xml 740 741 740 741 <italic xmlns:xlink="http://www.w3.org/1999/xlink">N</italic>
###xml 1001 1002 997 998 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="table" rid="gkh614tb1">1</xref>
###xml 1869 1870 1863 1864 <italic xmlns:xlink="http://www.w3.org/1999/xlink">p</italic>
###xml 1947 1949 1939 1941 <sup xmlns:xlink="http://www.w3.org/1999/xlink">&#8211;4</sup>
###xml 1962 1964 1952 1954 <sup xmlns:xlink="http://www.w3.org/1999/xlink">&#8211;4</sup>
###xml 2104 2107 2094 2097 <italic xmlns:xlink="http://www.w3.org/1999/xlink">cis</italic>
###xml 2129 2130 2119 2120 <italic xmlns:xlink="http://www.w3.org/1999/xlink">p</italic>
###xml 2263 2264 2251 2252 <italic xmlns:xlink="http://www.w3.org/1999/xlink">p</italic>
###xml 2372 2374 2360 2362 <sup xmlns:xlink="http://www.w3.org/1999/xlink">&#8211;4</sup>
###xml 2387 2389 2373 2375 <sup xmlns:xlink="http://www.w3.org/1999/xlink">&#8211;3</sup>
###xml 541 546 <span type="species:ncbi:10090">mouse</span>
###xml 848 853 <span type="species:ncbi:10090">mouse</span>
###xml 858 863 <span type="species:ncbi:9606">human</span>
###xml 1112 1117 <span type="species:ncbi:9606">human</span>
###xml 1465 1470 <span type="species:ncbi:9606">human</span>
###xml 2029 2034 <span type="species:ncbi:9606">human</span>
###xml 2144 2149 <span type="species:ncbi:9606">human</span>
###xml 2215 2220 <span type="species:ncbi:10090">mouse</span>
###xml 2293 2298 <span type="species:ncbi:10090">mouse</span>
###xml 2334 2339 <span type="species:ncbi:9606">human</span>
Given the large number of combinations of motifs that had to be tested, it was important to put a bound on the probability of chance occurrence of putative modules. Therefore, we sought to determine whether it is possible to obtain putative modules that appear to be statistically significant in negative controls consisting of a random set of genes. The underlying assumption is that a random set of genes is unlikely to share a specific set of common regulatory elements. We randomly selected groups of N genes (N = 20, 30 or 40) from the mouse RefSeq collection and analyzed those genes as if they constituted a real set of potentially co-regulated genes by applying our algorithm and searching for regulatory modules. For each value of N, the procedure was repeated five times. The average number of PWMs was 372 +/- 29 (including 144 TRANSFAC mouse and human motifs plus the output of the motif finding programs; see Materials and Methods). The average sequence length was 7961 +/- 419 bp. Table 1 summarizes the results of this analysis for the set of parameters that most closely matches the study of the human skeletal muscle set (results for other parameters are shown in supplementary information). Random sets of genes yield only a small number of module predictions compared to the positive controls. For a maximum of 4 motifs per module, the average number of modules from the random sets of genes was 0.4 +/- 0.5 whereas the number of modules for the human skeletal muscle set was 561. This suggests that only a small fraction of the modules found in a set of genes can be explained by random co-occurrences of PWM hits. In addition to the low number, the quality of the modules obtained from random sets of genes, as assessed by the enrichment criterion, was poorer than the quality of those modules obtained from real sets of co-regulated genes (median p values: random sets of genes = 0.004 +/- 0.005; skeletal muscle set = 7 x 10-4 +/- 1.6 x 10-4). Furthermore, the putative modules showed no enrichment in the human genome and therefore no evidence of evolutionary conservation of the cis elements. The median p value in the human genome for enrichment of the modules found in the random sets of mouse genes was 0.4 +/- 0.3, whereas the median p value for enrichment in the mouse genome of the modules found in the human skeletal muscle set was 2.5 x 10-4 +/- 9.5 x 10-3. These observations show that, in spite of the large number of combinations, our analysis could still reveal interesting regulatory elements beyond chance expectations. The number of modules found for each iteration as well as results for other parameters are shown in supplementary information.
###end p 31
###begin title 32
###xml 56 61 <span type="species:ncbi:4932">yeast</span>
Initial exploration: a set of genes co-expressed in the yeast cell cycle
###end title 32
###begin p 33
###xml 36 37 36 37 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="table" rid="gkh614tb2">2</xref>
###xml 163 165 163 165 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="bibr" rid="gkh614c30">30</xref>
###xml 263 265 263 265 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="bibr" rid="gkh614c38">38</xref>
###xml 266 268 266 268 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="bibr" rid="gkh614c41">41</xref>
###xml 269 271 269 271 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="bibr" rid="gkh614c42">42</xref>
###xml 392 394 392 394 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="bibr" rid="gkh614c37">37</xref>
###xml 458 460 458 460 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="bibr" rid="gkh614c13">13</xref>
###xml 70 75 <span type="species:ncbi:4932">yeast</span>
We studied a set of 32 genes (Table 2) comprising the CLB2 cluster in yeast. These genes show a pattern of expression that peaks in the M phase of the cell cycle (30). The transcription of several of these genes is known to be controlled by two TFs, SFF and MCM (38,41,42). We searched for combinations of two motifs from a list of 147 motifs that included those weight matrices in TRANSFAC (37) as well as the output from the alignACE motif search program (13) (the full list of motifs is available at ).
###end p 33
###begin p 34
###xml 470 472 470 472 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="bibr" rid="gkh614c30">30</xref>
###xml 473 475 473 475 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="bibr" rid="gkh614c43">43</xref>
###xml 781 783 781 783 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="bibr" rid="gkh614c30">30</xref>
###xml 1039 1041 1039 1041 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="bibr" rid="gkh614c43">43</xref>
###xml 1320 1332 1320 1332 <italic xmlns:xlink="http://www.w3.org/1999/xlink">S.cerevisiae</italic>
###xml 1730 1731 1730 1731 <italic xmlns:xlink="http://www.w3.org/1999/xlink">p</italic>
###xml 1741 1744 1741 1744 <sup xmlns:xlink="http://www.w3.org/1999/xlink">&#8211;17</sup>
###xml 1320 1332 <span type="species:ncbi:4932">S.cerevisiae</span>
The top scoring module corresponded to the interaction between two motifs resembling the SFF and MCM binding sites. The SFF-like and the MCM-like motifs were found by running alignACE on the 1000 bp promoter region of the 32 genes (the output of 10 runs of alignACE was a total of 286 motifs; 116 motifs remained after removing redundant motifs). The correlation coefficient between the linearized PWM of our MCM-like motif and the MCM motif reported in the literature (30,43) was 0.54 and the correlation coefficient for the SFF-like motif was 0.94. These two motifs co-occurred 12 times in 12 genes from the CLB2 cluster (see supplementary information). Among these genes were CLB1, BUD4, SWI5, Swi5p and Ace2p, which are known to be transcriptionally controlled by MCM and SFF (30). This pair of motifs was also computationally identified by Pilpel and colleagues by considering the change in expression coherence during the M phase of the cell cycle for genes containing binding sites for both factors compared to either factor alone (43). The first motif alone occurred 57 times in 25 genes while the second motif appeared 39 times in 23 genes from the CLB2 cluster set. This emphasizes the power of combinatorial regulation by searching for co-occurrences of the two motifs. When scanning through all genes in the S.cerevisiae genome, the two motifs co-occurred 62 times (<1% of the total of 6327 genes searched) while either motif alone was present in >1000 genes. This illustrates the power of the sparseness principle, i.e. the enrichment in the set of co-regulated genes with respect to all genes in the genome. This almost 40-fold occurrence ratio in the CLB2 cluster compared to all genes corresponds to an enrichment p value <10-17 (see Materials and Methods). This two-motif module was the top scoring module regardless of the value used for the maximum distance parameter (25, 50, 100 or 200 bp). Furthermore, this was also the top scoring module when allowing combinations of up to three motifs, indicating that another motif did not add to the specificity of this regulatory module.
###end p 34
###begin p 35
###xml 201 203 201 203 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="bibr" rid="gkh614c30">30</xref>
###xml 466 467 466 467 <sub xmlns:xlink="http://www.w3.org/1999/xlink">1</sub>
We analyzed the gene expression levels along the cell cycle of all the genes containing co-occurrences of these two motifs within 25 bp using the microarray cell cycle data of Spellman and colleagues (30). Of the 50 genes where the module was present (beyond the 12 genes already present in the CLB2 set), cell cycle expression data were unavailable for 4 genes, 29 genes had no apparent modulation of gene expression, 3 had strong cyclic modulation with a peak in G1 or S phase (YFL037W, YLR194C and YNR009W), 5 genes showed weak modulation with a peak in M phase (YHL024W, YHL042W, YNL042W, YDR121W and YDR208W) and 9 genes showed expression modulation with a peak in M phase that resembled the expression patterns of other CLB2 genes (YAR018C, YGL008C, YHL028W, YJL157C, YKL043W, YML052W, YMR031C, YNL056W and YOR023C). The list of all genes where the module was found is available at . These observations suggest that scanning for occurrences of regulatory modules may reveal genes that share similar expression patterns but were not detected in the gene expression analysis.
###end p 35
###begin title 36
###xml 25 35 25 35 <italic xmlns:xlink="http://www.w3.org/1999/xlink">Drosophila</italic>
A more complex scenario: Drosophila pattern development
###end title 36
###begin p 37
###xml 14 17 14 17 <italic xmlns:xlink="http://www.w3.org/1999/xlink">cis</italic>
###xml 305 308 305 308 <italic xmlns:xlink="http://www.w3.org/1999/xlink">cis</italic>
###xml 403 417 403 417 <italic xmlns:xlink="http://www.w3.org/1999/xlink">D.melanogaster</italic>
###xml 432 433 432 433 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="table" rid="gkh614tb2">2</xref>
###xml 624 626 624 626 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="bibr" rid="gkh614c24">24</xref>
###xml 858 868 858 868 <italic xmlns:xlink="http://www.w3.org/1999/xlink">Drosophila</italic>
###xml 403 417 <span type="species:ncbi:7227">D.melanogaster</span>
Searching for cis-regulatory elements in higher eukaryotes poses additional difficulties: intergenic regions are longer, gene structure includes longer introns and gene regulation seems to be more complex, requiring the interplay of more factors. Therefore, we next tested our algorithm in the search for cis-regulatory elements in 13 genes involved in development of the anterior-posterior axis in the D.melanogaster embryo (Table 2). These genes were taken from a previous study that combined computational and experimental work to study clustering of five known TFs, namely Bicoid, Caudal, Hunchback, Kruppel and Knirps (24). Here, we have assumed no knowledge about the involvement of these specific TFs. We ran our algorithm to study the potential regulatory mechanisms of these 13 genes by studying combinations from a list of 271 motifs (including 30 Drosophila PWMs from TRANSFAC and 241 PWMs obtained from the motif-finding algorithms after removing redundancies from an initial list of 1336 motifs; the full list of motifs is available at ).
###end p 37
###begin p 38
###xml 7 8 7 8 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="fig" rid="gkh614f2">2</xref>
###xml 416 419 416 419 <sup xmlns:xlink="http://www.w3.org/1999/xlink">&#8211;12</sup>
###xml 834 835 834 835 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="table" rid="gkh614tb2">2</xref>
###xml 1469 1470 1469 1470 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="fig" rid="gkh614f2">2</xref>
###xml 1624 1625 1624 1625 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="bibr" rid="gkh614c2">2</xref>
###xml 1626 1628 1626 1628 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="bibr" rid="gkh614c24">24</xref>
Figure 2 shows an example where one of the top modules found by our algorithm located the known regulatory regions from six genes in the pattern formation set. This module constituted the best prediction for some but not all parameter combinations. For most of the parameters we explored (83%), this module occurred within the top 10 predictions. It was the top prediction, with an enrichment probability of 1.4 x 10-12, for a maximum motif distance of 200 bp using a maximum of either three or four motifs. For this parameter combination, the top 10 predictions yielded a false positive rate of 60% (see Materials and Methods for definition of false positive rate) and 69% of the known regulatory modules were detected (out of a maximum of 77% given that the regulatory regions of three genes fell outside our search area; see Table 2). Using all module predictions instead of the top 10 predictions, the false positive rate increased to 80%, but we could detect all the known regulatory regions within the sequence search boundaries (see supplementary information available at  for other parameter combinations). Furthermore, considering the top 10 predictions for each parameter set, we detected at least one of the known regulatory regions in 92% of the cases. In many cases, there were multiple occurrences of some of the motifs within the modules (for example, the total number of motif occurrences was seven in the knirps gene for the module illustrated in Fig. 2). This is typical of many DNA signals and may improve the probability of DNA-binding proteins detecting their target sites and exerting their functions (2,24).
###end p 38
###begin p 39
###xml 64 65 64 65 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="fig" rid="gkh614f2">2</xref>
###xml 230 231 230 231 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="fig" rid="gkh614f2">2</xref>
The three individual motifs in the module illustrated in Figure 2 occurred 30 times in 12 genes, 50 times in 13 genes and 97 times in 13 genes, respectively. This was reduced to the 26 occurrences in 6 genes illustrated in Figure 2 upon applying the constraint that the motifs had to cluster along the DNA. Examination of all 13 639 genes in the fly genome led to >2000 occurrences for each of the individual motifs. However, this module was present in only 48 genes (<0.5% of the total number of genes; see supplementary information available at  for the list of these 48 genes).
###end p 39
###begin title 40
###xml 0 5 <span type="species:ncbi:9606">Human</span>
Human muscle regulatory regions
###end title 40
###begin p 41
###xml 46 49 46 49 <italic xmlns:xlink="http://www.w3.org/1999/xlink">cis</italic>
###xml 156 158 156 158 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="bibr" rid="gkh614c31">31</xref>
###xml 302 304 302 304 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="bibr" rid="gkh614c31">31</xref>
###xml 392 393 392 393 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="table" rid="gkh614tb2">2</xref>
###xml 494 501 494 501 <italic xmlns:xlink="http://www.w3.org/1999/xlink">de novo</italic>
###xml 513 516 513 516 <italic xmlns:xlink="http://www.w3.org/1999/xlink">cis</italic>
###xml 595 607 595 607 <italic xmlns:xlink="http://www.w3.org/1999/xlink">Mus musculus</italic>
###xml 612 624 612 624 <italic xmlns:xlink="http://www.w3.org/1999/xlink">Homo sapiens</italic>
###xml 148 154 <span type="species:ncbi:9606">humans</span>
###xml 288 291 <span type="species:ncbi:110835">Tef</span>
###xml 595 607 <span type="species:ncbi:10090">Mus musculus</span>
###xml 612 624 <span type="species:ncbi:9606">Homo sapiens</span>
We further tested the algorithm to search for cis elements in complex regulatory systems by studying a set of genes expressed in skeletal muscle in humans (31). Several TFs have been shown to play a role in the regulation of gene expression in skeletal muscle, including Myf, Mef-2, SRF, Tef and Sp-1 (31). We applied our algorithm to a set of 29 genes with skeletal muscle expression (Table 2) without assuming any knowledge of the specific factors that regulate these genes. We performed our de novo search for cis elements by considering combinations from a list of 406 motifs (including 144 Mus musculus and Homo sapiens PWMs from TRANSFAC and 262 PWMs obtained from the motif-finding programs after removing redundancies from an initial set of 4578 motifs; the full list of all motifs is available at ).
###end p 41
###begin p 42
###xml 54 55 54 55 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="fig" rid="gkh614f3">3</xref>
###xml 226 228 226 228 <sup xmlns:xlink="http://www.w3.org/1999/xlink">&#8211;9</sup>
###xml 230 233 230 233 <italic xmlns:xlink="http://www.w3.org/1999/xlink">max</italic>
###xml 233 234 233 234 <sub xmlns:xlink="http://www.w3.org/1999/xlink">d</sub>
###xml 245 246 245 246 <italic xmlns:xlink="http://www.w3.org/1999/xlink">n</italic>
###xml 246 252 246 252 <sub xmlns:xlink="http://www.w3.org/1999/xlink">motifs</sub>
###xml 490 491 490 491 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="table" rid="gkh614tb2">2</xref>
###xml 508 509 508 509 <italic xmlns:xlink="http://www.w3.org/1999/xlink">p</italic>
###xml 585 587 585 587 <sup xmlns:xlink="http://www.w3.org/1999/xlink">&#8211;6</sup>
###xml 613 616 613 616 <italic xmlns:xlink="http://www.w3.org/1999/xlink">max</italic>
###xml 616 617 616 617 <sub xmlns:xlink="http://www.w3.org/1999/xlink">d</sub>
###xml 622 623 622 623 <italic xmlns:xlink="http://www.w3.org/1999/xlink">n</italic>
###xml 623 629 623 629 <sub xmlns:xlink="http://www.w3.org/1999/xlink">motifs</sub>
###xml 762 763 762 763 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="table" rid="gkh614tb2">2</xref>
###xml 804 805 804 805 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="fig" rid="gkh614f4">4</xref>
###xml 836 837 836 837 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="fig" rid="gkh614f2">2</xref>
###xml 313 318 <span type="species:ncbi:10090">mouse</span>
###xml 430 435 <span type="species:ncbi:10090">mouse</span>
###xml 453 458 <span type="species:ncbi:9606">human</span>
###xml 519 524 <span type="species:ncbi:10090">mouse</span>
###xml 551 556 <span type="species:ncbi:10090">mouse</span>
An example of the results obtained is shown in Figure 3. This module, formed by SP1, SRF, TEF and another putative motif, locates the known regulatory regions in four muscle genes and showed an enrichment probability of 2 x 10-9 (maxd = 100 bp, nmotifs = 4). We searched for the occurrences of this module in the mouse genome (using exactly the same PWMs). We observed that it was also enriched within the upstream regions of the mouse orthologs of the human skeletal muscle genes of Table 2. The enrichment p value in mouse with respect to the whole mouse Refseq collection was 8 x 10-6. For this combination of maxd and nmotifs parameters, 72% of the known signals were detected (four genes in the set did not have any annotated regulatory elements; see Table 2) and the false alarm rate was 80% (Fig. 4; see supplementary information2).
###end p 42
###begin p 43
###xml 385 387 385 387 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="bibr" rid="gkh614c44">44</xref>
###xml 388 390 388 390 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="bibr" rid="gkh614c46">46</xref>
###xml 811 818 811 818 <italic xmlns:xlink="http://www.w3.org/1999/xlink">in situ</italic>
###xml 859 861 859 861 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="bibr" rid="gkh614c47">47</xref>
###xml 1131 1132 1131 1132 <italic xmlns:xlink="http://www.w3.org/1999/xlink">p</italic>
###xml 1137 1139 1137 1139 <sup xmlns:xlink="http://www.w3.org/1999/xlink">&#8211;3</sup>
###xml 1155 1156 1155 1156 <italic xmlns:xlink="http://www.w3.org/1999/xlink">p</italic>
###xml 1161 1163 1161 1163 <sup xmlns:xlink="http://www.w3.org/1999/xlink">&#8211;5</sup>
###xml 1174 1175 1174 1175 <italic xmlns:xlink="http://www.w3.org/1999/xlink">t</italic>
###xml 78 83 <span type="species:ncbi:9606">human</span>
###xml 426 431 <span type="species:ncbi:9606">human</span>
###xml 436 440 <span type="species:ncbi:10090">mice</span>
###xml 1106 1112 <span type="species:ncbi:9606">humans</span>
###xml 1125 1129 <span type="species:ncbi:10090">mice</span>
###xml 1144 1150 <span type="species:ncbi:9606">humans</span>
###xml 1168 1172 <span type="species:ncbi:10090">mice</span>
###xml 1240 1245 <span type="species:ncbi:9606">human</span>
###xml 1342 1348 <span type="species:ncbi:9606">humans</span>
###xml 1353 1357 <span type="species:ncbi:10090">mice</span>
We detected this module in 175 genes (<1% of the total of 17 689 genes in the human RefSeq collection). Whether this module can control the expression of any of these other genes or not requires further experimentation. As a coarse preliminary exploration, we analyzed the expression patterns of these genes in two independent DNA microarray studies of gene expression across tissues (44-46). The list of tissues included the human and mice skeletal muscle. Expression values for some of the genes were not available (19 and 38%, respectively). Also, DNA microarray data can yield false negatives; for example, the CHRND gene, which was present in the skeletal muscle set, did not show enrichment in either microarray study. This emphasizes the importance of other complementary experimental techniques such as in situ hybridization to study gene expression (47). However, on average, the expression level in skeletal muscle of the genes with this module was larger than that of all genes. The ratio of the Affymetrix mean expression levels of genes containing this module to that of all genes was 4.0 for humans and 4.6 for mice (p < 10-3 for humans and p < 10-5 for mice, t-test). Furthermore, several genes that were not included in the human muscle skeletal set showed higher expression levels in muscle compared to other tissues in both humans and mice (see supplementary information).
###end p 43
###begin title 44
Parameter landscape
###end title 44
###begin p 45
Throughout the algorithm, there are several parameters requiring choices by the user. We discuss those parameters here and we show that the search results were robust to most (but not all) of these arbitrary choices.
###end p 45
###begin p 46
###xml 626 628 626 628 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="bibr" rid="gkh614c24">24</xref>
###xml 1546 1548 1546 1548 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="bibr" rid="gkh614c20">20</xref>
###xml 1549 1551 1549 1551 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="bibr" rid="gkh614c24">24</xref>
###xml 1552 1554 1552 1554 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="bibr" rid="gkh614c48">48</xref>
###xml 222 227 <span type="species:ncbi:4932">yeast</span>
###xml 283 288 <span type="species:ncbi:10090">mouse</span>
###xml 293 298 <span type="species:ncbi:9606">human</span>
###xml 1747 1752 <span type="species:ncbi:9606">human</span>
One of the most sensitive decisions concerns where to search for regulatory elements. Shorter sequences reduce the amount of noise but the chances of missing true sites are significantly increased. In the CLB2 gene set in yeast, we always used a fixed window of 1000 bp. In the fly, mouse and human studies, we chose a compromise of using 5000 bp upstream of the TSS. Shorter regions (of 1000 or 2000 bp) missed many important regulatory elements in the fly gene set. In the analysis in flies, known regulatory regions were present between 5 and 10 kb upstream of the TSS in two genes and beyond 10 kb upstream in four genes (24). Furthermore, two genes had regulatory modules downstream of the first intron. Therefore, our search area encompassed 52% of the regulatory modules and 77% of the genes in this set. Restricting the search to only the first 2 kb upstream region would miss 74% of the known regulatory modules in the fly gene set. Our algorithm was also able to detect the known regulatory regions upon extending the upstream segment to 10 kb, albeit with a considerable increase in computation time (the number of putative motif binding sites is proportional to the total sequence length and the computation time is polynomial on the number of binding sites). The performance of the algorithm was quite poor with upstream regions of 50 kb (not shown). However, once a particular module (or a small number of modules) is found and accurately defined, it is possible to search for occurrences of the module throughout the whole genome (20,24,48). Restricting the search to the upstream sequences (i.e. ignoring the first intron and first exon) would not have missed any other regulatory elements in the example in flies. However, in the human muscle set, three genes (10%) had regulatory regions in the first exon or intron.
###end p 46
###begin p 47
###xml 219 224 <span type="species:ncbi:9606">human</span>
###xml 303 308 <span type="species:ncbi:4932">yeast</span>
Only a small fraction of the putative binding sites found by the motif-finding algorithms (alignACE, MEME and MotifSampler) were incorporated into modules that occurred within the known regulatory regions (2.5% for the human skeletal muscle gene set, 4% for the fly pattern formation set and 8% for the yeast CLB2 cluster). It is unclear whether any of the remaining motifs play any biological role or not. This small fraction suggests that further research is necessary to improve the detection of novel putative individual binding sites in complex regulatory systems with long sequences. The threshold for the comparison of motifs to eliminate redundancies (see Materials and Methods) and the parameters used to filter out some of the poorly defined PWMs did not affect the results of the analysis.
###end p 47
###begin p 48
###xml 217 219 217 219 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="bibr" rid="gkh614c49">49</xref>
Detecting the binding sites of a motif given its PWM requires a threshold parameter. The trade-off between sensitivity and specificity for the detection of binding sites has been discussed previously (see for example 49). We observed that we could use a low threshold in the motif scanning step (increasing the false positive rate but reducing the number of missed binding sites) because of the subsequent filtering steps imposed by motif clustering to form modules. We used the maximum score value that left out <5% of the sequences used to define the PWM.
###end p 48
###begin p 49
###xml 621 624 621 624 <italic xmlns:xlink="http://www.w3.org/1999/xlink">max</italic>
###xml 624 625 624 625 <sub xmlns:xlink="http://www.w3.org/1999/xlink">d</sub>
###xml 737 738 737 738 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="bibr" rid="gkh614c9">9</xref>
###xml 739 741 739 741 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="bibr" rid="gkh614c20">20</xref>
###xml 742 744 742 744 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="bibr" rid="gkh614c24">24</xref>
###xml 1024 1025 1024 1025 <italic xmlns:xlink="http://www.w3.org/1999/xlink">n</italic>
###xml 1025 1031 1025 1031 <sub xmlns:xlink="http://www.w3.org/1999/xlink">motifs</sub>
###xml 1080 1083 1080 1083 <italic xmlns:xlink="http://www.w3.org/1999/xlink">max</italic>
###xml 1083 1084 1083 1084 <sub xmlns:xlink="http://www.w3.org/1999/xlink">d</sub>
###xml 1134 1135 1134 1135 <italic xmlns:xlink="http://www.w3.org/1999/xlink">p</italic>
###xml 1151 1153 1151 1153 <sup xmlns:xlink="http://www.w3.org/1999/xlink">&#8211;5</sup>
###xml 1168 1170 1168 1170 <sup xmlns:xlink="http://www.w3.org/1999/xlink">&#8211;8</sup>
###xml 1176 1179 1176 1179 <italic xmlns:xlink="http://www.w3.org/1999/xlink">max</italic>
###xml 1179 1180 1179 1180 <sub xmlns:xlink="http://www.w3.org/1999/xlink">d</sub>
###xml 1252 1253 1252 1253 <italic xmlns:xlink="http://www.w3.org/1999/xlink">p</italic>
###xml 1297 1300 1297 1300 <italic xmlns:xlink="http://www.w3.org/1999/xlink">max</italic>
###xml 1300 1301 1300 1301 <sub xmlns:xlink="http://www.w3.org/1999/xlink">d</sub>
###xml 1340 1341 1340 1341 <italic xmlns:xlink="http://www.w3.org/1999/xlink">p</italic>
###xml 1365 1367 1365 1367 <sup xmlns:xlink="http://www.w3.org/1999/xlink">&#8211;4</sup>
###xml 291 296 <span type="species:ncbi:4932">yeast</span>
###xml 324 329 <span type="species:ncbi:9606">human</span>
###xml 460 465 <span type="species:ncbi:4932">yeast</span>
###xml 570 575 <span type="species:ncbi:9606">human</span>
###xml 928 933 <span type="species:ncbi:9606">human</span>
###xml 1223 1229 <span type="species:ncbi:9606">humans</span>
###xml 1234 1239 <span type="species:ncbi:10090">mouse</span>
###xml 1263 1268 <span type="species:ncbi:10090">mouse</span>
###xml 1351 1356 <span type="species:ncbi:10090">mouse</span>
The definition of the modules also required several parameters. These included the maximum number of interacting motifs, the maximum and minimum distance between motifs and the statistical threshold. Increasing the number of interacting motifs beyond two did not improve the results for the yeast case. In contrast, for the human and fly gene sets, there was a significant increase in the proportion of known regions detected with three or four motifs. In the yeast case, the maximum distance parameter did not influence the results (from 25 to 200 bp). For the fly and human cases, better performances were obtained for maxd = 100 or 200 bp. The constraint that the binding sites cluster in a short region of the DNA is very important (9,20,24). Requiring only that the motif combination is present in the set of genes, regardless of the distances between motifs, led to poor results. For example, running the algorithm on the human skeletal muscle set without imposing any distance constraint between motifs, for the case nmotifs = 2, yielded 9 putative modules (versus 49 with maxd = 100), the top scoring module had an enrichment p value of 4 x 10-5 (versus 6 x 10-8 with maxd = 100) and showed no conservation between humans and mouse (enrichment p value in mouse = 0.1366 in contrast to the maxd = 100 case where the top module had a p value in mouse = 6 x 10-4).
###end p 49
###begin title 50
DISCUSSION
###end title 50
###begin p 51
###xml 323 326 323 326 <italic xmlns:xlink="http://www.w3.org/1999/xlink">cis</italic>
###xml 648 649 648 649 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="bibr" rid="gkh614c1">1</xref>
###xml 650 651 650 651 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="bibr" rid="gkh614c3">3</xref>
###xml 652 653 652 653 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="bibr" rid="gkh614c8">8</xref>
###xml 654 656 654 656 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="bibr" rid="gkh614c16">16</xref>
###xml 657 659 657 659 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="bibr" rid="gkh614c50">50</xref>
Transcriptional control constitutes one of the most ubiquitous regulatory mechanisms; it is present in every species examined so far and is part of many important biological processes. Here we have shown that two simple principles about the organization of regulatory regions in the DNA could lead to the identification of cis elements in a group of co-regulated genes. These principles are: (i) the combinatorial nature of transcriptional regulation; (ii) the sparseness of the regulatory modules. The combinatorial arrangement of multiple TFs allows cells to finely control gene transcription and integrate multiple signal transduction pathways (1,3,8,16,50). Thus, a small number of TFs can control a large array of biological processes. Sparseness permits the cell to manipulate the expression of different genes in a distinct way.
###end p 51
###begin p 52
###xml 1031 1033 1031 1033 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="bibr" rid="gkh614c51">51</xref>
The exploration of the parameter landscape suggests that the algorithm's performance is robust to many of the parameters and thresholds. Performance is very sensitive to the choice of the search space. Without additional knowledge about the location of the regulatory modules, short sequence segments (e.g. <2 kb for higher eukaryotes) are likely to miss many of the important regulatory elements. However, very long sequences (e.g. >10 kb) significantly increase the levels of noise. Our compromise was to use 5000 bp upstream of the TSS and to include the first exon and first intron. Once a module is found in this sequence segment, the algorithm searches for occurrences of the module in all genes in the genome. The enrichment criterion assumes as a null hypothesis that the scanned sequences of genes in the set under study are not distinct from those in all genes. Differences that may or may not play a direct role in specific regulation of transcription, such as different content of CpG islands in tissue-specific genes (51), would also be detected by our algorithm.
###end p 52
###begin p 53
###xml 99 102 99 102 <italic xmlns:xlink="http://www.w3.org/1999/xlink">cis</italic>
###xml 447 448 447 448 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="fig" rid="gkh614f2">2</xref>
###xml 707 709 707 709 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="bibr" rid="gkh614c24">24</xref>
###xml 778 779 778 779 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="fig" rid="gkh614f3">3</xref>
###xml 978 980 978 980 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="bibr" rid="gkh614c44">44</xref>
###xml 981 983 981 983 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="bibr" rid="gkh614c45">45</xref>
###xml 1049 1051 1049 1051 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="bibr" rid="gkh614c44">44</xref>
###xml 1424 1427 1424 1427 <italic xmlns:xlink="http://www.w3.org/1999/xlink">cis</italic>
###xml 719 724 <span type="species:ncbi:9606">human</span>
###xml 862 867 <span type="species:ncbi:9606">human</span>
###xml 1026 1031 <span type="species:ncbi:10090">mouse</span>
In addition to improving our understanding of transcriptional regulation, an accurate model of the cis-regulatory elements in a set of genes can lead to the identification of other genes that share the same regulatory mechanisms. A typical case involves DNA microarray studies where some genes may be missed due to thresholds in the analysis or to low expression values that are below the detection limits. For example, the module shown in Figure 2 was also present in several TFs in the fly genome, including tll, can and fkh (see supplementary information for the whole list). The tll TF is known to play a role in controlling the expression of several of the genes in the fly pattern formation gene set (24). In the human skeletal muscle gene set, the module shown in Figure 3 was present in MAPK12 (mitogen-activated protein kinase 12), which is enriched in human skeletal muscle compared to the median expression across all tissues in two independent microarray data sets (44,45). Furthermore, MAPK12 is also enriched in mouse skeletal muscle (44). This module was also present in other genes highly expressed in skeletal muscle, including MAPKAPK2, MAPKAPK3, CA3, PTGDS, CSDA, SMG1 MRPL28 DMPK, TUBA8 and LARGE. However, it is hard to assess without further biological experiments whether expression of the other genes that contained the module and were not in the original set is actually regulated by these putative cis elements.
###end p 53
###begin p 54
###xml 110 113 110 113 <italic xmlns:xlink="http://www.w3.org/1999/xlink">cis</italic>
###xml 124 126 124 126 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="bibr" rid="gkh614c20">20</xref>
###xml 127 129 127 129 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="bibr" rid="gkh614c24">24</xref>
###xml 130 132 130 132 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="bibr" rid="gkh614c43">43</xref>
###xml 133 135 133 135 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="bibr" rid="gkh614c52">52</xref>
###xml 136 138 136 138 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="bibr" rid="gkh614c53">53</xref>
###xml 680 685 <span type="species:ncbi:4932">yeast</span>
Other investigators have included requirements for clustering of motifs within their algorithms to search for cis elements (20,24,43,52,53). Several of these algorithms consider a combination of motifs to be significant when its presence cannot be accounted for by a simple model (like a Poisson model) assuming independence for occurrences of separate motifs. Important evolutionary forces such as duplication and transposition are not well accounted for by independence assumptions made by many parametric models of motif clustering (as a trivial example, the sequence AAAAAAAAAAAA occurs much more frequently than would be predicted by independent occurrences of AAAAAA in the yeast 1 kb sequences before the TSS). Our implementation of the sparseness principle requires fewer assumptions and may be more relevant to the situation in the cell. In particular, it does not require determining a specific distribution for the motif binding sites.
###end p 54
###begin p 55
###xml 53 54 53 54 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="bibr" rid="gkh614c2">2</xref>
###xml 55 56 55 56 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="bibr" rid="gkh614c4">4</xref>
###xml 57 59 57 59 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="bibr" rid="gkh614c54">54</xref>
###xml 206 207 206 207 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="bibr" rid="gkh614c7">7</xref>
###xml 471 474 471 474 <italic xmlns:xlink="http://www.w3.org/1999/xlink">cis</italic>
Gene expression also depends on chromatin structure (2,4,54), on other regulatory mechanisms that are not seen at the DNA sequence level (e.g. the phosphorylation of a TF) and on elements far from the TSS (7). At the moment, our algorithm does not account for any of these. The high false positive rates observed with this as well as other algorithms stresses the fundamental role of biological experimentation. However, the use of computational algorithms to search for cis-regulatory elements significantly reduces the search space to one that is manageable with current laboratory techniques.
###end p 55
###begin p 56
###xml 400 403 400 403 <italic xmlns:xlink="http://www.w3.org/1999/xlink">cis</italic>
Understanding transcriptional regulatory networks in higher eukaryotes is a complex problem. As in other difficult problems in other research areas, it is important to identify some of the basic organizational structure that can account for the majority of the examples (albeit not necessarily all of them). Combinatorial regulation, sparseness and evolutionary conservation can guide the search for cis elements, which constitutes one of the first key steps towards a more detailed model of regulatory networks.
###end p 56
###begin title 57
Figures and Tables
###end title 57
###begin p 58
###xml 63 66 63 66 <italic xmlns:xlink="http://www.w3.org/1999/xlink">cis</italic>
###xml 318 319 318 319 <italic xmlns:xlink="http://www.w3.org/1999/xlink">S</italic>
###xml 467 469 467 469 <italic xmlns:xlink="http://www.w3.org/1999/xlink">S.</italic>
###xml 565 566 565 566 <italic xmlns:xlink="http://www.w3.org/1999/xlink">L</italic>
###xml 749 750 749 750 <italic xmlns:xlink="http://www.w3.org/1999/xlink">S</italic>
###xml 968 969 968 969 <italic xmlns:xlink="http://www.w3.org/1999/xlink">S</italic>
 Overall scheme. Schematic description of our approach to find cis elements in eukaryotes based on combinatorial usage of transcription factors and sparseness of the regulatory modules. The approach involves searching for co-occurrences of motifs that are highly enriched in the set of potentially co-regulated genes (S) with respect to the set of all genes in the corresponding genome. The upstream region, first exon and first intron are retrieved for each gene in S. Non-conserved sequences can be masked to reduce the level of noise. A list of individual PWMs (L) is created by (i) searching for new motifs (using the motif finding programs alignACE, MEME and MotifSampler) on the upstream, first exon and first intron sequences of the genes in S and independently (ii) from motifs from the TRANSFAC database. Modules are defined by clusters of motifs within small DNA segments. Module enrichment is evaluated by comparing the occurrences of the module in the set S against occurrences in all the genes in the genome. The boxes indicate the output of the previous step and the arrows indicate the processs(es) involved in each step.
###end p 58
###begin p 59
###xml 184 185 184 185 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="table" rid="gkh614tb2">2</xref>
###xml 342 347 342 347 <italic xmlns:xlink="http://www.w3.org/1999/xlink">et al</italic>
###xml 350 352 350 352 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="bibr" rid="gkh614c24">24</xref>
###xml 394 395 394 395 <italic xmlns:xlink="http://www.w3.org/1999/xlink">n</italic>
###xml 438 439 438 439 <italic xmlns:xlink="http://www.w3.org/1999/xlink">n</italic>
###xml 789 790 789 790 <italic xmlns:xlink="http://www.w3.org/1999/xlink">p</italic>
###xml 831 834 831 834 <sup xmlns:xlink="http://www.w3.org/1999/xlink">&#8211;12</sup>
 One of the top modules in the fly pattern formation set. Location of the three motifs from one of the top scoring modules found in six genes from the fly pattern formation set (Table 2) within the 5 kb region upstream of the TSS plus first exon and first intron. Shaded boxes correspond to the known regulatory regions as reported by Berman et al. (24). The number of total motif occurrences (n) is indicated next to each gene. Whenever n > 3, there were multiple occurrences of at least one of the motifs. To the right of each gene, we zoom in (8x) on the region including the module. The algorithm was run with the following parameters: maximum distance between motifs = 200 bp, maximum number of motifs = 3, no order constraint, minimum number of genes with module = 4. The enrichment p value (see Materials and Methods) was 10-12.
###end p 59
###begin p 60
###xml 363 365 363 365 <xref xmlns:xlink="http://www.w3.org/1999/xlink" ref-type="bibr" rid="gkh614c31">31</xref>
###xml 469 472 469 472 <italic xmlns:xlink="http://www.w3.org/1999/xlink">max</italic>
###xml 472 473 472 473 <sub xmlns:xlink="http://www.w3.org/1999/xlink">d</sub>
###xml 591 592 591 592 <italic xmlns:xlink="http://www.w3.org/1999/xlink">p</italic>
###xml 609 611 609 611 <sup xmlns:xlink="http://www.w3.org/1999/xlink">&#8211;9</sup>
###xml 31 36 <span type="species:ncbi:9606">human</span>
###xml 251 256 <span type="species:ncbi:9606">human</span>
 One of the top results in the human skeletal muscle set. Location of four motifs (red rectangle, SP1-like; blue diamond, SRF-like; green oval, TEF-like; black triangle, putative motif) from one of the top scoring modules found in five genes from the human muscle set. Shaded boxes correspond to the known regulatory regions as reported by Wasserman and Fickett (31). The format follows that in the previous figure. The algorithm was run with the following parameters: maxd = 100 bp, maximum number of motifs = 4, no order constraint, minimum number of genes with module = 4. The enrichment p value was 2 x 10-9.
###end p 60
###begin p 61
###xml 67 68 67 68 <italic xmlns:xlink="http://www.w3.org/1999/xlink">p</italic>
###xml 68 70 68 70 <sub xmlns:xlink="http://www.w3.org/1999/xlink">FA</sub>
###xml 242 243 242 243 <bold xmlns:xlink="http://www.w3.org/1999/xlink">A</bold>
###xml 245 255 245 255 <italic xmlns:xlink="http://www.w3.org/1999/xlink">Drosophila</italic>
###xml 297 298 297 298 <bold xmlns:xlink="http://www.w3.org/1999/xlink">B</bold>
###xml 300 310 300 310 <italic xmlns:xlink="http://www.w3.org/1999/xlink">Drosophila</italic>
###xml 355 356 355 356 <bold xmlns:xlink="http://www.w3.org/1999/xlink">C</bold>
###xml 403 404 403 404 <bold xmlns:xlink="http://www.w3.org/1999/xlink">D</bold>
###xml 554 557 554 557 <italic xmlns:xlink="http://www.w3.org/1999/xlink">max</italic>
###xml 557 558 557 558 <sub xmlns:xlink="http://www.w3.org/1999/xlink">d</sub>
###xml 563 564 563 564 <italic xmlns:xlink="http://www.w3.org/1999/xlink">n</italic>
###xml 564 570 564 570 <sub xmlns:xlink="http://www.w3.org/1999/xlink">motifs</sub>
###xml 358 363 <span type="species:ncbi:9606">Human</span>
###xml 406 411 <span type="species:ncbi:9606">Human</span>
 Average false positive probabilities. False positive probability, pFA, as a function of the threshold for the proportion of genes where the module correctly predicts the known regulatory regions (see Materials and Methods for definitions). (A) Drosophila pattern formation set, all predictions. (B) Drosophila pattern formation set, top 10 predictions. (C) Human skeletal muscle set, all predictions. (D) Human skeletal muscle set, top 10 predictions. Error bars correspond to standard deviations. The values here were averaged over all combinations of maxd and nmotifs (the individual values for each parameter combination are available at ).
###end p 61
###begin title 62
Summary of performance for random gene sets and skeletal muscle set
###end title 62
###begin p 63
###xml 200 201 200 201 <italic xmlns:xlink="http://www.w3.org/1999/xlink">n</italic>
###xml 201 207 201 207 <sub xmlns:xlink="http://www.w3.org/1999/xlink">motifs</sub>
###xml 346 349 346 349 <italic xmlns:xlink="http://www.w3.org/1999/xlink">max</italic>
###xml 349 350 349 350 <sub xmlns:xlink="http://www.w3.org/1999/xlink">d</sub>
###xml 390 391 390 391 <italic xmlns:xlink="http://www.w3.org/1999/xlink">p</italic>
###xml 524 527 524 527 <italic xmlns:xlink="http://www.w3.org/1999/xlink">max</italic>
###xml 527 528 527 528 <sub xmlns:xlink="http://www.w3.org/1999/xlink">d</sub>
###xml 871 874 867 870 <italic xmlns:xlink="http://www.w3.org/1999/xlink">max</italic>
###xml 874 875 870 871 <sub xmlns:xlink="http://www.w3.org/1999/xlink">d</sub>
###xml 109 114 <span type="species:ncbi:10090">mouse</span>
###xml 457 462 <span type="species:ncbi:10090">mouse</span>
###xml 471 476 <span type="species:ncbi:9606">human</span>
The number of modules and module enrichment for the negative controls consisting of 30 random genes from the mouse RefSeq collection (average of five iterations) and for the skeletal muscle gene set. nmotifs indicates the maximum number of motifs per module. The number of modules indicates the average over all iterations and the four values of maxd explored (25, 50, 100 and 200 bp). The p value shows the enrichment probability with respect to the whole mouse (mm) or human genome (hs) (median across different values of maxd and different iterations, see Materials and Methods). The results presented in this table were computed using a maximum upstream sequence length of 5000 bp and including the first exon and first intron (total sequence length: random genes, 7961 +/- 419 bp; skeletal muscle, 6823 +/- 1700 bp). The results for each iteration and each value of maxd as well as a description of the dependence on the sequence length and the number of genes are available at .
###end p 63
###begin title 64
List of genes in each set
###end title 64
###begin p 65
For each of the three sets of biologically validated co-regulated genes that we analyzed, this list indicates the gene identifiers and symbols and whether the regulatory elements reported in the literature fall within the search areas that we included in the analysis.
###end p 65
###begin p 66
###xml 0 1 0 1 <sup xmlns:xlink="http://www.w3.org/1999/xlink">a</sup>
aLocuslink.
###end p 66
###begin title 67
ACKNOWLEDGEMENTS
###end title 67
###begin p 68
We would like to thank John Hogenesch, Sayan Mukherjee, Uwe Ohler, Tommy Poggio and Mariela Zirlinger for discussions and comments on the manuscript. G.K. is supported by a Whiteman Fellowship at MIT.
###end p 68
###begin title 69
REFERENCES
###end title 69

