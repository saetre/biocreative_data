<!DOCTYPE article PUBLIC "-//NLM//DTD Journal Archiving and Interchange DTD v2.3 20070202//EN" "archivearticle.dtd"><article xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article"><front><journal-meta><journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id><journal-title>BMC Bioinformatics</journal-title><issn pub-type="epub">1471-2105</issn><publisher><publisher-name>BioMed Central</publisher-name><publisher-loc>London</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">1471-2105-8-138</article-id><article-id pub-id-type="pmid">17456238</article-id><article-id pub-id-type="doi">10.1186/1471-2105-8-138</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group></article-categories><title-group><article-title>Multiple non-collinear TF-map alignments of promoter regions</article-title></title-group><contrib-group><contrib id="A1" contrib-type="author"><name><surname>Blanco</surname><given-names>Enrique</given-names></name><xref ref-type="aff" rid="I1">1</xref><xref ref-type="aff" rid="I2">2</xref><email>eblanco@imim.es</email></contrib><contrib id="A2" contrib-type="author"><name><surname>Guig&#x000f3;</surname><given-names>Roderic</given-names></name><xref ref-type="aff" rid="I2">2</xref><email>rguigo@imim.es</email></contrib><contrib id="A3" corresp="yes" contrib-type="author"><name><surname>Messeguer</surname><given-names>Xavier</given-names></name><xref ref-type="aff" rid="I1">1</xref><email>peypoch@lsi.upc.edu</email></contrib></contrib-group><aff id="I1"><label>1</label>Grup d'Algor&#x000ed;smica i Gen&#x000e8;tica. Departament de Llenguatges i Sistemes Inform&#x000e0;tics. Universitat Polit&#x000e8;cnica de Catalunya. C/Jordi Girona, 1&#x02013;3, 08034 Barcelona, Catalonia, Spain</aff><aff id="I2"><label>2</label>Bioinformatics and Genomics Program, Centre de Regulaci&#x000f3; Gen&#x000f2;mica.Pg. Mar&#x000ed;tim de la Barceloneta 37&#x02013;49, 08003 Barcelona, Catalonia, Spain</aff><pub-date pub-type="collection"><year>2007</year></pub-date><pub-date pub-type="epub"><day>24</day><month>4</month><year>2007</year></pub-date><volume>8</volume><fpage>138</fpage><lpage>138</lpage><ext-link ext-link-type="uri" xlink:href="http://www.biomedcentral.com/1471-2105/8/138"/><history><date date-type="received"><day>19</day><month>1</month><year>2007</year></date><date date-type="accepted"><day>24</day><month>4</month><year>2007</year></date></history><permissions><copyright-statement>Copyright &#x000a9; 2007 Blanco et al; licensee BioMed Central Ltd.</copyright-statement><copyright-year>2007</copyright-year><copyright-holder>Blanco et al; licensee BioMed Central Ltd.</copyright-holder><license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0"><p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0"/>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</p><!--<rdf xmlns="http://web.resource.org/cc/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:dc="http://purl.org/dc/elements/1.1" xmlns:dcterms="http://purl.org/dc/terms"><Work xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dcterms="http://purl.org/dc/terms/" rdf:about=""><license rdf:resource="http://creativecommons.org/licenses/by/2.0"/><dc:type rdf:resource="http://purl.org/dc/dcmitype/Text"/><dc:author> Blanco Enrique eblanco@imim.es </dc:author><dc:title> Multiple non-collinear TF-map alignments of promoter regions </dc:title><dc:date>2007</dc:date><dcterms:bibliographicCitation>BMC Bioinformatics 8(1): 138-. (2007)</dcterms:bibliographicCitation><dc:identifier type="sici">1471-2105(2007)8:1&#x0003c;138&#x0003e;</dc:identifier><dcterms:isPartOf>urn:ISSN:1471-2105</dcterms:isPartOf><License rdf:about="http://creativecommons.org/licenses/by/2.0"><permits rdf:resource="http://web.resource.org/cc/Reproduction" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/Distribution" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Notice" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Attribution" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/DerivativeWorks" xmlns=""/></License></Work></rdf>--></license></permissions><abstract><sec><title>Background</title><p>The analysis of the promoter sequence of genes with similar expression patterns is a basic tool to annotate common regulatory elements. Multiple sequence alignments are on the basis of most comparative approaches. The characterization of regulatory regions from co-expressed genes at the sequence level, however, does not yield satisfactory results in many occasions as promoter regions of genes sharing similar expression programs often do not show nucleotide sequence conservation.</p></sec><sec><title>Results</title><p>In a recent approach to circumvent this limitation, we proposed to align the maps of predicted transcription factors (referred as TF-maps) instead of the nucleotide sequence of two related promoters, taking into account the label of the corresponding factor and the position in the primary sequence. We have now extended the basic algorithm to permit multiple promoter comparisons using the progressive alignment paradigm. In addition, non-collinear conservation blocks might now be identified in the resulting alignments. We have optimized the parameters of the algorithm in a small, but well-characterized collection of human-mouse-chicken-zebrafish orthologous gene promoters.</p></sec><sec><title>Conclusion</title><p>Results in this dataset indicate that TF-map alignments are able to detect high-level regulatory conservation at the promoter and the 3'UTR gene regions, which cannot be detected by the typical sequence alignments. Three particular examples are introduced here to illustrate the power of the multiple TF-map alignments to characterize conserved regulatory elements in absence of sequence similarity. We consider this kind of approach can be extremely useful in the future to annotate potential transcription factor binding sites on sets of co-regulated genes from high-throughput expression experiments.</p></sec></abstract></article-meta></front><body><sec><title>Background</title><p>Sequence comparisons are one of the most important computational tools in molecular biology. Sequences are good symbolic representations of biological molecules that encode relevant information about their structure, function and history. From the analysis of functionally related sequences, biologically significant facts can be inferred. For instance, genomic sequence comparisons are performed in order to identify genes or regulatory sites across evolutionarily related genomes, as these functional elements tend to exhibit conservational patterns different from those observed in regions that are not functional.</p><p>In attempt to allow for multiple sequence comparisons, the basic dynamic programming recurrences introduced in the 1970s to align efficiently two sequences of <italic>n </italic>symbols in time proportional to the square of the length of the sequences [<xref ref-type="bibr" rid="B1">1</xref>,<xref ref-type="bibr" rid="B2">2</xref>], can be naturally extended for <italic>k </italic>sequences, with an exponential cost <italic>O</italic>(<italic>n</italic><sup><italic>k</italic></sup>)[<xref ref-type="bibr" rid="B3">3</xref>]. As this cost is unaffordable in practice, many heuristics have appeared to provide acceptable solutions with a minor cost. The most popular of them is the progressive alignment [<xref ref-type="bibr" rid="B4">4</xref>,<xref ref-type="bibr" rid="B5">5</xref>].</p><p>This procedure is a greedy algorithm that runs in <italic>O</italic>(<italic>k</italic><sup>2</sup><italic>n</italic><sup>2</sup>) time. In a first step, the progressive alignment performs all of the pairwise alignments to build an evolutionary tree. In a second step, an initial alignment is constructed from the two closest sequences, incorporating then the rest to the profile following the guide tree. Such a procedure does not guarantee to find the optimal solution in mathematical terms. However, the results are generally meaningful from the biological standpoint.</p><p>These comparisons at the sequence level have limitations however. Although similar sequences do tend to play similar biological functions, the opposite is not necessarily true. Often similar functions are encoded in higher order sequence elements that are not necessarily conserved at the sequence level. As a result, similar functions are frequently encoded by diverse sequences which are undetectable by conventional sequence alignment methods.</p><p>Gene promoter regions are a good example. The information that governs the RNA synthesis is mostly encoded in the gene promoter, a region normally 200 to 2000 nucleotides long upstream of the transcription start site of the gene (TSS). Transcription factors (TFs) bind to sequence specific motifs (the TF binding sites, TFBSs) within the promoters. TFBSs are 5&#x02013;8 nucleotides long and one promoter region contains on the order of 10 to 50 of them [<xref ref-type="bibr" rid="B6">6</xref>]. Such motifs appear to be arranged in specific configurations that define the temporal and spatial transcriptional program of each gene. Genes presenting similar expression patterns are assumed to share similar configurations of TFBSs in their promoters [<xref ref-type="bibr" rid="B7">7</xref>,<xref ref-type="bibr" rid="B8">8</xref>].</p><p>However, TFBSs associated to the same TF show often little sequence conservation. Therefore, promoter regions of genes with similar expression pattern may not be similar at the sequence level.</p><p>In a previous work [<xref ref-type="bibr" rid="B9">9</xref>], we showed that pairwise alignments between sequences of labels representing TFs binding to sites predicted in promoter regions (TF-maps) could often uncover high-level common regulatory patterns which could not be found by typical nucleotide sequence comparisons.</p><p>Here, we present an efficient implementation of the multiple TF-map alignment based in the progressive alignment paradigm. We have introduced some modifications in the pairwise global TF-map alignment algorithm to allow the alignment of TF-map alignments. In addition, we have extended the algorithm to allow for non-collinear alignments, which are rarely considered in conventional dynamic programming algorithms, being only partially identified by combining global and local alignment strategies [<xref ref-type="bibr" rid="B10">10</xref>,<xref ref-type="bibr" rid="B11">11</xref>]. The ability to predict non-collinear alignments may be particularly relevant in the case of promoter regions, where the linearity of TFBSs configurations can be weakly conserved [<xref ref-type="bibr" rid="B12">12</xref>].</p><p>The structure of the paper is the following: first, we briefly review the concept of TF-map and provide the formal definition of a multiple TF-map alignment. Then, we introduce the algorithm to compute the optimal pairwise alignment of two alignments. Next, we describe the main algorithm that performs the progressive alignment of multiple TF-maps. Later, we define formally a non-collinear alignment, introducing some modifications in the basic algorithm. Finally, we systematically estimate the optimal parameters of the alignment to distinguish promoters from other gene regions in a set of well characterized human-rodent gene pairs extracted from the ABS database [<xref ref-type="bibr" rid="B13">13</xref>] and their corresponding orthologs in chicken and zebrafish. These results are compared to those obtained by conventional sequence alignment methods. Three particular examples are presented in which multiple TF-map alignments characterize conserved regulatory elements that are otherwise imperceptible in sequence-level comparisons.</p><sec><title>TF-maps</title><p>Let &#x02211;<sub><italic>DNA </italic></sub>be the alphabet of four nucleotides. Let &#x02211;<sub><italic>H </italic></sub>be the alphabet of symbols corresponding to higher-order elements that can be annotated over a genomic sequence, for instance TFs. We define a generic mapping function as a procedure to translate a sequence of nucleotides <italic>S </italic>= <italic>s</italic><sub>1</sub><italic>s</italic><sub>2 </sub>... <italic>s</italic><sub><italic>k </italic></sub>where each nucleotide <italic>s</italic><sub><italic>i</italic></sub>&#x02208; &#x02211;<sub><italic>DNA</italic></sub>, into a sequence of tuples <italic>M </italic>= <italic>m</italic><sub>1</sub><italic>m</italic><sub>2 </sub>... <italic>m</italic><sub><italic>n </italic></sub>where each tuple <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M1" name="1471-2105-8-138-i1" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo>&#x0003c;</mml:mo><mml:msubsup><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>f</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:msubsup><mml:mo>&#x0003e;</mml:mo></mml:mrow><mml:annotation encoding="MathType-MTEF"> MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGTbqBdaWgaaWcbaGaemyAaKgabeaakiabg2da9iabgYda8iabd2gaTnaaDaaaleaacqWGPbqAaeaacqWGMbGzaaGccqGGSaalcqWGTbqBdaqhaaWcbaGaemyAaKgabaGaemiCaaNaeGymaedaaOGaeiilaWIaemyBa02aa0baaSqaaiabdMgaPbqaaiabdchaWjabikdaYaaakiabcYcaSiabd2gaTnaaDaaaleaacqWGPbqAaeaacqWGZbWCaaGccqGH+aGpaaa@489E@</mml:annotation></mml:semantics></mml:math></inline-formula> denotes the match of a motif for the higher-order element <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M2" name="1471-2105-8-138-i2" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>f</mml:mi></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF"> MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGTbqBdaqhaaWcbaGaemyAaKgabaGaemOzaygaaaaa@30EC@</mml:annotation></mml:semantics></mml:math></inline-formula> &#x02208; &#x02211;<sub><italic>H </italic></sub>occurring between the position <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M3" name="1471-2105-8-138-i3" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF"> MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGTbqBdaqhaaWcbaGaemyAaKgabaGaemiCaaNaeGymaedaaaaa@31F0@</mml:annotation></mml:semantics></mml:math></inline-formula> and the position <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M4" name="1471-2105-8-138-i4" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF"> MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGTbqBdaqhaaWcbaGaemyAaKgabaGaemiCaaNaeGOmaidaaaaa@31F2@</mml:annotation></mml:semantics></mml:math></inline-formula> over the sequence <italic>S </italic>with score <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M5" name="1471-2105-8-138-i5" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF"> MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGTbqBdaqhaaWcbaGaemyAaKgabaGaem4Camhaaaaa@3106@</mml:annotation></mml:semantics></mml:math></inline-formula>.</p><p>We introduced the concept of mapping for the promoter characterization problem in a previous work [<xref ref-type="bibr" rid="B9">9</xref>]. Let &#x02211;<sub><italic>TF </italic></sub>be the alphabet of TFs denoting symbols. A mapping function is a procedure to translate a promoter region <italic>S </italic>= <italic>s</italic><sub>1</sub><italic>s</italic><sub>2 </sub>... <italic>s</italic><sub><italic>k </italic></sub>where each nucleotide <italic>s</italic><sub><italic>i </italic></sub>&#x02208; &#x02211;<sub><italic>DNA</italic></sub>, into a sequence of TF-tuples <italic>M </italic>= <italic>m</italic><sub>1</sub><italic>m</italic><sub>2 </sub>... <italic>m</italic><sub><italic>n </italic></sub>where each TF-tuple <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M6" name="1471-2105-8-138-i1" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo>&#x0003c;</mml:mo><mml:msubsup><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>f</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:msubsup><mml:mo>&#x0003e;</mml:mo></mml:mrow><mml:annotation encoding="MathType-MTEF"> MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGTbqBdaWgaaWcbaGaemyAaKgabeaakiabg2da9iabgYda8iabd2gaTnaaDaaaleaacqWGPbqAaeaacqWGMbGzaaGccqGGSaalcqWGTbqBdaqhaaWcbaGaemyAaKgabaGaemiCaaNaeGymaedaaOGaeiilaWIaemyBa02aa0baaSqaaiabdMgaPbqaaiabdchaWjabikdaYaaakiabcYcaSiabd2gaTnaaDaaaleaacqWGPbqAaeaacqWGZbWCaaGccqGH+aGpaaa@489E@</mml:annotation></mml:semantics></mml:math></inline-formula> denotes the match of a binding site for the TF <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M7" name="1471-2105-8-138-i2" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>f</mml:mi></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF"> MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGTbqBdaqhaaWcbaGaemyAaKgabaGaemOzaygaaaaa@30EC@</mml:annotation></mml:semantics></mml:math></inline-formula> &#x02208; &#x02211;<sub><italic>TF </italic></sub>occurring between the position <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M8" name="1471-2105-8-138-i3" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF"> MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGTbqBdaqhaaWcbaGaemyAaKgabaGaemiCaaNaeGymaedaaaaa@31F0@</mml:annotation></mml:semantics></mml:math></inline-formula> and the position <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M9" name="1471-2105-8-138-i4" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF"> MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGTbqBdaqhaaWcbaGaemyAaKgabaGaemiCaaNaeGOmaidaaaaa@31F2@</mml:annotation></mml:semantics></mml:math></inline-formula> over the sequence <italic>S </italic>with score <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M10" name="1471-2105-8-138-i5" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF"> MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGTbqBdaqhaaWcbaGaemyAaKgabaGaem4Camhaaaaa@3106@</mml:annotation></mml:semantics></mml:math></inline-formula>.</p><p>In the context of the detection of regulatory elements, different mapping functions can be used to obtain the translation from <italic>S </italic>to <italic>M </italic>such as a collection of position weight matrices (PWMs) representing TFBSs (JASPAR [<xref ref-type="bibr" rid="B14">14</xref>], PROMO [<xref ref-type="bibr" rid="B15">15</xref>] or TRANSFAC [<xref ref-type="bibr" rid="B16">16</xref>]), or a pattern discovery tool that identifies a set of unknown motifs conserved in several promoters (e.g. MEME [<xref ref-type="bibr" rid="B17">17</xref>]). In practice, for each match over a given threshold, we register a new TF-tuple in <italic>M </italic>defined by the label (<inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M11" name="1471-2105-8-138-i2" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>f</mml:mi></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF"> MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGTbqBdaqhaaWcbaGaemyAaKgabaGaemOzaygaaaaa@30EC@</mml:annotation></mml:semantics></mml:math></inline-formula>) of the TF or the pattern, the positions (<inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M12" name="1471-2105-8-138-i3" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF"> MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGTbqBdaqhaaWcbaGaemyAaKgabaGaemiCaaNaeGymaedaaaaa@31F0@</mml:annotation></mml:semantics></mml:math></inline-formula>, <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M13" name="1471-2105-8-138-i4" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF"> MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGTbqBdaqhaaWcbaGaemyAaKgabaGaemiCaaNaeGOmaidaaaaa@31F2@</mml:annotation></mml:semantics></mml:math></inline-formula>) and the score (<inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M14" name="1471-2105-8-138-i5" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF"> MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGTbqBdaqhaaWcbaGaemyAaKgabaGaem4Camhaaaaa@3106@</mml:annotation></mml:semantics></mml:math></inline-formula>) of the match (see Figure <xref ref-type="fig" rid="F1">1(A)</xref>, for an example). This translation preserves the order of <italic>S </italic>in <italic>M</italic>, that is if <italic>i </italic>&#x0003c;<italic>j </italic>in <italic>M </italic>then <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M15" name="1471-2105-8-138-i3" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF"> MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGTbqBdaqhaaWcbaGaemyAaKgabaGaemiCaaNaeGymaedaaaaa@31F0@</mml:annotation></mml:semantics></mml:math></inline-formula> &#x0003c;<inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M16" name="1471-2105-8-138-i6" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>m</mml:mi><mml:mi>j</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF"> MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGTbqBdaqhaaWcbaGaemOAaOgabaGaemiCaaNaeGymaedaaaaa@31F2@</mml:annotation></mml:semantics></mml:math></inline-formula>. Matches to different TFs may possibly occur at the same position, being false positives in most cases (see a real example in Figure <xref ref-type="fig" rid="F1">1(B)</xref>). We refer to the resulting sequence of TF-tuples <italic>M </italic>as a Transcription Factor Map, or simply a TF-map.</p><fig position="float" id="F1"><label>Figure 1</label><caption><p>(A) The sequence of a promoter is searched for occurrences of known binding motifs for transcription factors (TFs), using a collection of position weight matrices. Matches are denoted as TF-tuples that contain the label of the TF, the positions of the match in the primary sequence, and the score provided by the corresponding matrix. Because binding sites tolerate sequence substitutions, several overlapping TF-tuples can be identified in a subset of positions. TF-tuples are graphically represented as boxes along the promoter sequence. Each TF is denoted with a different color. (B) Promoter TF-mapping of the <italic>phospholipase A</italic>1 gene (RefSeq: NM 015900, 500 nucleotides). TRANSFAC 6.3 was used as the mapping function [16]. In both cases, the TF occurrences are displayed as boxes along the promoter. In (A), the boxes are condensed in a single line. The TF-map graphical representation has been produced with the program gff2ps [27].</p></caption><graphic xlink:href="1471-2105-8-138-1"/></fig><p>In the implementation here, matches to PWMs are considered strandless, that is, they are annotated at a given location, irrespective of the orientation in which they occur. While biological evidence suggests that some TFBSs are functional only when present in a given strand, in other cases TF activity appears to be independent of the orientation of the binding site [<xref ref-type="bibr" rid="B18">18</xref>,<xref ref-type="bibr" rid="B19">19</xref>]. Since in general, we do not have information of the strand in which a binding site may be functional, we have not considered strand in our analysis.</p></sec><sec><title>Multiple alignment of TF-maps</title><p>Let <italic>M</italic><sub>1</sub>, <italic>M</italic><sub>2</sub>, ..., <italic>M</italic><sub><italic>k </italic></sub>be a set of TF-maps. Each map is denoted as <italic>M</italic><sub><italic>i </italic></sub>= <italic>m</italic><sub><italic>i</italic>, 1</sub><italic>m</italic><sub><italic>i</italic>, 2 </sub>... <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M17" name="1471-2105-8-138-i7" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:msub></mml:mrow><mml:annotation encoding="MathType-MTEF"> MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGTbqBdaWgaaWcbaGaemyAaKMaeiilaWIaeiiFaWNaemyta00aaSbaaWqaaiabdMgaPbqabaWccqGG8baFaeqaaaaa@362C@</mml:annotation></mml:semantics></mml:math></inline-formula> where <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M18" name="1471-2105-8-138-i8" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>m</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mi>f</mml:mi></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF"> MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGTbqBdaqhaaWcbaGaemyAaKMaeiilaWIaemOAaOgabaGaemOzaygaaaaa@3329@</mml:annotation></mml:semantics></mml:math></inline-formula> &#x02208; &#x02211;<sub><italic>TF</italic></sub>. Let <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M19" name="1471-2105-8-138-i9" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>M</mml:mi><mml:mn>1</mml:mn><mml:mo>&#x02217;</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>M</mml:mi><mml:mn>2</mml:mn><mml:mo>&#x02217;</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:mn>...</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mi>M</mml:mi><mml:mi>k</mml:mi><mml:mo>&#x02217;</mml:mo></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF"> MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGnbqtdaqhaaWcbaGaeGymaedabaGaey4fIOcaaOGaeiilaWIaemyta00aa0baaSqaaiabikdaYaqaaiabgEHiQaaakiabcYcaSiabc6caUiabc6caUiabc6caUiabcYcaSiabd2eannaaDaaaleaacqWGRbWAaeaacqGHxiIkaaaaaa@3C0A@</mml:annotation></mml:semantics></mml:math></inline-formula> be the extended set of TF-maps. Each extended map is denoted as <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M20" name="1471-2105-8-138-i10" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>M</mml:mi><mml:mi>i</mml:mi><mml:mo>&#x02217;</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>m</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>&#x02217;</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>m</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo>&#x02217;</mml:mo></mml:msubsup><mml:mn>...</mml:mn><mml:msubsup><mml:mi>m</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:msubsup><mml:mi>M</mml:mi><mml:mi>i</mml:mi><mml:mo>&#x02217;</mml:mo></mml:msubsup><mml:mo>|</mml:mo></mml:mrow><mml:mo>&#x02217;</mml:mo></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF"> MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGnbqtdaqhaaWcbaGaemyAaKgabaGaey4fIOcaaOGaeyypa0JaemyBa02aa0baaSqaaiabdMgaPjabcYcaSiabigdaXaqaaiabgEHiQaaakiabcYcaSiabd2gaTnaaDaaaleaacqWGPbqAcqGGSaalcqaIYaGmaeaacqGHxiIkaaGccqGGUaGlcqGGUaGlcqGGUaGlcqWGTbqBdaqhaaWcbaGaemyAaKMaeiilaWIaeiiFaWNaemyta00aa0baaWqaaiabdMgaPbqaaiabgEHiQaaaliabcYha8bqaaiabgEHiQaaaaaa@4BAC@</mml:annotation></mml:semantics></mml:math></inline-formula> where <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M21" name="1471-2105-8-138-i11" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>m</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02217;</mml:mo><mml:mi>f</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF"> MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGTbqBdaqhaaWcbaGaemyAaKMaeiilaWIaemOAaOgabaGaey4fIOIaemOzaygaaaaa@3418@</mml:annotation></mml:semantics></mml:math></inline-formula> &#x02208; <italic>M</italic><sub><italic>i</italic></sub>&#x0222a; {-}. The symbol '-' indicates a gap, which can be considered as a particular TF-tuple &#x0003c; '-', &#x000b7; , &#x000b7;, <italic>&#x003b3; </italic>&#x0003e;. The value &#x000b7; denotes a null value, <italic>&#x003b3; </italic>is the penalty for introducing a gap in a column of the alignment.</p><p>The multiple alignment of <italic>k </italic>maps <italic>M</italic><sub>1</sub>, <italic>M</italic><sub>2</sub>, ..., <italic>M</italic><sub><italic>k </italic></sub>is defined as a rectangular array <italic>T </italic>where each column <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M22" name="1471-2105-8-138-i12" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mi>T</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>m</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mo>&#x02217;</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>m</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mo>&#x02217;</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:mn>...</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mi>m</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mo>&#x02217;</mml:mo></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:annotation encoding="MathType-MTEF"> MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGubavcqGGOaakcqWGPbqAcqGGPaqkcqGH9aqpcqGGOaakcqWGTbqBdaqhaaWcbaGaeGymaeJaeiilaWIaemyAaKgabaGaey4fIOcaaOGaeiilaWIaemyBa02aa0baaSqaaiabikdaYiabcYcaSiabdMgaPbqaaiabgEHiQaaakiabcYcaSiabc6caUiabc6caUiabc6caUiabcYcaSiabd2gaTnaaDaaaleaacqWGRbWAcqGGSaalcqWGPbqAaeaacqGHxiIkaaGccqGGPaqkaaa@4A7B@</mml:annotation></mml:semantics></mml:math></inline-formula> is the multiple match among the TF-tuples in position <italic>i </italic>from the extended maps <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M23" name="1471-2105-8-138-i9" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>M</mml:mi><mml:mn>1</mml:mn><mml:mo>&#x02217;</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>M</mml:mi><mml:mn>2</mml:mn><mml:mo>&#x02217;</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:mn>...</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mi>M</mml:mi><mml:mi>k</mml:mi><mml:mo>&#x02217;</mml:mo></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF"> MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGnbqtdaqhaaWcbaGaeGymaedabaGaey4fIOcaaOGaeiilaWIaemyta00aa0baaSqaaiabikdaYaqaaiabgEHiQaaakiabcYcaSiabc6caUiabc6caUiabc6caUiabcYcaSiabd2eannaaDaaaleaacqWGRbWAaeaacqGHxiIkaaaaaa@3C0A@</mml:annotation></mml:semantics></mml:math></inline-formula>:</p><p><disp-formula id="bmcM1"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M24" name="1471-2105-8-138-i13" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msubsup><mml:mi>m</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>&#x02217;</mml:mo></mml:msubsup></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msubsup><mml:mi>m</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo>&#x02217;</mml:mo></mml:msubsup></mml:mrow></mml:mtd><mml:mtd><mml:mo>&#x02026;</mml:mo></mml:mtd><mml:mtd><mml:mrow><mml:msubsup><mml:mi>m</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo>&#x02217;</mml:mo></mml:msubsup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msubsup><mml:mi>m</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>&#x02217;</mml:mo></mml:msubsup></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msubsup><mml:mi>m</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo>&#x02217;</mml:mo></mml:msubsup></mml:mrow></mml:mtd><mml:mtd><mml:mo>&#x02026;</mml:mo></mml:mtd><mml:mtd><mml:mrow><mml:msubsup><mml:mi>m</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo>&#x02217;</mml:mo></mml:msubsup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>&#x02026;</mml:mo></mml:mtd><mml:mtd><mml:mrow/></mml:mtd><mml:mtd><mml:mrow/></mml:mtd><mml:mtd><mml:mo>&#x02026;</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msubsup><mml:mi>m</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>&#x02217;</mml:mo></mml:msubsup></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msubsup><mml:mi>m</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo>&#x02217;</mml:mo></mml:msubsup></mml:mrow></mml:mtd><mml:mtd><mml:mo>&#x02026;</mml:mo></mml:mtd><mml:mtd><mml:mrow><mml:msubsup><mml:mi>m</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo>&#x02217;</mml:mo></mml:msubsup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow><mml:annotation encoding="MathType-MTEF"> MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGubavcqGH9aqpdaqadaqaauaabeqaeqaaaaaabaGaemyBa02aa0baaSqaaiabigdaXiabcYcaSiabigdaXaqaaiabgEHiQaaaaOqaaiabd2gaTnaaDaaaleaacqaIXaqmcqGGSaalcqaIYaGmaeaacqGHxiIkaaaakeaacqWIMaYsaeaacqWGTbqBdaqhaaWcbaGaeGymaeJaeiilaWIaemiDaqhabaGaey4fIOcaaaGcbaGaemyBa02aa0baaSqaaiabikdaYiabcYcaSiabigdaXaqaaiabgEHiQaaaaOqaaiabd2gaTnaaDaaaleaacqaIYaGmcqGGSaalcqaIYaGmaeaacqGHxiIkaaaakeaacqWIMaYsaeaacqWGTbqBdaqhaaWcbaGaeGOmaiJaeiilaWIaemiDaqhabaGaey4fIOcaaaGcbaGaeSOjGSeabaaabaaabaGaeSOjGSeabaGaemyBa02aa0baaSqaaiabdUgaRjabcYcaSiabigdaXaqaaiabgEHiQaaaaOqaaiabd2gaTnaaDaaaleaacqWGRbWAcqGGSaalcqaIYaGmaeaacqGHxiIkaaaakeaacqWIMaYsaeaacqWGTbqBdaqhaaWcbaGaem4AaSMaeiilaWIaemiDaqhabaGaey4fIOcaaaaaaOGaayjkaiaawMcaaiabc6caUaaa@6987@</mml:annotation></mml:semantics></mml:math></disp-formula></p><p>Such a multiple TF-map alignment &#x02013; or simply, a multiple map alignment (MMA), in contrast to a multiple sequence alignment (MSA) &#x02013; satisfies the following conditions:</p><p>1. The extended maps have the same length.</p><p>2. If the gaps are removed from each <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M25" name="1471-2105-8-138-i14" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>M</mml:mi><mml:mi>i</mml:mi><mml:mo>&#x02217;</mml:mo></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF"> MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGnbqtdaqhaaWcbaGaemyAaKgabaGaey4fIOcaaaaa@3046@</mml:annotation></mml:semantics></mml:math></inline-formula>, the original <italic>M</italic><sub><italic>i </italic></sub>is recovered.</p><p>3. At least one element in every column is different from a gap.</p><p>4. The elements that are aligned in a column correspond to the same TF.</p><p>Note that the first three conditions define the classical multiple alignment of sequences. The last one, however, introduces a new constrain that is related to the match state, according to the notion of pairwise TF-map alignment provided in [<xref ref-type="bibr" rid="B9">9</xref>].</p></sec><sec><title>The score of a multiple alignment of TF-maps</title><p>Given the multiple alignment <italic>T</italic>, we compute the score of the MMA <italic>s</italic>(<italic>T</italic>) as:</p><p><disp-formula id="bmcM2"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M26" name="1471-2105-8-138-i15" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi>&#x003b1;</mml:mi><mml:mstyle displaystyle="true"><mml:msubsup><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mrow><mml:mstyle displaystyle="true"><mml:msubsup><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:msubsup><mml:mrow><mml:msubsup><mml:mi>m</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02217;</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mi>s</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mo>=</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mo>&#x02212;</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi>&#x003bb;</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mo>&#x02212;</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi>&#x003bc;</mml:mi><mml:mstyle displaystyle="true"><mml:msub><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mo>&#x02200;</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>i</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mrow><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>m</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02217;</mml:mo><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>&#x02212;</mml:mo><mml:msubsup><mml:mi>m</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msup><mml:mi>i</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:mrow><mml:mrow><mml:mo>&#x02217;</mml:mo><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mn>...</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mi>m</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02217;</mml:mo><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>&#x02212;</mml:mo><mml:msubsup><mml:mi>m</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>i</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:mrow><mml:mrow><mml:mo>&#x02217;</mml:mo><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:annotation encoding="MathType-MTEF"> MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaafaqaaeWaeaaaaeaaaeaaaeaaaeaaiiGacqWFXoqydaaeWaqaamaaqadabaGaemyBa02aa0baaSqaaiabdQgaQjabcYcaSiabdMgaPbqaaiabgEHiQiabdohaZbaaaeaacqWGQbGAcqGH9aqpcqaIXaqmaeaacqWGRbWAa0GaeyyeIuoaaSqaaiabdMgaPjabg2da9iabigdaXaqaaiabdsha0bqdcqGHris5aaGcbaGaem4CamNaeiikaGIaemivaqLaeiykaKcabaGaeyypa0dabaGaeyOeI0cabaGae83UdWMaeiikaGIaem4zaCMaeiykaKcabaaabaaabaGaeyOeI0cabaGae8hVd02aaabeaeaacqWGMbGzcqGGOaakcqWGTbqBdaqhaaWcbaGaeGymaeJaeiilaWIaemyAaKgabaGaey4fIOIaemiCaaNaeGymaedaaOGaeyOeI0IaemyBa02aa0baaSqaaiabigdaXiabcYcaSiqbdMgaPzaafaaabaGaey4fIOIaemiCaaNaeGymaedaaOGaeiilaWIaeiOla4IaeiOla4IaeiOla4IaeiilaWIaemyBa02aa0baaSqaaiabdUgaRjabcYcaSiabdMgaPbqaaiabgEHiQiabdchaWjabigdaXaaakiabgkHiTiabd2gaTnaaDaaaleaacqWGRbWAcqGGSaalcuWGPbqAgaqbaaqaaiabgEHiQiabdchaWjabigdaXaaakiabcMcaPaWcbaGaeyiaIiIaemyAaKMaeiilaWIafmyAaKMbauaaaeqaniabggHiLdaaaaaa@81D0@</mml:annotation></mml:semantics></mml:math></disp-formula></p><p>where <italic>&#x003b1;</italic>, <italic>&#x003bb;</italic>, <italic>&#x003bc;</italic>, &#x0003e; 0, <italic>g </italic>is the number of columns with only one element different from a gap in the MMA (unaligned elements), and <italic>f </italic>is a function that measures the conservation of distance between the sites of every map in two consecutive columns (<italic>i</italic>, <italic>i'</italic>) with at least two aligned elements in the MMA. That is, the score of the alignment increases with the score of the aligned elements (<italic>&#x003b1;</italic>), and decreases with the number of gaps (<italic>&#x003b3;</italic>), the number of unaligned elements (<italic>&#x003bb;</italic>), and with the difference in the distance between adjacent aligned elements (<italic>&#x003bc;</italic>). See [<xref ref-type="bibr" rid="B9">9</xref>] for further details about the TF-map alignment parameters.</p></sec><sec><title>The algorithms</title><p>There are many possible alignments among multiple TF-maps. The optimal alignment is the one scoring the maximum (that is, showing maximum similarity) among all possible alignments. In a previous work [<xref ref-type="bibr" rid="B9">9</xref>], we implemented a dynamic programming algorithm to obtain such an alignment efficiently for the case of two TF-maps. The optimal multiple sequence alignment problem (and therefore the multiple alignment of maps as well) is, however, much more difficult, being formally a NP-complete problem [<xref ref-type="bibr" rid="B20">20</xref>].</p><p>Here, we propose to adapt the popular progressive alignment strategy to the TF-map alignment. The solutions obtained by this method are not guaranteed to be optimal. However, multiple progressive alignments usually capture the sequence features underlying the common functionality shared by the aligned sequences [<xref ref-type="bibr" rid="B5">5</xref>]. We have generalized the basic pairwise TF-map alignment algorithm developed in [<xref ref-type="bibr" rid="B9">9</xref>] in order to allow the comparisons between two single TF-maps, a TF-map and a MMA, and two MMAs.</p></sec><sec><title>The alignment of two MMAs</title><p>Let <italic>A</italic><sub><italic>x </italic></sub>= <italic>m</italic><sub><italic>x</italic>, 1</sub><italic>m</italic><sub><italic>x</italic>, 2 </sub>... <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M27" name="1471-2105-8-138-i16" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:msub></mml:mrow><mml:annotation encoding="MathType-MTEF"> MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGTbqBdaWgaaWcbaGaemiEaGNaeiilaWIaeiiFaWNaemyqae0aaSbaaWqaaiabdIha4bqabaWccqGG8baFaeqaaaaa@3650@</mml:annotation></mml:semantics></mml:math></inline-formula> and <italic>A</italic><sub><italic>y </italic></sub>= <italic>m</italic><sub><italic>y</italic>, 1</sub><italic>m</italic><sub><italic>y</italic>, 2 </sub>... <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M28" name="1471-2105-8-138-i17" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:msub></mml:mrow><mml:annotation encoding="MathType-MTEF"> MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGTbqBdaWgaaWcbaGaemyEaKNaeiilaWIaeiiFaWNaemyqae0aaSbaaWqaaiabdMha5bqabaWccqGG8baFaeqaaaaa@3654@</mml:annotation></mml:semantics></mml:math></inline-formula> be two MMAs that have been already computed. Let <italic>S </italic>be the scoring dynamic programming matrix where <italic>S</italic>(<italic>i</italic>, <italic>j</italic>) = <italic>S</italic>(<italic>m</italic><sub><italic>x</italic>, <italic>i</italic></sub>, <italic>m</italic><sub><italic>y</italic>, <italic>j</italic></sub>) denotes the score of the best TF-map alignment of the alignments <italic>A</italic><sub><italic>x </italic></sub>= <italic>m</italic><sub><italic>x</italic>, 1 </sub>... <italic>m</italic><sub><italic>x</italic>, <italic>i </italic></sub>and <italic>A</italic><sub><italic>y </italic></sub>= <italic>m</italic><sub><italic>y</italic>, 1 </sub>... <italic>m</italic><sub><italic>y</italic>, <italic>j </italic></sub>as defined previously (Equation 2). The <italic>ComputePairwiseSimilarity </italic>algorithm shown below is a generalization of that developed in [<xref ref-type="bibr" rid="B9">9</xref>] to align two TF-maps that computes the optimal pairwise TF-map alignment between <italic>A</italic><sub><italic>x </italic></sub>and <italic>A</italic><sub><italic>y</italic></sub>.</p><p>This algorithm basically searches the maps of both alignments to find matches between one site in the first alignment and one site in the second one. Once a new match is identified, the previous matches must be evaluated in order to construct the optimal alignment with this new one (see Figure <xref ref-type="fig" rid="F2">2</xref>). Because this class of scoring matrices are highly sparse [<xref ref-type="bibr" rid="B9">9</xref>], we register the coordinates in <italic>S </italic>of the matches computed previously. Thus, to compute the optimal score at the cell <italic>S</italic>(<italic>i</italic>, <italic>j</italic>), only the non-empty cells in <italic>S </italic>that are visible for the current match need to be accessed. In addition, we maintain the list sorted by optimal score, so that the cell scoring the maximum value is at the beginning of the list and, in most cases, only a few nodes will need to be accessed before a critical node is reached beyond which the optimal score can not be improved [<xref ref-type="bibr" rid="B9">9</xref>].</p><fig position="float" id="F2"><label>Figure 2</label><caption><p>Graphical representation of the dynamic programming matrix produced in the alignment of two MMAs <italic>A</italic><sub><italic>x </italic></sub>and <italic>A</italic><sub><italic>y</italic></sub>. A new match between sites from both alignments must preserve the previous internal alignment (matches in red). For each new match (<italic>A</italic>), the best previous aligned match (<italic>B</italic>) must be selected to form the optimal alignment.</p></caption><graphic xlink:href="1471-2105-8-138-2"/></fig><p>The number of computations <italic>P</italic>(<italic>n</italic>) in this algorithm is very similar to that obtained in the conventional pairwise TF-map alignment algorithm [<xref ref-type="bibr" rid="B9">9</xref>]. The exact complexity of this algorithm is difficult to be studied &#x02013; depending mostly on the size of the input maps and the sparsity of the resulting matrix <italic>S</italic>. An expected time cost analysis reveals that the cost function can be explained in terms of (a) a first quadratic term derived from the necessary comparison between all of the TFBSs of both maps to detect the match cells and (b) a second quadratic term necessary to search for each match the best adjacent previous pair in the optimal TF-map alignment. In [<xref ref-type="bibr" rid="B9">9</xref>], we studied the positive contribution of using a list of non-empty cells in <italic>S </italic>that reduces the second component to an expected cost of <italic>O</italic>(<italic>p</italic>&#x000b7;<italic>n</italic><sup>2</sup>), where <italic>p </italic>is the percentage of the similarity matrix that is occupied. In the case of pairwise TF-map promoter comparisons, this value was estimated to be below 0.05 (less than 5% of occupancy).</p><sec><title>Implementation</title><p>In the pseudocode below, the alignments <italic>A</italic><sub><italic>x </italic></sub>and <italic>A</italic><sub><italic>y </italic></sub>are represented as two arrays of sites sorted by the position in their promoters, where each site corresponds to an input TFBS. The MMAs are internally encoded with pointers among the sites that form each match. Gaps here are not explicitly represented. Each site <italic>m</italic><sub><italic>x</italic>, <italic>i </italic></sub>is a structure as described above with the functions <italic>factor</italic>, <italic>pos1</italic>, <italic>pos2 </italic>and <italic>score </italic>returning the values of the corresponding fields.</p><p>The variable <italic>maxSim </italic>stores the optimal score computed so far. The sites in the optimal TF-map alignment can be easily retrieved using a supplementary structure <italic>path</italic>(<italic>i</italic>, <italic>j</italic>) that points to the previous cell in the optimal path leading to cell <italic>S</italic>(<italic>i</italic>, <italic>j</italic>). In addition, the function <italic>ComputeInitialSimilarity </italic>calculates for each match <italic>S</italic>(<italic>i</italic>, <italic>j</italic>) the initial score of a hypothetical alignment that includes only the sites <italic>m</italic><sub><italic>x</italic>, <italic>i </italic></sub>and <italic>m</italic><sub><italic>y</italic>, <italic>j</italic></sub>. Once the match between two sites <italic>m</italic><sub><italic>x</italic>, <italic>i </italic></sub>and <italic>m</italic><sub><italic>y</italic>, <italic>j </italic></sub>has been identified, the best previous match between two other sites <italic>m</italic><sub><italic>x</italic>, <italic>i' </italic></sub>and <italic>m</italic><sub><italic>y</italic>, <italic>j' </italic></sub>is used to construct the new alignment (see the matches <italic>A </italic>and <italic>B </italic>in Figure <xref ref-type="fig" rid="F2">2</xref>). The list <italic>L </italic>is used to locate the non-empty positions in <italic>S</italic>. Each node of the list <italic>L </italic>is represented as structures <italic>p </italic>and <italic>n </italic>with the functions <italic>abscissa </italic>and <italic>ordinate </italic>returning the corresponding coordinates in <italic>S </italic>of each previous match.</p><p>The score of the new match between <italic>m</italic><sub><italic>x</italic>, <italic>i </italic></sub>and <italic>m</italic><sub><italic>y</italic>, <italic>j </italic></sub>is the sum of the scores of the columns in which both elements were aligned in their respective MMAs. Unaligned sites are scored with the gap penalty <italic>&#x003b3; </italic>. The function <italic>ComputeLambda </italic>counts the number of sites in each group that are not included in the alignment, taking into account the size of each individual MMA.</p><p>In practice, we do not allow overlap in the primary sequence between adjacent sites in the alignment. This is not a practical limitation of the algorithm, but a requirement introduced according to our observations in available annotations of regulatory elements. The function <italic>ComputeOverlap </italic>calculates the average distances <italic>D</italic>1 and <italic>D</italic>2 between any pair of consecutive matches in the maps of each alignment, verifying the absence of physical overlap in their promoters. The function |<italic>D</italic>1 - <italic>D</italic>2| scores the conservation of distance between the sites of every map in two consecutive columns on each MMA (function <italic>f</italic>, see Equation 2).</p></sec><sec><title>ComputePairwiseSimilarity</title><p><bold>Require: </bold><italic>A</italic><sub><italic>x</italic></sub>, <italic>A</italic><sub><italic>y</italic></sub>: TF-map alignments, <italic>L</italic>: list of &#x0003c;abscissa, ordinate&#x0003e;, <italic>L </italic>= &#x02205;</p><p>&#x000a0;&#x000a0;&#x000a0;{Calculating the element <italic>i</italic>, <italic>j </italic>in <italic>S</italic>}</p><p>&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;<bold>for </bold><italic>i </italic>= 0 to |<italic>A</italic><sub><italic>x</italic></sub><italic>| - </italic>1 <bold>do</bold></p><p>&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;<bold>for </bold><italic>j </italic>= 0 to |<italic>A</italic><sub><italic>y</italic></sub><italic>| </italic>- 1 <bold>do</bold></p><p>&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;<bold>if </bold>factor(<italic>m</italic><sub><italic>x</italic>, <italic>i</italic></sub>) = factor(<italic>m</italic><sub><italic>y</italic>, <italic>j</italic></sub>) <bold>then </bold></p><p>5:&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;<italic>S</italic>(<italic>i</italic>, <italic>j</italic>)&#x02190; ComputeInitialSimilarity(<italic>m</italic><sub><italic>x</italic>, <italic>i</italic></sub>, <italic>m</italic><sub><italic>y</italic>, <italic>j</italic></sub>);</p><p>&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;<italic>x </italic>&#x02190; <italic>&#x003b1; </italic>(score(<italic>m</italic><sub><italic>i</italic></sub>) + score(<italic>m</italic><sub><italic>j</italic></sub>));</p><p>&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;{Searching the best previous match in <italic>L</italic>}</p><p>&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;<italic>p </italic>&#x02190; first (<italic>L</italic>);</p><p>&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;<italic>i' </italic>&#x02190; abscissa(<italic>p</italic>);</p><p>10:&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;<italic>j' </italic>&#x02190; ordinate(<italic>p</italic>);</p><p>&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;<bold>while </bold>end(<italic>L</italic>) = FALSE and <italic>S</italic>(<italic>i'</italic>, <italic>j'</italic>)<italic>+ x </italic>&#x0003e;<italic>S</italic>(<italic>i</italic>, <italic>j</italic>) <bold>do</bold></p><p>&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;{Compute the <italic>&#x003bc; </italic>value and check overlap}</p><p>&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;(<italic>D</italic>1, <italic>D</italic>2, overlap) &#x02190; ComputeOverlap(<italic>i</italic>, <italic>i'</italic>, <italic>j</italic>, <italic>j'</italic>, <italic>A</italic><sub><italic>x</italic></sub>, <italic>A</italic><sub><italic>y</italic></sub>);</p><p>&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;<bold>if </bold>overlap = FALSE <bold>then</bold></p><p>15:&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;<italic>y </italic>&#x02190; <italic>&#x003bb; </italic>(ComputeLambda(<italic>i</italic>, <italic>i</italic>', <italic>j</italic>, <italic>j'</italic>));</p><p>&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;<italic>z </italic>&#x02190; <italic>&#x003bc; </italic>(|<italic>D</italic>1- <italic>D</italic>2|);</p><p>&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;maxSim &#x02190; <italic>S</italic>(<italic>i'</italic>, <italic>j'</italic>) + <italic>x - y - z;</italic></p><p>&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;<bold>if </bold>maxSim &#x0003e; <italic>S</italic>(<italic>i</italic>, <italic>j</italic>)<bold>then</bold></p><p>&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;<italic>S</italic>(<italic>i</italic>, <italic>j</italic>) &#x02190; maxSim;</p><p>20:&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;<italic>p </italic>&#x02190; next(<italic>L</italic>);</p><p>&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;<italic>i' </italic>&#x02190; abscissa(<italic>p</italic>);</p><p>&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;<italic>j' </italic>&#x02190; ordinate(<italic>p</italic>);</p><p>&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;<italic>n </italic>&#x02190; CreateNewNode(<italic>i</italic>, <italic>j</italic>);</p><p>&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;InsertNode(<italic>n</italic>, <italic>L</italic>);</p></sec></sec><sec><title>Progressive MMA algorithm</title><p>Let (<italic>A</italic><sub>1 </sub>... <italic>A</italic><sub><italic>k</italic></sub>) be the initial list of <italic>k </italic>TF-map alignments, where each alignment <italic>A</italic><sub><italic>i </italic></sub>contains a single TF-map. Let <italic>S </italic>be the similarity matrix where <italic>S</italic>(<italic>A</italic><sub><italic>i</italic></sub>, <italic>A</italic><sub><italic>j</italic></sub>) denotes the similarity between two TF-map alignments <italic>A</italic><sub><italic>i </italic></sub>and <italic>A</italic><sub><italic>j</italic></sub>.</p><p>The progressive MMA algorithm shown below builds up a multiple TF-map alignment in a stepwise manner. In a first step, all pairwise TF-map alignments are performed. The initial multiple alignment is created with the two most similar ones. These maps are substituted for the alignment of both. The similarity between this new alignment and the rest of the TF-maps is then estimated, updating the <italic>S </italic>matrix (see Implementation).</p><p>In a second step, an iterative procedure selects at each round the pair of alignments that are more similar from the pool of available ones. These two alignments are then merged into a new MMA, estimating the similarity to the remaining ones. At the end of the process, there is only one alignment that contains the multiple alignment of the input maps.</p><p>The cost of the progressive MMA can be expressed in terms of the number of pairwise TF-map alignments that must be computed. Let <italic>k </italic>be the number of maps to be aligned and <italic>n </italic>be the length of each map. The initial round performs <italic>O</italic>(<italic>k</italic><sup>2</sup>) pairwise alignments. Next, the progressive rounds perform <italic>O</italic>(<italic>k</italic>) alignments involving two previous alignments. Let <italic>P</italic>(<italic>n</italic>) be the cost of each pairwise operation (see previous section), then the cost of the progressive map alignment algorithm is <italic>O</italic>(<italic>k</italic><sup>2 </sup><italic>P</italic>(<italic>n</italic>)).</p><sec><title>Implementation</title><p>In the progressive MMA algorithm shown below, the variable <italic>maxSim </italic>saves the maximum score so far computed at each round. The identifiers of the alignments that produce such a score can easily be retrieved using a supplementary pair of variables <italic>iSim</italic>, <italic>jSim</italic>.</p><p>The function <italic>ComputePairwiseSimilarity </italic>is a generalization of the TF-map alignment algorithm presented in [<xref ref-type="bibr" rid="B9">9</xref>], as explained in the previous section. The optimal pairwise alignments between the input TF-maps in the initial round are saved, as they could be required during the iterative procedure.</p><p>Once a new TF-map alignment is created from the two most similar ones, their binding sites must be merged (function <italic>MergeAlignments</italic>). The order of the TFBSs in the new alignment must take into account the position of the binding sites in their primary promoter sequences. In the approach here, we do not create a profile of each MMA. Instead, all of the TFBSs of each alignment are always available for subsequent TF-map alignments.</p><p>The alignments between this new TF-map alignment and the others are not explicitly computed. The similarity of them is instead estimated with the WPGMA method (Weighted Pair Group Method with Arithmetic Mean [<xref ref-type="bibr" rid="B21">21</xref>]), in which the similarity of the previous alignments between <italic>A</italic><sub><italic>iSim </italic></sub>and <italic>A</italic><sub><italic>jSim </italic></sub>to the other alignments is weighted according to the number of maps of each one. If an estimated alignment between two MMAs is identified as the most similar one during the progressive step, then it must be explicitly computed before merging both TF-map alignments.</p></sec><sec><title>Progressive MMA algorithm</title><p><bold>Require: </bold><italic>A</italic>: list of TF-map alignments (<italic>A</italic><sub>1 </sub>... <italic>A</italic><sub><italic>k</italic></sub>)</p><p>&#x000a0;&#x000a0;&#x000a0;{Initial Step: pairwise alignment all Vs all}</p><p>&#x000a0;&#x000a0;&#x000a0;maxSim &#x02190; -&#x0221e;</p><p>&#x000a0;&#x000a0;&#x000a0;<bold>for </bold><italic>i </italic>= 1 to <italic>k </italic><bold>do</bold></p><p>5:&#x000a0;&#x000a0;<bold>for </bold><italic>j </italic>= <italic>i </italic>+ 1 to <italic>k </italic><bold>do</bold></p><p>&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;<italic>S</italic>(<italic>A</italic><sub><italic>i</italic></sub><italic>, A</italic><sub><italic>j</italic></sub>) &#x02190; ComputePairwiseSimilarity(<italic>A</italic><sub><italic>i</italic></sub>, <italic>A</italic><sub><italic>j</italic></sub>);</p><p>&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;{Select the pair with maximum similarity}</p><p>&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;maxSim &#x02190; max(maxSim, <italic>S</italic>(<italic>A</italic><sub><italic>i</italic></sub>, <italic>A</italic><sub><italic>j</italic></sub>));</p><p>&#x000a0;&#x000a0;&#x000a0;{Create a new MMA: estimate the similarity to others}</p><p>10:<italic>A</italic><sub><italic>iSim</italic>-<italic>jSim </italic></sub>&#x02190; Merge Alignments(<italic>A</italic><sub><italic>iSim</italic></sub><italic>, A</italic><sub><italic>jSim</italic></sub>);</p><p>&#x000a0;&#x000a0;&#x000a0;{Progressive Step: select the two most similar alignments}</p><p>&#x000a0;&#x000a0;&#x000a0;<bold>while </bold>|<italic>A</italic>| &#x0003e; 1 <bold>do</bold></p><p>&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;maxSim &#x02190; -&#x0221e;</p><p>15:&#x000a0;&#x000a0;&#x000a0;<bold>for </bold><italic>i </italic>= 1 to |<italic>A</italic>| <bold>do</bold></p><p>&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;<bold>for </bold><italic>j </italic>= <italic>i </italic>+ 1 to |<italic>A</italic>| <bold>do</bold></p><p>&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;{Select the pair with maximum similarity}</p><p>&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;maxSim &#x02190; max(maxSim, <italic>S</italic>(<italic>A</italic><sub><italic>i</italic></sub>, <italic>A</italic><sub><italic>j</italic></sub>));</p><p>&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;{Create a new MMA: estimate the similarity to others}</p><p>20:&#x000a0;&#x000a0;&#x000a0;<italic>A</italic><sub><italic>iSim</italic>-<italic>jSim </italic></sub>&#x02190; Merge Alignments (<italic>A</italic><sub><italic>iSim</italic></sub>, <italic>A</italic><sub><italic>jSim</italic></sub>);</p></sec></sec><sec><title>Non-collinear TF-map alignments</title><p>The existence of regulatory elements that are conserved in different order among related regulatory regions has been documented in a few cases, specially in enhancers [<xref ref-type="bibr" rid="B22">22</xref>]. The identification of these regulatory rearrangements is very difficult at the sequence level. We have here introduced some subtle changes in the pairwise TF-map alignment algorithm shown before to deal with non-collinear alignments. The aligned TFBSs in such MMAs are therefore not necessarily located in the same relative order in every map.</p><sec><title>Definition</title><p>Let T be an alignment between two TF-maps <italic>M</italic><sub>1 </sub>and <italic>M</italic><sub>2 </sub>formally defined as a correspondence <italic>T </italic>= {(<italic>m</italic><sub>1, 1</sub>, <italic>m</italic><sub>2, 1</sub>), ..., (<italic>m</italic><sub>1, <italic>t</italic></sub>, <italic>m</italic><sub>2, <italic>t</italic></sub>)} [<xref ref-type="bibr" rid="B9">9</xref>]. Let (<italic>m</italic><sub>1, <italic>i</italic></sub>, <italic>m</italic><sub>2, <italic>j</italic></sub>) and (<italic>m</italic><sub>1, <italic>k</italic></sub>, <italic>m</italic><sub>2, <italic>l</italic></sub>) be two matches in <italic>T</italic>, not necessarily contiguous, with <italic>i </italic>&#x0003c;<italic>k</italic>. Then, we define the collinearity or non-collinearity of <italic>T </italic>in terms of the partial order between <italic>j </italic>and <italic>l</italic>, for all the match pairs of <italic>T </italic>as:</p><p>1. If <italic>j </italic>&#x0003c;<italic>l </italic>then <italic>T </italic>is a collinear alignment</p><p>2. If <italic>j </italic>&#x0003e; <italic>l </italic>then <italic>T </italic>is a non-collinear alignment (see example shown in Figure <xref ref-type="fig" rid="F3">3(A)</xref>).</p><fig position="float" id="F3"><label>Figure 3</label><caption><p>Graphical representation of two examples of non-collinear TF-map alignments. In (A), the alignment involves only two TF-maps. In (B), the resulting multiple alignment of three maps contains a non-collinear block of three TFBSs.</p></caption><graphic xlink:href="1471-2105-8-138-3"/></fig><p>The generalization of this definition for <italic>k </italic>&#x0003e; 2 TF-maps is trivial (see the example of a non-collinear alignment for <italic>k </italic>= 3 TF-maps in Figure <xref ref-type="fig" rid="F3">3(B)</xref>).</p></sec><sec><title>Algorithm</title><p>The non-collinear matches shown in Figure <xref ref-type="fig" rid="F3">3</xref> can not be detected in the basic pairwise TF-map alignment algorithm [<xref ref-type="bibr" rid="B9">9</xref>]. Let <italic>A </italic>and <italic>B </italic>be two TF-maps in which two matches could form a non collinear alignment (represented as a circle and a square in Figure <xref ref-type="fig" rid="F4">4</xref>). The normal implementation fills the matrix in row by row, from top to bottom (or column by column, from left to right).</p><fig position="float" id="F4"><label>Figure 4</label><caption><p>Different forms to fill a dynamic programming matrix in during the alignment. For a current match between two alignments (denoted as a red square), the available area to search the best previous match when the matrix is processed row by row is depicted in green. For the same element, the additional area to search the best previous match when the matrix is processed diagonal by diagonal is depicted in blue. With the diagonal filling, a previous match (denoted as a red circle) that forms a non-collinear alignment can be detected.</p></caption><graphic xlink:href="1471-2105-8-138-4"/></fig><p>According to this, when the first match is being processed (red square), the second one (red circle) is not yet available (the red circle is not in the green area). Conversely, when the second match is processed, the first one is not accessible as the basic algorithm only allows the search for best previous aligned elements in the list of computed values that are in the area delimited by the current match (area denoted by dotted lines).</p><p>To overcome such a limitation, we propose to compute the optimal values of the matrix <italic>S </italic>following a different order, to allow the second element (red circle) to be visible when the first one is being processed (red square). A diagonal filling of the matrix calculates first the match between circles (see Figure <xref ref-type="fig" rid="F4">4</xref>).</p><p>Thus, this element will be available to compute the best alignment for the match between squares that is processed later. While this strategy still produces the same alignments obtained with the ordinary implementation, non-collinear alignments produced by new combinations of matches can also be constructed.</p></sec><sec><title>Adjusting the non-collinearity</title><p>We have designed a simple mechanism to adjust the frequency of non-collinear aligned sites in the output. An additional parameter <italic>c </italic>has been introduced in the basic MMA algorithm to weight those alignments involving non-collinearity.</p><p>Let <italic>A </italic>and <italic>B </italic>be two TF-maps in which a previous match has been identified (represented as two circles in Figure <xref ref-type="fig" rid="F5">5(A)</xref>). Then, a second match between one element in <italic>A </italic>and another one in <italic>B </italic>is being processed (represented as two squares in Figure <xref ref-type="fig" rid="F5">5(A)</xref>). The dotted lines indicate that such a site in <italic>B </italic>can be located either on the left or on the right of the circle site in the same map. In the first case, a non-collinear alignment is produced; in the second case, a normal collinear alignment is constructed. The case in which the non-collinear match occurs in <italic>A </italic>can be similarly defined.</p><fig position="float" id="F5"><label>Figure 5</label><caption><p>(A) A graphical explanation of the parameter <italic>c </italic>that controls the proportion of non-collinear blocks in a resulting alignment; (B) Number of inversions in the TF-map alignment of the human and mouse promoters (500 nucleotides) of the <italic>MMP13 </italic>gene (RefSeq: NM 002427 and NM 008607), using multiple values of <italic>c</italic>.</p></caption><graphic xlink:href="1471-2105-8-138-5"/></fig><p>The algorithm to align two MMAs must be slightly modified to accomodate the non-collinearity parameter <italic>c</italic>. The variable <italic>z </italic>in the <italic>ComputePairwiseSimilarity </italic>is defined now as:</p><p><disp-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M29" name="1471-2105-8-138-i18" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mi>z</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mtext>if</mml:mtext></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>&#x0003c;</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>&#x02192;</mml:mo><mml:mi>&#x003bc;</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>&#x02212;</mml:mo><mml:mi>c</mml:mi><mml:mo>&#x022c5;</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mo>&#x02265;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mtext>if</mml:mtext></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>&#x02265;</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>&#x02192;</mml:mo><mml:mi>&#x003bc;</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo>.</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:annotation encoding="MathType-MTEF"> MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWG6bGEcqGH9aqpdaGabeqaauaabaqacmaaaeaacqqGPbqAcqqGMbGzaeaacqGGOaakcqWGebardaWgaaWcbaGaeGOmaidabeaakiabgYda8iabicdaWiabcMcaPaqaaiabgkziUIGaciab=X7aTjabcYha8jabdseaenaaBaaaleaacqaIXaqmaeqaaOGaeyOeI0Iaem4yamMaeyyXICTaemiraq0aaSbaaSqaaiabikdaYaqabaGccqGG8baFcqGGSaalcqWGJbWycqGHLjYScqaIXaqmaeaacqqGPbqAcqqGMbGzaeaacqGGOaakcqWGebardaWgaaWcbaGaeGOmaidabeaakiabgwMiZkabicdaWiabcMcaPaqaaiabgkziUkab=X7aTjabcYha8jabdseaenaaBaaaleaacqaIXaqmaeqaaOGaeyOeI0Iaemiraq0aaSbaaSqaaiabikdaYaqabaGccqGGPaqkaaGaeiOla4cacaGL7baaaaa@62EE@</mml:annotation></mml:semantics></mml:math></disp-formula></p><p>The optimal positional conservation between both matches occurs when <italic>D</italic><sub>1 </sub>= <italic>D</italic><sub>2</sub>. However, the parameter c is used in the <italic>&#x003bc;</italic>, penalty to punish only those matches that do not respect the collinearity of the current alignment (the square site is on the left of the circle site in <italic>B</italic>, see Figure <xref ref-type="fig" rid="F5">5(A)</xref>).</p><p>Informally, if <italic>c </italic>= 1 then both collinear and non-colinear matches are indistinctly combined into the resulting MMA. High values of <italic>c</italic>, however, produce a higher amount of collinear matches into the results. In order to establish formally the behaviour of this parameter, we have counted the number of non-collinear matches in the TF-map alignment of the human and mouse promoters (500 nucleotides) of the <italic>MMP13 </italic>gene (RefSeq: NM_002427, NM_008607). In Figure <xref ref-type="fig" rid="F5">5(B)</xref>, there is a clear correspondence between the amount of inversions in the MMA and the value of <italic>c</italic>. No inversions are produced for large values of <italic>c</italic>. Identification of non-collinear configurations of TFBSs in regulatory regions is poorly known, and only a few cases are documented [<xref ref-type="bibr" rid="B22">22</xref>]. We recommend, therefore, to use this option very carefully. In addition, we also suggest the use of a small set of matrices to perform the mapping, which can reduce the number of artifacts in the resulting non-collinear MMA (see Promoter characterization section, <italic>even-skipped </italic>stripe 2 enhancer).</p></sec></sec><sec><title>Datasets and software availability</title><p>The datasets used in this paper are available at [<xref ref-type="bibr" rid="B23">23</xref>]. An implementation of this algorithm has been written in C and is publicly available at [<xref ref-type="bibr" rid="B24">24</xref>]. A web server that performs the mapping and the alignment of multiple promoter regions with such an algorithm is accessible at [<xref ref-type="bibr" rid="B25">25</xref>].</p><p>The input of the program consists of a file that contains the TF-maps to be aligned. The file must be in General Feature Format [<xref ref-type="bibr" rid="B26">26</xref>]. Options allow to control the values of <italic>&#x003b1;</italic>, <italic>&#x003bb;</italic>, <italic>&#x003bc;</italic>, <italic>&#x003b3; </italic>and <italic>c </italic>as well as to display the results in plain format or GFF format. The output includes the score and the length of the optimal MMA, and the matches in the input TF-maps (see Figure <xref ref-type="fig" rid="F6">6</xref> for an example). A graphical representation of the MMA is also displayed using the program gff2ps [<xref ref-type="bibr" rid="B27">27</xref>].</p><fig position="float" id="F6"><label>Figure 6</label><caption><p>Results of the TF-map alignment of the human promoter of the <italic>Myoglobin </italic>gene and the orthologs in mouse, chicken and zebrafish. Here, the 500 nucleotides upstream of the annotated TSS have been considered (with position 1 corresponding to -500). Each row contains the aligned occurrences of the same TF at the TF-maps of some species (only the starting position of the binding site is shown). Gaps are represented with the symbol "-". A graphical representation of the TF-map alignment is shown in Figure 8.</p></caption><graphic xlink:href="1471-2105-8-138-6"/></fig></sec></sec><sec><title>Results</title><p>The optimal MMA of a set of TF-maps is obviously dependant on the values of the <italic>&#x003b1;</italic>, <italic>&#x003bb;</italic>, <italic>&#x003bc;</italic>, <italic>&#x003b3; </italic>and <italic>c </italic>parameters. In addition, the optimal parameter configuration is likely to depend on the particular problem to be addressed (orthologous genes or co-regulated genes in microarray experiments), and the particular protocol to map the TFBSs on the sequences.</p><p>Results in a previous work [<xref ref-type="bibr" rid="B9">9</xref>] indicated that TF-maps alignments are able to characterize promoter regions of co-regulated genes even in absence of sequence similarity. Thus, TF-map alignments were shown to detect high-order regulatory signals conserved in a collection of related promoters that were undetectable with current sequence alignment methods. It is important to mention that two or more different TFBSs can be aligned if and only if they correspond to the same TF, even though they may not show sequence similarity.</p><p>Here we have conducted a similar systematic training over an extended set of orthologous promoters to obtain the optimal parameter configuration. In order to verify the ability of MMA to identify regulatory elements that are rarely detected in conventional comparisons, we have compared the results to those obtained by several multiple sequence alignment methods. We have focused on two specific examples to show the abilities of MMA in the characterization of multiple collinear related promoters. Finally, we have characterized non-collinear arrangements of TFBSs on an early developmental enhancer conserved in several species of <italic>Drosophila</italic>.</p><sec><title>Multiple TF-map training</title><p>For the pairwise TF-map alignment, we estimated the optimal parameters in a set of experimentally characterized human and rodent gene promoters [<xref ref-type="bibr" rid="B9">9</xref>,<xref ref-type="bibr" rid="B13">13</xref>]. Here we have extended such a dataset by searching the corresponding orthologs in chicken and zebrafish as well. Using the RefSeq [<xref ref-type="bibr" rid="B28">28</xref>] gene set as mapped into the UCSC genome browser, we have correctly identified the ortholog in both species, if available. We refer to the resulting set of human-mouse-chicken-zebrafish homologous genes as the HRCZ SET. This dataset contains 18 human-rodent-chicken-zebrafish orthologs, 7 human-rodent-chicken orthologs, 4 human-rodent-zebrafish orthologs, and 7 human-rodent orthologs.</p><p>The lack of available collections of experimentally verified TFBSs is an important limitation for the evaluation and the training of phylogenetic footprinting systems. Despite several databases of annotations and promoter sequences have recently appeared [<xref ref-type="bibr" rid="B13">13</xref>,<xref ref-type="bibr" rid="B29">29</xref>], there is not enough regulatory information conserved among species other than human and mouse to train the MMA.</p><p>Thus, we can not repeat the training procedure used in [<xref ref-type="bibr" rid="B9">9</xref>] to evaluate the ability of MMA to detect conserved regulatory elements at larger evolutionary distances &#x02013; at which the degree of conservation may be negligible. However, we can use another method also presented in [<xref ref-type="bibr" rid="B9">9</xref>] to show that MMAs are much more informative than primary multiple sequence alignments.</p><p>We first have mapped the TFBSs occurrences in the promoter sequences using the collection of 50 most informatives matrices in JASPAR 1.0 [<xref ref-type="bibr" rid="B14">14</xref>]. In a previous work [<xref ref-type="bibr" rid="B9">9</xref>], we observed a substantial gain of specificity in the detection of real TFBSs (without a significant loss of sensitivity) when using such a subset of matrices instead of the entire JASPAR collection. The original frequency coefficients of the matrices were converted before into log-likelihood ratios, to which we referred as JASPAR<sub><italic>TOP</italic>50 </sub>in [<xref ref-type="bibr" rid="B9">9</xref>], using the random equiprobability distribution as a background model. A prediction obtained with a given PWM from JASPAR<sub><italic>TOP</italic>50 </sub>was accepted if it had a score above 50% of the maximum possible score for such matrix [<xref ref-type="bibr" rid="B23">23</xref>].</p><p>Then, we have compared the MMAs obtained in the 200 nucleotides of the promoter region of the 36 gene pairs from the HRCZ SET, with the MMAs obtained using the same mapping function in fragments of 200 nucleotides from intergenic (2000 nucleotides upstream of the TSS, 2000 nucleotides downstream the transcript), 5'UTR (downstream of the TSS), 3'UTR (upstream the end of the transcript), coding (downstream of the translation start site and considering only coding DNA), intronic (downstream of the first intron junction), and downstream (downstream of the transcription termination site) sequences (see Figure <xref ref-type="fig" rid="F7">7</xref> for a graphical representation of the test).</p><fig position="float" id="F7"><label>Figure 7</label><caption><p>Graphical representation of the MMA training. For multiple combinations of <italic>&#x003b1;</italic>, <italic>&#x003bb;</italic>, <italic>&#x003bc; </italic>and <italic>&#x003b3;</italic>, we have compared the multiple TF-map alignments obtained in the proximal promoter regions from the HRCZ SET (200 nucleotides), with the alignments obtained in fragments of 200 nucleotides from intergenic (2000 nucleotides upstream of the TSS and 2000 nucleotides downstream of the transcript), 5'UTR (downstream of the TSS), 3'UTR (upstream of the end of the transcript), coding (downstream of the translation start site and considering only coding DNA), intronic (downstream of the first intron junction), and downstream (downstream of the transcription termination site) sequences.</p></caption><graphic xlink:href="1471-2105-8-138-7"/></fig><p>We have computed the average score of the MMA on each one of the genomic regions, identifying the alignment that produces the highest score for each orthologous set. We have repeated this test using different combinations of parameters. Systematically, the parameters <italic>&#x003b1;</italic>, <italic>&#x003bb;</italic>, and <italic>&#x003bc; </italic>were allowed to independently take values between 0.0 and 1.0, in incremental steps of 0.1. At the same time, the parameter <italic>&#x003b3; </italic>(gap penalty) was tested between 0 and -10 with a step of -1. The optimal parameter configuration is considered to be that set of parameter values that better discriminate between promoters and the rest of genomic regions.</p><p>We have also performed the multiple sequence alignments of the same regions using the following programs (see [<xref ref-type="bibr" rid="B30">30</xref>] for a comprehensive review on DNA sequence alignment): CLUSTALW [<xref ref-type="bibr" rid="B5">5</xref>], MLAGAN [<xref ref-type="bibr" rid="B31">31</xref>] and FOOTPRINTER [<xref ref-type="bibr" rid="B32">32</xref>]. CLUSTALW and MLAGAN perform global multiple sequence alignment.</p><p>FOOTPRINTER performs local multiple sequence alignment. The number of significant motifs (parsimony score 2) identified by FOOTPRINTER on each gene region was used to rank the alignments of this program.</p><p>Results appear in Table <xref ref-type="table" rid="T1">1</xref>. As expected, nucleotide sequence alignments score the highest in the coding regions (in 27 out of 36 cases for CLUSTALW, 26 and 23 cases for MLAGAN and FOOTPRINTER respectively), followed by the alignments in the 5'UTRs (4 out of 36 for CLUSTALW, 4 and 3 for MLAGAN and FOOTPRINTER) and in the promoters (4 out of 36 for CLUSTALW, 4 and 5 for MLAGAN and FOOTPRINTER). Only in one case, the 3'UTR was the most conserved region among orthologs (in three cases for FOOTPRINTER). The scores of the sequence alignments indicate that promoter regions are less conserved than coding regions.</p><table-wrap position="float" id="T1"><label>Table 1</label><caption><p>Multiple alignment results in orthologous sequences</p></caption><table frame="hsides" rules="groups"><thead><tr><td align="left">HRCZ SET</td><td align="center" colspan="2">MMA</td><td align="center" colspan="2">CLUSTALW</td><td align="center" colspan="2">MLAGAN</td><td align="center" colspan="2">FOOTPRINTER</td></tr></thead><tbody><tr><td></td><td align="right">TOP1</td><td align="right">Avg.Score</td><td align="right">TOP1</td><td align="right">Avg. score</td><td align="right">TOP1</td><td align="right">Avg. score</td><td align="right">TOP1</td><td align="right">Avg. Motifs</td></tr><tr><td colspan="9"><hr></hr></td></tr><tr><td align="left">Coding</td><td align="right">6</td><td align="right">17.15</td><td align="right">27</td><td align="right">3706.72</td><td align="right">26</td><td align="right">3739.58</td><td align="right">23</td><td align="right">20.41</td></tr><tr><td align="left">5'UTR</td><td align="right">2</td><td align="right">10.48</td><td align="right">4</td><td align="right">2671.78</td><td align="right">4</td><td align="right">2742.92</td><td align="right">3</td><td align="right">11.66</td></tr><tr><td align="left">Promoter</td><td align="right">18</td><td align="right">25.41</td><td align="right">4</td><td align="right">2005.67</td><td align="right">4</td><td align="right">2114.00</td><td align="right">5</td><td align="right">8.66</td></tr><tr><td align="left">3'UTR</td><td align="right">7</td><td align="right">15.85</td><td align="right">1</td><td align="right">1994.22</td><td align="right">1</td><td align="right">2046.31</td><td align="right">3</td><td align="right">9.63</td></tr><tr><td align="left">Intronic</td><td align="right">2</td><td align="right">8.34</td><td align="right">0</td><td align="right">1267.89</td><td align="right">0</td><td align="right">1268.42</td><td align="right">1</td><td align="right">3.00</td></tr><tr><td align="left">Downstream</td><td align="right">0</td><td align="right">6.85</td><td align="right">0</td><td align="right">1174.28</td><td align="right">1</td><td align="right">1245.47</td><td align="right">1</td><td align="right">2.02</td></tr><tr><td align="left">5'Intergenic</td><td align="right">0</td><td align="right">5.42</td><td align="right">0</td><td align="right">1052.92</td><td align="right">0</td><td align="right">1092.28</td><td align="right">0</td><td align="right">0.75</td></tr><tr><td align="left">3'Intergenic</td><td align="right">1</td><td align="right">4.14</td><td align="right">0</td><td align="right">974.69</td><td align="right">0</td><td align="right">1027.58</td><td align="right">0</td><td align="right">0.44</td></tr></tbody></table><table-wrap-foot><p>TF-map and sequence alignments (CLUSTALW [5], MLAGAN [31], FOOTPRINTER [32]) of different genomic regions between the human, mouse, chicken and zebrafish orthologous promoters in the HRCZ SET. TOP1 is the number of genes in which the highest scoring alignment is found in a given genomic region. The MMA results were obtained with the optimal configuration <italic>&#x003b1; </italic>= 1; <italic>&#x003bb; </italic>= 0.3; <italic>&#x003bc; </italic>= 0.1; <italic>&#x003b3; </italic>= 2.</p></table-wrap-foot></table-wrap><p>Despite this, the optimal collinear MMA configuration [<italic>&#x003b1; </italic>= 1, <italic>&#x003bb; </italic>= 0.3, <italic>&#x003bc; </italic>= 0.1, <italic>&#x003b3; </italic>= -2] scores the highest in the promoter regions (in 18 out of 36, see Table <xref ref-type="table" rid="T1">1</xref>). In addition, the average score of map alignments is notably higher than that of the coding regions (25.41 against 17.15). Only in 6 out of 36 cases the TF-map alignments score the highest in coding regions. Interestingly, while 3'UTR sequences in the human-mouse-chicken-zebrafish orthologs are much less conserved than coding regions or 5'UTRs, MMAs score the highest in them in 7 cases. This is consistent with recent investigations about the existence of regulatory motifs in the 3'UTR regions of the genes [<xref ref-type="bibr" rid="B33">33</xref>]. A similar result is obtained in the case of introns: intronic sequences are much less conserved than coding and UTR sequences. However, MMAs score the highest in intronic regions in 2 cases. This fact is noticeable as first introns are also known to often contain regulatory motifs [<xref ref-type="bibr" rid="B34">34</xref>,<xref ref-type="bibr" rid="B35">35</xref>].</p><p>We have also performed a complementary test to measure the specificity of the TF-map alignments. As a negative control, we have shuffled the orthologous associations in the HRCZ SET to construct a pool of 36 unrelated human-mouse-chicken-zebrafish gene entries. Then, the corresponding multiple TF-map alignments of these non-orthologous paired promoters were obtained using the parameters previously optimized. Results appear in Table <xref ref-type="table" rid="T2">2</xref>. The TF-map alignments of unrelated promoters were significantly worse with an average score more than 50% smaller than TF-map alignments that involved "bona fide" orthologous promoters. For instance, the average score of the TF-map alignments among orthologous promoters when using the JASPAR<sub><italic>TOP</italic>50 </sub>collection was 25.41 (see Table <xref ref-type="table" rid="T2">2</xref>). In contrast, the score of the TF-map alignments between non-related promoters was 9.91. The sites in the alignments involving non-orthologous gene promoters may correspond to general regulatory elements present in most core promoters of our dataset.</p><table-wrap position="float" id="T2"><label>Table 2</label><caption><p>Specificity of the TF-map alignments</p></caption><table frame="hsides" rules="groups"><thead><tr><td align="left">MMA ON HRCZ SET</td><td align="right">Avg</td><td align="right">Avg*</td><td align="right">Max</td><td align="right">Max*</td></tr></thead><tbody><tr><td align="left">Coding</td><td align="right">17.15</td><td align="right">4.66</td><td align="right">62.60</td><td align="right">31.37</td></tr><tr><td align="left">5'UTR</td><td align="right">10.48</td><td align="right">3.60</td><td align="right">35.74</td><td align="right">26.16</td></tr><tr><td align="left">Promoter</td><td align="right">25.41</td><td align="right">9.91</td><td align="right">71.22</td><td align="right">46.18</td></tr><tr><td align="left">3'UTR</td><td align="right">15.85</td><td align="right">7.23</td><td align="right">76.31</td><td align="right">50.51</td></tr><tr><td align="left">Intronic</td><td align="right">8.34</td><td align="right">3.53</td><td align="right">48.60</td><td align="right">22.39</td></tr><tr><td align="left">Downstream</td><td align="right">6.85</td><td align="right">4.88</td><td align="right">24.91</td><td align="right">24.10</td></tr><tr><td align="left">5'Intergenic</td><td align="right">5.42</td><td align="right">3.65</td><td align="right">21.36</td><td align="right">24.12</td></tr><tr><td align="left">3'Intergenic</td><td align="right">4.14</td><td align="right">4.53</td><td align="right">35.70</td><td align="right">25.40</td></tr></tbody></table><table-wrap-foot><p>Comparison between average and maximum scores of TF-map alignments of several regions from orthologous genes from the HRCZ SET and average and maximum scores of TF-map alignments of several regions from randomly shuffled genes from the HRCZ SET (denoted as *, see main text for details).</p></table-wrap-foot></table-wrap><p>To validate this hypothesis, we have analyzed the composition of the TF-map alignments of non-orthologous gene promoters. We have detected an enrichment in TATA and CAAT boxes (20% and 10% of the aligned sites, respectively), which are well known to be part of core promoters. Such a bias is not observed in the composition of the alignments of the coding sequences of unrelated genes. These alignments are therefore partially capturing common regulatory elements present in unrelated gene promoters of our dataset. In addition, we also found an overrepresentation (25% of the aligned sites) of TFs mainly expressed in the liver (HNF3, COUP-TF, HNF1). Such a trend is not detected in the composition of the alignments of the coding sequences of non-related genes. This enrichment correlates well with the composition of the HRCZ SET, which contains experimental regulatory annotations from liver-specific genes (e.g. [<xref ref-type="bibr" rid="B36">36</xref>] and [<xref ref-type="bibr" rid="B37">37</xref>]; see [<xref ref-type="bibr" rid="B9">9</xref>] for further details).</p><p>We have performed an additional test to assess the significance of the scores of the MMAs. The previous tests have involved alignments of orthologous gene regions of the same type (e.g. four promoters or four coding segments). We have compared now the score of the MMAs among orthologous promoters of the same gene in the HRCZ SET with the scores of the alignments of the same maps in which one TF-map was randomly substituted by the TF-map of another segment of the same gene (denoted in Table <xref ref-type="table" rid="T3">3</xref> as <italic>PPPS</italic>, where <italic>P </italic>is a promoter map and <italic>S </italic>is any gene region: Coding, Promoter, Intronic, 5'UTR, 3'UTR, intergenic, downstream).</p><table-wrap position="float" id="T3"><label>Table 3</label><caption><p>Significance of the TF-map alignment scores</p></caption><table frame="hsides" rules="groups"><thead><tr><td></td><td align="center" colspan="8">S</td></tr></thead><tbody><tr><td></td><td align="right">Promoter</td><td align="right">Coding</td><td align="right">5'UTR</td><td align="right">3'UTR</td><td align="right">Intronic</td><td align="right">Downstream</td><td align="right">5'Intergenic</td><td align="right">3'Intergenic</td></tr><tr><td colspan="9"><hr></hr></td></tr><tr><td align="left"><italic>PPPS</italic></td><td align="right">25.41</td><td align="right">10.06</td><td align="right">7.43</td><td align="right">5.36</td><td align="right">10.54</td><td align="right">10.84</td><td align="right">10.84</td><td align="right">10.77</td></tr><tr><td align="left"><italic>PPSS</italic></td><td align="right">25.41</td><td align="right">9.79</td><td align="right">5.03</td><td align="right">5.24</td><td align="right">7.50</td><td align="right">6.31</td><td align="right">4.98</td><td align="right">5.61</td></tr><tr><td align="left"><italic>P</italic><sub><italic>H</italic></sub><italic>S</italic><sub><italic>R</italic></sub></td><td align="right">42.00</td><td align="right">5.80</td><td align="right">5.04</td><td align="right">2.49</td><td align="right">4.57</td><td align="right">5.79</td><td align="right">4.64</td><td align="right">3.63</td></tr></tbody></table><table-wrap-foot><p>Average score of multiple TF-map alignments of groups constituted of orthologous promoters from the HRCZ SET (denoted as <italic>P</italic>), introducing one or two non-corresponding orthologous sequences (denoted as <italic>S</italic>). Last row shows the average score of pairwise TF-map alignments that involve each human promoter (<italic>P</italic><sub><italic>H</italic></sub>) and the corresponding rodent region of the same gene (<italic>S</italic><sub><italic>R</italic></sub>) in the HRCZ SET.</p></table-wrap-foot></table-wrap><p>Results appear in Table <xref ref-type="table" rid="T3">3</xref>. The average score of MMAs exclusively constituted by promoter maps was 25.41 (<italic>PPP + </italic>Promoter in Table <xref ref-type="table" rid="T3">3</xref>). Indeed, the average score of the MMAs involving only promoter maps was more than 60% higher than alignments in which one of them was substituted by another gene region map (e.g. 10.06 for <italic>PPP + </italic>Coding in Table <xref ref-type="table" rid="T3">3</xref>). The average score of such alignments dropped even more when a second substitution was permitted (see Table <xref ref-type="table" rid="T3">3</xref>).</p><p>Finally, we analyzed the scores of pairwise TF-map alignments between each human promoter in the HRCZ SET (<italic>P</italic><sub><italic>H</italic></sub>) and the corresponding orthologous gene regions (<italic>S</italic><sub><italic>R</italic></sub>) in mouse. The average score of the TF-map alignments involving the two promoters was substantially higher (42.00) than any other incorrect combination (e.g. 5.80 for human promoter-mouse coding region alignments). These results show that orthologous promoter-promoter TF-map alignments are more significant than alignments of any other combination of gene region maps.</p></sec><sec><title>Promoter characterization</title><p>We have selected three particular examples that show the ability of MMAs to characterize promoter regions in the absence of sequence conservation. In all cases, we have compared the multiple TF-map alignment to the corresponding multiple sequence alignments, as in the section above, to measure their accuracy to detect the TFBSs experimentally annotated on these promoters.</p><sec><title>Actin <italic>&#x003b1;</italic>-cardiac gene</title><p>Actins are highly conserved proteins that are involved in various types of cell motility. The alpha actins are found in muscle tissues and are a major constituent of the contractile apparatus. The <italic>Actin &#x003b1;-cardiac </italic>gene has been identified in many kinds of cells including muscle, where it is a major constituent of the thin filament, and platelets [<xref ref-type="bibr" rid="B38">38</xref>].</p><p>The promoter of the human and mouse <italic>Actin &#x003b1;-cardiac </italic>genes (ACTC, GenBank: <ext-link ext-link-type="gen" xlink:href="M13483">M13483</ext-link>, <ext-link ext-link-type="gen" xlink:href="M26773">M26773</ext-link>) has been extensively characterized by experimental means [<xref ref-type="bibr" rid="B39">39</xref>]. In the ABS database [<xref ref-type="bibr" rid="B13">13</xref>], the entry <italic>A</italic>0028 includes the known orthologous binding sites in the respective human and mouse promoters (500 nucleotides, the position +501 is the TSS). The human ACTC promoter is constituted of three SRF sites (+301, +352, +392), a SP1 site (+418), and a TATA box (+469).</p><p>Using the RefSeq gene annotations [<xref ref-type="bibr" rid="B28">28</xref>], we have also identified the corresponding orthologous promoters in chicken and zebrafish (RefSeq: NM_001031229, NM_214784).</p><p>We have then aligned the four promoters and compared the resulting MMA with the functional annotations in the ABS database. In general, the multiple TF-map alignment of the four orthologous promoters of ACTC contains many of the known functional sites in human and mouse, detecting as well the corresponding orthologs in the other species.</p><p>The MMA of the ACTC promoters and the experimental evidence are shown in Figure <xref ref-type="fig" rid="F8">8</xref> (top). While the region proximal to the TSS is not more dense in predicted TFBSs than other regions, most of the aligned elements cluster next to the near TSS. In addition, the alignment agrees well with the functional annotation available in human and mouse, providing novel orthologous sites in chicken and zebrafish:</p><fig position="float" id="F8"><label>Figure 8</label><caption><p>On top, the JASPAR predictions on the human-mouse-chicken-zebrafish promoters of the <italic>Actin &#x003b1;-cardiac </italic>gene (ACTC, GENBANK: <ext-link ext-link-type="gen" xlink:href="M13483">M13483</ext-link> and <ext-link ext-link-type="gen" xlink:href="M26773">M26773</ext-link>, RefSeq: NM 001031229 and NM 214784), the resulting MMA and the experimental evidence. At bottom, the JASPAR predictions on the human-mouse-chicken-zebrafish promoters of the <italic>Myoglobin </italic>gene (MB, GENBANK: <ext-link ext-link-type="gen" xlink:href="X00371">X00371</ext-link>, RefSeq: NM 013593, NM 203377 and NM 200586), the resulting MMA and the experimental evidence. In both cases, the TF-map alignment represents a considerable noise reduction which has biological relevance, as most experimentally annotated TFBSs in these promoters are successfully covered by the MMAs (see main text). Both graphical representations have been produced with the program gff2ps [27].</p></caption><graphic xlink:href="1471-2105-8-138-8"/></fig><p>1. The second SRF binding site is correctly identified in human, mouse and also in zebrafish.</p><p>2. A RREB-1 site that overlaps the SP-1 active site is identified in the MMA. RREB-1 and SP-1 are members of the zinc finger protein family with different binding specificities. However, the consensus of both matrices in JASPAR are very similar, being constituted of several occurrences of the motif CCCC [<xref ref-type="bibr" rid="B14">14</xref>].</p><p>3. A SQUA site that overlaps the third SRF active site is identified in the MMA. SQUA and SRF are both members of the MADS family [<xref ref-type="bibr" rid="B14">14</xref>].</p><p>4. A novel forth SRF binding site is located immediately upstream of the experimental first one at the four species.</p><p>5. The TATA box is correctly detected in human, mouse and zebrafish as well.</p><p>No significant conservation among the sequences was, however, detected in the multiple sequence alignment of the four ACTC promoters (see the alignments in the Supplementary Information).</p></sec><sec><title>Myoglobin gene</title><p>The <italic>Myoglobin </italic>gene is a member of the globin superfamily and is expressed in skeletal and cardiac muscles. The encoded protein is an haemoprotein contributing to intracellular oxygen storage and transcellular facilitated diffusion of oxygen [<xref ref-type="bibr" rid="B40">40</xref>].</p><p>The promoter of the <italic>Myoglobin </italic>gene in human (MB, GenBank: <ext-link ext-link-type="gen" xlink:href="X00371">X00371</ext-link>) and in mouse (RefSeq: NM_013593) has been experimentally characterized [<xref ref-type="bibr" rid="B39">39</xref>,<xref ref-type="bibr" rid="B41">41</xref>]. In the ABS database [<xref ref-type="bibr" rid="B13">13</xref>], the entry A0037 includes the known orthologous binding sites in the respective human and mouse promoters (500 nucleotides, the position +501 is the TSS). The human MB promoter is constituted of a CCAC box (+272), a MEF-2 site (+335) with two surrounding E-boxes (+326, +348) and a TATA box (+469). Using the RefSeq gene annotations [<xref ref-type="bibr" rid="B28">28</xref>], we have also identified the corresponding orthologous promoters in chicken and zebrafish (RefSeq: NM_203377, NM_200586).</p><p>We have then aligned the four promoters and compared the resulting MMA with the functional annotations detailed above. The multiple TF-map alignment of the four orthologous promoters of MB contains several of the functional sites in human and mouse, detecting some of the orthologs in the other two species. The output coverage is again very small.</p><p>The MMA of the MB promoters and the experimental evidence are shown in Figure <xref ref-type="fig" rid="F8">8</xref> (bottom). Most of the aligned elements are present next to the TSS, while this spatial trend is not observable in the predictions at each promoter. The alignment also contains several of the functional human and mouse sites, providing their counterparts in chicken and zebrafish:</p><p>1. A RREB-1 site that overlaps the functional CCAC box is identified in the MMA. In fact, the RREB-1 matrix consensus in JASPAR represents an A/C rich area that contains the CCAC motif [<xref ref-type="bibr" rid="B14">14</xref>].</p><p>2. The TATA box is correctly detected in the four species.</p><p>The multiple sequence alignment of the four MP promoters did not reveal any significant conservation (see the alignments in the Supplementary Information).</p></sec><sec><title>Even-skipped stripe 2 enhancer</title><p>Proximal promoters are adjacent to the gene. Enhancers, however, are other type of regulatory regions (typically 500 &#x02013; 1,000 nucleotides long) positioned several kilobases upstream or downstream of the regulated gene. Such elements can function in either orientation, being distance and position independent [<xref ref-type="bibr" rid="B42">42</xref>]. The regulatory logic of enhancers is different from the promoters, allowing a great plasticity in the arrangement of the TFBSs (e.g. non-collinearity [<xref ref-type="bibr" rid="B22">22</xref>]). Enhancers are constituted of multiple binding sites to recruit four or five different TFs that define space and time specific aspects of gene expression [<xref ref-type="bibr" rid="B43">43</xref>]).</p><p>The body patterning of early embryo in <italic>Drosophila </italic>is governed by a hierarchy of maternal and zygotic genes. In particular, maternal and gap gene factors together control pair rule gene expression in 7 alternating stripes, which in turn regulate segment polarity and homeotic gene expression in 14 stripes [<xref ref-type="bibr" rid="B44">44</xref>]. The stripe 2 enhancer of the pair-rule gene <italic>Even-skipped </italic>has been experimentally characterized in several species of <italic>Drosophila</italic>, showing considerable evolutionary change in the binding site composition and spacing [<xref ref-type="bibr" rid="B45">45</xref>]. Such annotations have been extensively used to train several computational regulatory module prediction approaches [<xref ref-type="bibr" rid="B46">46</xref>-<xref ref-type="bibr" rid="B48">48</xref>].</p><p>The stripe 2 enhancer of the <italic>Even-skipped </italic>gene (EVE, GenBank: <ext-link ext-link-type="gen" xlink:href="AF042709">AF042709</ext-link> (<italic>D. melanogaster</italic>), <ext-link ext-link-type="gen" xlink:href="AF042710">AF042710</ext-link> (<italic>D. yakuba</italic>), <ext-link ext-link-type="gen" xlink:href="AF042711">AF042711</ext-link> (<italic>D. erecta</italic>), <ext-link ext-link-type="gen" xlink:href="AF042712">AF042712</ext-link> (<italic>D. pseudoobscura</italic>)) is governed by 17 TFBSs of four TFs [<xref ref-type="bibr" rid="B45">45</xref>]: 2 activators (bicoid and hunchback) and 2 repressors (giant and Kruppel). We have obtained from TRANSFAC 8.4 [<xref ref-type="bibr" rid="B16">16</xref>] the PWMs to recognize bicoid (I$BCD_01), hunchback (I$HB_01) and Kruppel sites (I$KR_01). We will focus therefore only on the occurrences for these three TFs. The positions of the experimentally verified binding sites in the <italic>Drosophila melanogaster </italic>enhancer are [<xref ref-type="bibr" rid="B45">45</xref>]: bicoid (+138, +159, +310, +403, +521), hunchback (+496, +578, +661) and Kruppel (+3, +139, +327, +521, +571, +615). We have obtained the TF-maps of bicoid, hunchback and Kruppel in these enhancers (threshold score 50%). We have then aligned the four enhancer maps allowing non-collinear rearrangement in the alignments (parameter c = 1, see Section Non-collinear TF-map alignments). We have compared the resulting MMA with the available functional annotations. Matches to one of the elements in overlapping sites for activators/repressors are considered to be correct. The MMA of the four orthologous enhancers and the experimental evidence are shown in Figure <xref ref-type="fig" rid="F9">9</xref>.</p><fig position="float" id="F9"><label>Figure 9</label><caption><p>The TRANSFAC predictions of bicoid (in green), hunchback (in blue) and Kruppel (in yellow) zygotic factors on the stripe 2 enhancer of the <italic>Even-skipped </italic>gene in <italic>D. melanogaster</italic>, <italic>D. yakuba</italic>, <italic>D. erecta </italic>and <italic>D. pseudoobscura </italic>(EVE, GenBank: <ext-link ext-link-type="gen" xlink:href="AF042709">AF042709</ext-link>, <ext-link ext-link-type="gen" xlink:href="AF042710">AF042710</ext-link>, <ext-link ext-link-type="gen" xlink:href="AF042711">AF042711</ext-link> and <ext-link ext-link-type="gen" xlink:href="AF042712">AF042712</ext-link>), the resulting MMA and the experimental evidence. The TF-map alignment agrees well with the experimental annotation of the enhancer in <italic>D. melanogaster</italic>, as most experimentally annotated TFBSs are successfully covered by the MMAs. Non-collinear rearrangements in the MMA are denoted with a red square (see main text). The graphical representation of the maps and the alignments has been produced with the program gff2ps [27].</p></caption><graphic xlink:href="1471-2105-8-138-9"/></fig><p>Despite we trained our algorithm specifically on human-mouse-chicken-zebrafish genes (vertebrates), the MMA of the four <italic>Drosophila </italic>enhancers still agrees well with the regulatory annotation available for <italic>Drosophila melanogaster</italic>, providing the orthologous known sites in the other species and two additional putative non-collinear rearrangements (see Figure <xref ref-type="fig" rid="F9">9</xref>):</p><p>1. Five out of six known Kruppel sites are correctly identified in the four enhancers.</p><p>2. Three out of five known bicoid sites are identified in the four enhancers.</p><p>3. Two out of the three hunchback sites are identified.</p><p>The MMA contains a non-collinear rearrangement between the HB1 site and the KR1 site in <italic>D. erecta </italic>(see Figure <xref ref-type="fig" rid="F9">9</xref>). The HB1 site is not detected in <italic>D. erecta </italic>and <italic>D. pseudoobscura </italic>in the conventional sequence alignment of the four enhancers [<xref ref-type="bibr" rid="B45">45</xref>]. Non-collinearity is also observed between the BC2 site and a hypothetical Kruppel site predicted in <italic>D. pseudoobscura</italic>.</p></sec></sec></sec><sec><title>Discussion</title><p>Among the many codes that shape the sequence of the genomes, the one regulating their transcriptional activity remains remarkably elusive. Indeed, it is usually impossible to infer the specific spatial and temporal expression pattern of a given genomic locus simply from the analysis of the sequences presumably involved in its regulation. It is well known that the initiation of the transcription by RNA Polymerase II requires the interaction between this enzyme and a number of TFs that bind to the DNA sequence in the promoter region upstream of the transcription initiation site. While transcription factors bind short DNA motifs on the promoter region, these motifs are often degenerated, and their effective recognition by the factors is dependent on the structural conformation of the region harboring them.</p><p>As a result of these and other circumstances, the relation between primary sequence and regulatory code is far from being trivial. Indeed, recent genome-wide studies based on chromatin immunoprecipitation (ChIP) of DNA bound by promoter-associated proteins, followed by either direct sequencing of the bound region or hybridization in a tiling array (ChIP-chip [<xref ref-type="bibr" rid="B49">49</xref>-<xref ref-type="bibr" rid="B51">51</xref>]) underlined the complexity of this relationship. Often no occupancy by a given TF has been experimentally detected for many genomic sites where binding motifs can be computationally predicted [<xref ref-type="bibr" rid="B52">52</xref>,<xref ref-type="bibr" rid="B53">53</xref>]. Therefore, promoter regions of genes sharing similar expression programs often do not show nucleotide sequence conservation.</p><p>To overcome this limitation, we introduced recently a novel approach based on abstracting the nucleotide sequence of gene promoters and replacing it by a sequence of labels, each label denoting, at a specific location on the primary sequence, the TF for which a known binding site has been predicted. We used the term TF-maps for denoting such sequences of labels [<xref ref-type="bibr" rid="B9">9</xref>]. Pairwise alignments between TF-maps can occasionally reveal underlying configurations of TFBSs shared by co-regulated genes, which escape detection by typical nucleotide sequence comparisons.</p><p>Here, we introduce the multiple TF-map alignments. Multiple comparisons increase the power to detect the underlying features common across the compared elements by increasing the signal to noise ratio. Multiple sequence comparisons, in particular, have been used to identify regulatory motifs and coding exons in genomic sequences [<xref ref-type="bibr" rid="B54">54</xref>,<xref ref-type="bibr" rid="B55">55</xref>]. The rationale is that since the probability of mutation is lower in functional than in non-functional regions, by increasing the number of sequences in the comparisons, nucleotide divergence increases in non-functional regions proportionally more than in functional ones, producing a sharper contrast in the sequence conservation landscape [<xref ref-type="bibr" rid="B56">56</xref>,<xref ref-type="bibr" rid="B57">57</xref>]. A similar rationale can be applied to the multiple-TF map alignments. TF-maps, obtained usually through computational predictions of binding sites, contain many non-functional elements (i.e. false positive hits). One expects that, among multiple TF-maps corresponding to genes with similar expression patterns, only the functional elements (i.e. the "bona fide" TFBSs) will be conserved.</p><p>Indeed, as we have shown, the main effect of the multiple map alignments (MMA) is the dramatic reduction in the number of predicted TFBSs that typically result after a PWM-based search (see Figure <xref ref-type="fig" rid="F8">8</xref>). For instance, we aligned 157 human sites to 197 mouse sites, 229 chicken sites and 167 zebrafish sites mapped in the respective <italic>Actin &#x003b1;-cardiac </italic>gene promoter orthologs. The resulting multiple TF-map alignment included only 14 TFBSs, which approximately represents a 13-fold reduction. In addition, most aligned sites in the MMAs are concentrated in the proximal promoter region of each gene (200 nucleotides upstream of the TSS). This gain in specificity is not simply due to the selection of an arbitrary set of non-overlapping TFBSs, since many experimentally annotated TFBSs on these promoters are successfully covered by the resulting MMAs.</p><p>We have trained our approach on a human-mouse-chicken-zebrafish dataset mostly constituted of tissue-specific genes, because of the enrichment of such a promoter class in the regulatory annotation literature [<xref ref-type="bibr" rid="B36">36</xref>,<xref ref-type="bibr" rid="B39">39</xref>]. A recent study states, however, that the classical TATA-box promoter architecture of such genes represents a minority of the set of mammalian promoters in human and mouse [<xref ref-type="bibr" rid="B58">58</xref>]. The structure of TATA-independent promoters occurring within a CpG island is more flexible and evolvable. We consider, however, the evaluation of the MMA presented here is still correct as our approach does not distinguish the TATA-box and the other core promoter elements from the rest of TFs during the alignment. MMAs can therefore also deal with flexible regulatory rearrangements (see the TF-map characterization of the <italic>Even-skipped </italic>stripe 2 enhancer). In addition, in a previous study the TF-map alignments showed to be also effective in more general regulatory datasets that contained both classes of promoters [<xref ref-type="bibr" rid="B9">9</xref>]. Map alignments were introduced in the early 1980s to compare restriction enzyme maps [<xref ref-type="bibr" rid="B59">59</xref>]. Several improvements on the basic pairwise algorithm were developed since then [<xref ref-type="bibr" rid="B60">60</xref>] but this is the first time a multiple alignment implementation is proposed. In practice, guaranteeing the optimal solution to the multiple sequence comparison problem is difficult. Our approach is based on the progressive alignment paradigm, which produces not necessarily optimal alignments despite the results are biologically meaningful [<xref ref-type="bibr" rid="B4">4</xref>]. Here we have generalized the data structures and algorithms shown in a previous work for the pairwise comparison [<xref ref-type="bibr" rid="B9">9</xref>], to deal with multiple maps without adding supplementary complexity. Thus, the cost of the final implementation is proportional to the number of pairwise comparisons performed by the progressive approach.</p><p>In addition, we have redefined the way in which the dynamic programming matrix is processed in order to capture non-collinear configurations in the maps of regulatory elements. We have shown an example in which non-collinearity helps to find rearrangements of TFBSs that can not be detected using a conventional linear approach. Despite it is actually very difficult to train the non-collinear algorithm due to the lack of abundant experimental annotations, we believe this kind of approach will be very important in the future as collinearity can not be always assumed in regulatory regions [<xref ref-type="bibr" rid="B12">12</xref>].</p><p>The TF-map alignments are able to unveil characteristic regulatory patterns that are difficult to be detected at the sequence level. To test this hypothesis, we have used collections of position weight matrices as external mapping functions. However, the TF-map alignment algorithm can also deal with other kind of regulatory maps as those produced by pattern discovery programs. For instance, we have used the MEME program [<xref ref-type="bibr" rid="B17">17</xref>] to discover novel motifs (number of motifs: 20, minimum site length: 6, maximum site length:15) in the promoters of the <italic>Actin &#x003b1;-cardiac </italic>and <italic>Myoglobin </italic>genes. We have then performed the MMA of such patterns. The input motifs and the resulting alignment in both cases are shown in Figure <xref ref-type="fig" rid="F10">10</xref>. Such an approach can be useful to enrich the results obtained when the same promoters are aligned using JASPAR (see Figure <xref ref-type="fig" rid="F8">8</xref>).</p><fig position="float" id="F10"><label>Figure 10</label><caption><p>On top, the MEME novel patterns discovered on the human-mouse-chicken-zebrafish promoters of the <italic>Actin &#x003b1;-cardiac </italic>gene, the resulting MMA and the experimental evidence. MEME motifs in the alignment supported by real sites: (Motif2, GACCAAATAAGGCAA, SRF), (Motif4, GGCAGGGGAGAGGAT, SP1), (Motif10, TATAAAG, TBP). At bottom, the MEME patterns on the human-mouse-chicken-zebrafish promoters of the <italic>Myoglobin </italic>gene, the resulting MMA and the experimental evidence. MEME motifs in the alignment supported by real sites: (Motif5, TATAAAA, TBP). The motifs are displayed as boxes along the promoter. MEME motifs were obtained with these parameters: -nmotifs 20 -minw 6 -maxw 15. Both graphical representations have been produced with the program gff2ps [27].</p></caption><graphic xlink:href="1471-2105-8-138-10"/></fig><p>While here we have focused on TF-maps, the algorithms and software that we have developed can also be applied, in principle, to any other problem in which the primary sequence can be annotated with higher-order features (that is, it can be mapped into a sequence of labels denoting these features). Thus, comparisons between the annotations (instead of primary sequences) can reveal more biological clues. Examples could include comparisons between exons/introns that have been annotated with matches to binding motifs for splicing regulatory factors [<xref ref-type="bibr" rid="B61">61</xref>]. The MMAs, in this case, could reveal classes of exons whose splicing is regulated in a similar way. Or comparisons between protein sequences which have been annotated with functional (PFAM, [<xref ref-type="bibr" rid="B62">62</xref>]) or structural domains. The MMAs could help here to infer functional super-families. Or comparisons between entire genomes, which have been annotated with the biological functions (for instance, using Gene Ontology (GO) terms [<xref ref-type="bibr" rid="B63">63</xref>] of the genes across the genomes). The MMAs could help to investigate whether function and chromosomal localization are related.</p></sec><sec><title>Conclusion</title><p>In general, as the functionality of the primary sequence becomes better understood, more innovative alignment techniques between higher-order representations of the sequences, such as the approach we presented here, will become increasingly useful to uncover the features that underlie common functionality.</p></sec><sec><title>Authors' contributions</title><p>EB, RG and XM conceived and designed the experiments. EB performed the experiments. EB, RG and XM analyzed the data. RG contributed reagents/material/analysis tools. EB, RG and XM wrote the paper.</p></sec></body><back><ack><sec><title>Acknowledgements</title><p>We thank Josep F. Abril, Miguel Pignatelli and Arnaud Kerhornou for useful suggestions about the multiple map alignment software. This work was supported by grant BIO2003-05073 from the Spanish Ministerio de Ciencia y Tecnologia to RG.</p></sec></ack><ref-list><ref id="B1"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Needleman</surname><given-names>SB</given-names></name><name><surname>Wunsch</surname><given-names>CD</given-names></name></person-group><article-title>A general method to search for similarities in the amino acid sequence of two proteins</article-title><source>Journal of Molecular Biology</source><year>1970</year><volume>48</volume><fpage>443</fpage><lpage>453</lpage><pub-id pub-id-type="pmid">5420325</pub-id><pub-id pub-id-type="doi">10.1016/0022-2836(70)90057-4</pub-id></citation></ref><ref id="B2"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Sellers</surname><given-names>P</given-names></name></person-group><article-title>On the theory and computation of evolutionary distances</article-title><source>SIAM Journal of Applied Mathematics</source><year>1974</year><volume>26</volume><fpage>787</fpage><lpage>793</lpage><pub-id pub-id-type="doi">10.1137/0126070</pub-id></citation></ref><ref id="B3"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Waterman</surname><given-names>M</given-names></name><name><surname>Smith</surname><given-names>T</given-names></name><name><surname>Beyer</surname><given-names>W</given-names></name></person-group><article-title>Some biological sequence metrics</article-title><source>Advances in Mathematics</source><year>1976</year><volume>20</volume><fpage>367</fpage><lpage>387</lpage><pub-id pub-id-type="doi">10.1016/0001-8708(76)90202-4</pub-id></citation></ref><ref id="B4"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Feng</surname><given-names>D</given-names></name><name><surname>Doolittle</surname><given-names>R</given-names></name></person-group><article-title>Progressive sequence alignment as a prerequisite to correct phylogenetic trees</article-title><source>Journal of Molecular Evolution</source><year>1987</year><volume>25</volume><fpage>351</fpage><lpage>360</lpage><pub-id pub-id-type="pmid">3118049</pub-id><pub-id pub-id-type="doi">10.1007/BF02603120</pub-id></citation></ref><ref id="B5"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Thompson</surname><given-names>JD</given-names></name><name><surname>Higgins</surname><given-names>DG</given-names></name><name><surname>Gibson</surname><given-names>TJ</given-names></name></person-group><article-title>CLUSTALW: improving the sensitivity of progressive multiple sequence alignment through sequence weighting, position-specific gap penalties and weight matrix choice</article-title><source>Nucleic Acids Research</source><year>1994</year><volume>22</volume><fpage>4673</fpage><lpage>4680</lpage><pub-id pub-id-type="pmid">7984417</pub-id><pub-id pub-id-type="doi">10.1093/nar/22.22.4673</pub-id></citation></ref><ref id="B6"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Wray</surname><given-names>GA</given-names></name><name><surname>Hahn</surname><given-names>MW</given-names></name><name><surname>Abouheif</surname><given-names>E</given-names></name><name><surname>Balhoff</surname><given-names>JP</given-names></name><name><surname>Pizer</surname><given-names>M</given-names></name><name><surname>Rockman</surname><given-names>MV</given-names></name><name><surname>Romano</surname><given-names>LA</given-names></name></person-group><article-title>The evolution of transcriptional regulation in eukaryotes</article-title><source>Molecular biology and evolution</source><year>2003</year><volume>20</volume><fpage>1377</fpage><lpage>1419</lpage><pub-id pub-id-type="pmid">12777501</pub-id><pub-id pub-id-type="doi">10.1093/molbev/msg140</pub-id></citation></ref><ref id="B7"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Pennacchio</surname><given-names>L</given-names></name><name><surname>Rubin</surname><given-names>E</given-names></name></person-group><article-title>Genomic strategies to identify mammalian regulatory sequences</article-title><source>Nature Reviews Genetics</source><year>2001</year><volume>2</volume><fpage>100</fpage><lpage>109</lpage><pub-id pub-id-type="pmid">11253049</pub-id><pub-id pub-id-type="doi">10.1038/35052548</pub-id></citation></ref><ref id="B8"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Michelson</surname><given-names>A</given-names></name></person-group><article-title>Deciphering genetic regulatory codes: a challenge for functional genomics</article-title><source>PNAS</source><year>2002</year><volume>99</volume><fpage>546</fpage><lpage>548</lpage><pub-id pub-id-type="pmid">11805309</pub-id><pub-id pub-id-type="doi">10.1073/pnas.032685999</pub-id></citation></ref><ref id="B9"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Blanco</surname><given-names>E</given-names></name><name><surname>Messeguer</surname><given-names>X</given-names></name><name><surname>Smith</surname><given-names>T</given-names></name><name><surname>Guig&#x000f3;</surname><given-names>R</given-names></name></person-group><article-title>Transcription Factor Map Alignment of Promoter Regions</article-title><source>PLoS Computational Biology</source><year>2006</year><volume>2</volume><fpage>e49</fpage><pub-id pub-id-type="pmid">16733547</pub-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.0020049</pub-id></citation></ref><ref id="B10"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Brudno</surname><given-names>M</given-names></name><name><surname>Malde</surname><given-names>S</given-names></name><name><surname>Poliakov</surname><given-names>A</given-names></name><name><surname>Chuong</surname><given-names>B</given-names></name><name><surname>Couronne</surname><given-names>O</given-names></name><name><surname>Dubchak</surname><given-names>I</given-names></name><name><surname>Batzoglou</surname><given-names>S</given-names></name></person-group><article-title>Glocal alignment: finding rearrangements during alignment</article-title><source>Bioinformatics</source><year>2004</year><volume>19</volume><fpage>i54</fpage><lpage>i62</lpage><pub-id pub-id-type="pmid">12855437</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/btg1005</pub-id></citation></ref><ref id="B11"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Darling</surname><given-names>A</given-names></name><name><surname>Mau</surname><given-names>B</given-names></name><name><surname>Blattner</surname><given-names>F</given-names></name><name><surname>Perna</surname><given-names>N</given-names></name></person-group><article-title>Mauve: multiple alignment of conserved genomic sequence with rearrangements</article-title><source>Genome Research</source><year>2004</year><volume>14</volume><fpage>1394</fpage><lpage>1403</lpage><pub-id pub-id-type="pmid">15231754</pub-id><pub-id pub-id-type="doi">10.1101/gr.2289704</pub-id></citation></ref><ref id="B12"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Sanges</surname><given-names>R</given-names></name><name><surname>Kalmar</surname><given-names>E</given-names></name><name><surname>Claudiani</surname><given-names>P</given-names></name><name><surname>D'Amato</surname><given-names>M</given-names></name><name><surname>Muller</surname><given-names>F</given-names></name><name><surname>Stupka</surname><given-names>E</given-names></name></person-group><article-title>Shuffling of cis-regulatory elements is a pervasive feature of the vertebrate lineage</article-title><source>Genome Biology</source><year>2006</year><volume>7</volume><fpage>R56</fpage><pub-id pub-id-type="pmid">16859531</pub-id><pub-id pub-id-type="doi">10.1186/gb-2006-7-7-r56</pub-id></citation></ref><ref id="B13"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Blanco</surname><given-names>E</given-names></name><name><surname>Farre</surname><given-names>D</given-names></name><name><surname>Alba</surname><given-names>M</given-names></name><name><surname>Meseguer</surname><given-names>X</given-names></name><name><surname>Guig&#x000f3;</surname><given-names>R</given-names></name></person-group><article-title>ABS: a database of Annotated regulatory Binding Sites from orthologous promoters</article-title><source>Nucleic Acids Research</source><year>2006</year><volume>34</volume><fpage>D63</fpage><lpage>D67</lpage><pub-id pub-id-type="pmid">16381947</pub-id><pub-id pub-id-type="doi">10.1093/nar/gkj116</pub-id></citation></ref><ref id="B14"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Vlieghe</surname><given-names>D</given-names></name><name><surname>Sandelin</surname><given-names>A</given-names></name><name><surname>Bleser</surname><given-names>PD</given-names></name><name><surname>Vleminckx</surname><given-names>K</given-names></name><name><surname>Wasserman</surname><given-names>W</given-names></name><name><surname>Lenhard</surname><given-names>B</given-names></name></person-group><article-title>A new generation of JASPAR, the open-access repository for transcription factor binding site profiles</article-title><source>Nucleic Acids Research</source><year>2006</year><volume>34</volume><fpage>D95</fpage><lpage>D97</lpage><pub-id pub-id-type="pmid">16381983</pub-id><pub-id pub-id-type="doi">10.1093/nar/gkj115</pub-id></citation></ref><ref id="B15"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Farre</surname><given-names>D</given-names></name><name><surname>Roset</surname><given-names>R</given-names></name><name><surname>Huerta</surname><given-names>M</given-names></name><name><surname>Adsuara</surname><given-names>JE</given-names></name><name><surname>Rosello</surname><given-names>L</given-names></name><name><surname>Alba</surname><given-names>M</given-names></name><name><surname>Messeguer</surname><given-names>X</given-names></name></person-group><article-title>Identification of patterns in biological sequences at the ALGGEN server: PROMO and MALGEN</article-title><source>Nucleic Acids Research</source><year>2003</year><volume>31</volume><fpage>3651</fpage><lpage>3653</lpage><pub-id pub-id-type="pmid">12824386</pub-id><pub-id pub-id-type="doi">10.1093/nar/gkg605</pub-id></citation></ref><ref id="B16"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Matys</surname><given-names>V</given-names></name><etal></etal></person-group><article-title>TRANSFAC and its module TRANSCompel: transcriptional gene regulation in eukaryotes</article-title><source>Nucleic Acids Research</source><year>2006</year><volume>34</volume><fpage>D108</fpage><lpage>D110</lpage><pub-id pub-id-type="pmid">16381825</pub-id><pub-id pub-id-type="doi">10.1093/nar/gkj143</pub-id></citation></ref><ref id="B17"><citation citation-type="other"><person-group person-group-type="author"><name><surname>Bailey</surname><given-names>TL</given-names></name><name><surname>Elkan</surname><given-names>C</given-names></name></person-group><article-title>Fitting a mixture model by expectation maximization to discover motifs in biopolymers</article-title><source>ISMB proceedings</source><year>1994</year><fpage>28</fpage><lpage>36</lpage></citation></ref><ref id="B18"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Strachan</surname><given-names>T</given-names></name><name><surname>Read</surname><given-names>A</given-names></name></person-group><source>Human Molecular Genetics 2</source><year>1999</year><publisher-name>John Wiley &#x00026; Sons, Inc. (New York, USA)</publisher-name></citation></ref><ref id="B19"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Werner</surname><given-names>T</given-names></name></person-group><article-title>Models for prediction and recognition of eukaryotic promoters</article-title><source>Mammalian Genome</source><year>1999</year><volume>10</volume><fpage>168</fpage><lpage>175</lpage><pub-id pub-id-type="pmid">9922398</pub-id><pub-id pub-id-type="doi">10.1007/s003359900963</pub-id></citation></ref><ref id="B20"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>L</given-names></name><name><surname>Jiang</surname><given-names>T</given-names></name></person-group><article-title>On the complexity of multiple sequence alignment</article-title><source>Journal of Computational Biology</source><year>1994</year><volume>337</volume><fpage>337</fpage><lpage>348</lpage><pub-id pub-id-type="pmid">8790475</pub-id></citation></ref><ref id="B21"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Sneath</surname><given-names>P</given-names></name><name><surname>Sokal</surname><given-names>R</given-names></name></person-group><source>Numerical taxonomy: the principles and practice of numerical classification</source><year>1973</year><publisher-name>Freeman (San Francisco, USA)</publisher-name></citation></ref><ref id="B22"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Nix</surname><given-names>D</given-names></name><name><surname>Eisen</surname><given-names>M</given-names></name></person-group><article-title>GATA: a graphic alignment tool for comparative sequence analysis</article-title><source>BMC Bioinformatics</source><year>2005</year><volume>6</volume><fpage>9</fpage><pub-id pub-id-type="pmid">15655071</pub-id><pub-id pub-id-type="doi">10.1186/1471-2105-6-9</pub-id></citation></ref><ref id="B23"><citation citation-type="other"><ext-link ext-link-type="uri" xlink:href="http://genome.imim.es/datasets/mmeta2006/index.html"/></citation></ref><ref id="B24"><citation citation-type="other"><ext-link ext-link-type="uri" xlink:href="http://genome.imim.es/software/mmeta/index.html"/></citation></ref><ref id="B25"><citation citation-type="other"><ext-link ext-link-type="uri" xlink:href="http://genome.imim.es/software/mmeta/mmeta.html"/></citation></ref><ref id="B26"><citation citation-type="other"><ext-link ext-link-type="uri" xlink:href="http://www.sanger.ac.uk/Software/formats/GFF/GFF_Spec.shtml"/></citation></ref><ref id="B27"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Abril</surname><given-names>JF</given-names></name><name><surname>Guig&#x000f3;</surname><given-names>R</given-names></name></person-group><article-title>gff2ps: visualizing genomic annotations</article-title><source>Bioinformatics</source><year>2000</year><volume>8</volume><fpage>743</fpage><lpage>744</lpage><pub-id pub-id-type="pmid">11099262</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/16.8.743</pub-id></citation></ref><ref id="B28"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Pruitt</surname><given-names>K</given-names></name><name><surname>Tatusova</surname><given-names>T</given-names></name><name><surname>Maglott</surname><given-names>D</given-names></name></person-group><article-title>NCBI Reference Sequence (RefSeq): a curated non-redundant sequence database of genomes, transcripts and proteins</article-title><source>Nucleic Acids Research</source><year>2004</year><volume>33</volume><fpage>D501</fpage><lpage>D504</lpage><pub-id pub-id-type="pmid">15608248</pub-id><pub-id pub-id-type="doi">10.1093/nar/gki025</pub-id></citation></ref><ref id="B29"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Xuan</surname><given-names>Z</given-names></name><name><surname>Zhao</surname><given-names>F</given-names></name><name><surname>Wang</surname><given-names>J</given-names></name><name><surname>Chen</surname><given-names>G</given-names></name><name><surname>Zhang</surname><given-names>M</given-names></name></person-group><article-title>Genome-wide promoter extraction and analysis in human, mouse, and rat</article-title><source>Genome Biology</source><year>2005</year><volume>6</volume><fpage>R72</fpage><pub-id pub-id-type="pmid">16086854</pub-id><pub-id pub-id-type="doi">10.1186/gb-2005-6-8-r72</pub-id></citation></ref><ref id="B30"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Kumar</surname><given-names>S</given-names></name><name><surname>Filipski</surname><given-names>A</given-names></name></person-group><article-title>Multiple sequence alignment: in pursuit of homologous DNA positions</article-title><source>Genome Research</source><year>2007</year><volume>17</volume><fpage>127</fpage><lpage>135</lpage><pub-id pub-id-type="pmid">17272647</pub-id><pub-id pub-id-type="doi">10.1101/gr.5232407</pub-id></citation></ref><ref id="B31"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Brudno</surname><given-names>M</given-names></name><name><surname>Chuong</surname><given-names>B</given-names></name><name><surname>Cooper</surname><given-names>G</given-names></name><name><surname>Kim</surname><given-names>M</given-names></name><name><surname>Davydov</surname><given-names>E</given-names></name><name><surname>Green</surname><given-names>E</given-names></name><name><surname>Sidow</surname><given-names>A</given-names></name><name><surname>Batzoglou</surname><given-names>S</given-names></name></person-group><article-title>LAGAN and Multi-LAGAN: efficient tools for large-scale multiple alignment of genomic DNA</article-title><source>Genome Research</source><year>2003</year><volume>13</volume><fpage>721</fpage><lpage>731</lpage><pub-id pub-id-type="pmid">12654723</pub-id><pub-id pub-id-type="doi">10.1101/gr.926603</pub-id></citation></ref><ref id="B32"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Blanchette</surname><given-names>M</given-names></name><name><surname>Tompa</surname><given-names>M</given-names></name></person-group><article-title>FootPrinter: a program designed for phylogenetic footprinting</article-title><source>Nucleic Acids Research</source><year>2003</year><volume>31</volume><fpage>3840</fpage><lpage>3842</lpage><pub-id pub-id-type="pmid">12824433</pub-id><pub-id pub-id-type="doi">10.1093/nar/gkg606</pub-id></citation></ref><ref id="B33"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Xie</surname><given-names>X</given-names></name><name><surname>Lu</surname><given-names>L</given-names></name><name><surname>Kulbokas</surname><given-names>E</given-names></name><name><surname>Golub</surname><given-names>T</given-names></name><name><surname>Mootha</surname><given-names>V</given-names></name><name><surname>Lindblad-Toh</surname><given-names>K</given-names></name><name><surname>Lander</surname><given-names>E</given-names></name><name><surname>Kellis</surname><given-names>M</given-names></name></person-group><article-title>Systematic discovery of regulatory motifs in human promoters and 3' UTRs by comparison of several mammals</article-title><source>Nature</source><year>2005</year><volume>434</volume><fpage>338</fpage><lpage>345</lpage><pub-id pub-id-type="pmid">15735639</pub-id><pub-id pub-id-type="doi">10.1038/nature03441</pub-id></citation></ref><ref id="B34"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Rippe</surname><given-names>R</given-names></name><name><surname>Lorenzen</surname><given-names>S</given-names></name><name><surname>Brenner</surname><given-names>D</given-names></name><name><surname>Breindl</surname><given-names>M</given-names></name></person-group><article-title>Regulatory elements in the 5'-flanking region and the first intron contribute to transcriptional control of the mouse alpha 1 type I collagen gene</article-title><source>Molecular and cellular biology</source><year>1989</year><volume>9</volume><fpage>2224</fpage><lpage>2227</lpage><pub-id pub-id-type="pmid">2747648</pub-id></citation></ref><ref id="B35"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Rohrer</surname><given-names>J</given-names></name><name><surname>Conley</surname><given-names>M</given-names></name></person-group><article-title>Transcriptional Regulatory Elements Within the First Intron of Bruton's Tyrosine Kinase</article-title><source>Blood</source><year>1998</year><volume>91</volume><fpage>214</fpage><lpage>221</lpage><pub-id pub-id-type="pmid">9414287</pub-id></citation></ref><ref id="B36"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Krivan</surname><given-names>W</given-names></name><name><surname>Wasserman</surname><given-names>WW</given-names></name></person-group><article-title>A predictive model for regulatory sequences detecting liver-specific transcription</article-title><source>Genome Research</source><year>2001</year><volume>11</volume><fpage>1559</fpage><lpage>1566</lpage><pub-id pub-id-type="pmid">11544200</pub-id><pub-id pub-id-type="doi">10.1101/gr.180601</pub-id></citation></ref><ref id="B37"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Lenhard</surname><given-names>B</given-names></name><name><surname>Sandelin</surname><given-names>A</given-names></name><name><surname>Mendoza</surname><given-names>L</given-names></name><name><surname>Engstrom</surname><given-names>P</given-names></name><name><surname>Jareborg</surname><given-names>N</given-names></name><name><surname>Wasserman</surname><given-names>WW</given-names></name></person-group><article-title>Identification of conserved regulatory elements by comprative genome analysis</article-title><source>Journal of Biology</source><year>2003</year><volume>2</volume><fpage>13</fpage><pub-id pub-id-type="pmid">12760745</pub-id><pub-id pub-id-type="doi">10.1186/1475-4924-2-13</pub-id></citation></ref><ref id="B38"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Gunning</surname><given-names>P</given-names></name><name><surname>Ponte</surname><given-names>P</given-names></name><name><surname>Blau</surname><given-names>H</given-names></name><name><surname>Kedes</surname><given-names>L</given-names></name></person-group><article-title>Alpha-skeletal and alpha-cardiac actin genes are coexpressed in adult human skeletal muscle and heart</article-title><source>Molecular and Cellular Biology</source><year>1983</year><volume>3</volume><fpage>1985</fpage><lpage>1995</lpage><pub-id pub-id-type="pmid">6689196</pub-id></citation></ref><ref id="B39"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Wasserman</surname><given-names>WW</given-names></name><name><surname>Fickett</surname><given-names>JW</given-names></name></person-group><article-title>Identification of regulatory regions which confer muscle-specific gene expression</article-title><source>Journal of Molecular Biology</source><year>1998</year><volume>278</volume><fpage>167</fpage><lpage>181</lpage><pub-id pub-id-type="pmid">9571041</pub-id><pub-id pub-id-type="doi">10.1006/jmbi.1998.1700</pub-id></citation></ref><ref id="B40"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Frauenfelder</surname><given-names>H</given-names></name><name><surname>McMahon</surname><given-names>B</given-names></name><name><surname>Fenimore</surname><given-names>P</given-names></name></person-group><article-title>Myoglobin: The hydrogen atom of biology and a paradigm of complexity</article-title><source>PNAS</source><year>2003</year><volume>100</volume><fpage>8615</fpage><lpage>8617</lpage><pub-id pub-id-type="pmid">12861080</pub-id><pub-id pub-id-type="doi">10.1073/pnas.1633688100</pub-id></citation></ref><ref id="B41"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Bassel-Duby</surname><given-names>R</given-names></name><name><surname>Hernandez</surname><given-names>M</given-names></name><name><surname>Gonzalez</surname><given-names>M</given-names></name><name><surname>Krueger</surname><given-names>J</given-names></name><name><surname>Williams</surname><given-names>R</given-names></name></person-group><article-title>A 40-kilodalton protein binds specifically to an upstream sequence element essential for muscle-specific transcription of the human myoglobin promoter</article-title><source>Molecular and Cellular Biology</source><year>1992</year><volume>12</volume><fpage>5024</fpage><lpage>5032</lpage><pub-id pub-id-type="pmid">1406677</pub-id></citation></ref><ref id="B42"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Blackwood</surname><given-names>E</given-names></name><name><surname>Kadonaga</surname><given-names>J</given-names></name></person-group><article-title>Going to the distance: a current view of enhancer action</article-title><source>Science</source><year>1998</year><volume>281</volume><fpage>60</fpage><lpage>63</lpage><pub-id pub-id-type="pmid">9679020</pub-id><pub-id pub-id-type="doi">10.1126/science.281.5373.60</pub-id></citation></ref><ref id="B43"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Arnone</surname><given-names>M</given-names></name><name><surname>Davidson</surname><given-names>E</given-names></name></person-group><article-title>The hardwiring of development: organization and function of genomic regulatory systems</article-title><source>Development</source><year>1997</year><volume>124</volume><fpage>1851</fpage><lpage>1864</lpage><pub-id pub-id-type="pmid">9169833</pub-id></citation></ref><ref id="B44"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Schroeder</surname><given-names>M</given-names></name><name><surname>Pearce</surname><given-names>M</given-names></name><name><surname>Fak</surname><given-names>J</given-names></name><name><surname>Fan</surname><given-names>H</given-names></name><name><surname>Unnerstall</surname><given-names>U</given-names></name><etal></etal></person-group><article-title>Transcriptional control in the segmentation gene network of Drosophila</article-title><source>PLOS biology</source><year>2004</year><volume>2</volume><fpage>e271</fpage><pub-id pub-id-type="pmid">15340490</pub-id><pub-id pub-id-type="doi">10.1371/journal.pbio.0020271</pub-id></citation></ref><ref id="B45"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Ludwig</surname><given-names>M</given-names></name><name><surname>Patel</surname><given-names>N</given-names></name><name><surname>Kreitman</surname><given-names>M</given-names></name></person-group><article-title>Functional analysis of eve stripe 2 enhancer evolution in Drosophila: rules governing conservation and change</article-title><source>Development</source><year>1998</year><volume>125</volume><fpage>949</fpage><lpage>958</lpage><pub-id pub-id-type="pmid">9449677</pub-id></citation></ref><ref id="B46"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Papatsenko</surname><given-names>D</given-names></name><name><surname>Makeev</surname><given-names>V</given-names></name><name><surname>Lifanov</surname><given-names>A</given-names></name><name><surname>Regnier</surname><given-names>M</given-names></name><name><surname>Nazina</surname><given-names>A</given-names></name><name><surname>Desplan</surname><given-names>C</given-names></name></person-group><article-title>Extraction of functional binding sites from unique regulatory regions: the Drosophila early developmental enhancers</article-title><source>Genome Research</source><year>2002</year><volume>12</volume><fpage>470</fpage><lpage>481</lpage><pub-id pub-id-type="pmid">11875036</pub-id><comment>10.1101/gr.212502. Article published online before print in February 2002</comment></citation></ref><ref id="B47"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Rajewsky</surname><given-names>N</given-names></name><name><surname>Vergassola</surname><given-names>M</given-names></name><name><surname>Gaul</surname><given-names>U</given-names></name><name><surname>Siggia</surname><given-names>E</given-names></name></person-group><article-title>Computational detection of genomic cis-regulatory modules applied to body patterning in the early Drosophila embryo</article-title><source>BMC Bioinformatics</source><year>2002</year><volume>3</volume><fpage>30</fpage><pub-id pub-id-type="pmid">12398796</pub-id><pub-id pub-id-type="doi">10.1186/1471-2105-3-30</pub-id></citation></ref><ref id="B48"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Hallikas</surname><given-names>O</given-names></name><name><surname>Palin</surname><given-names>K</given-names></name><name><surname>Sinjushina</surname><given-names>N</given-names></name><name><surname>Rautiainen</surname><given-names>R</given-names></name><name><surname>Partanen</surname><given-names>J</given-names></name><name><surname>Ukkonen</surname><given-names>E</given-names></name><name><surname>Taipale</surname><given-names>J</given-names></name></person-group><article-title>Genome-wide prediction of mammalian enhancers based on analysis of transcription-factor binding affinity</article-title><source>Cell</source><year>2006</year><volume>124</volume><fpage>47</fpage><lpage>59</lpage><pub-id pub-id-type="pmid">16413481</pub-id><pub-id pub-id-type="doi">10.1016/j.cell.2005.10.042</pub-id></citation></ref><ref id="B49"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Bulyk</surname><given-names>M</given-names></name></person-group><article-title>DNA microarray technologies for measuring protein-DNA interactions</article-title><source>Current Opinion in Biotechnology</source><year>2006</year><volume>17</volume><fpage>422</fpage><lpage>430</lpage><pub-id pub-id-type="pmid">16839757</pub-id><pub-id pub-id-type="doi">10.1016/j.copbio.2006.06.015</pub-id></citation></ref><ref id="B50"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Elnitski</surname><given-names>L</given-names></name><name><surname>Jin</surname><given-names>V</given-names></name><name><surname>Farnham</surname><given-names>P</given-names></name><name><surname>Jones</surname><given-names>S</given-names></name></person-group><article-title>Locating mammalian transcription factor binding sites: a survey of computational and experimental techniques</article-title><source>Genome Research</source><year>2006</year><volume>16</volume><fpage>1455</fpage><lpage>1464</lpage><pub-id pub-id-type="pmid">17053094</pub-id><pub-id pub-id-type="doi">10.1101/gr.4140006</pub-id></citation></ref><ref id="B51"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Hoheisel</surname><given-names>J</given-names></name></person-group><article-title>Microarray technology: beyond transcript profiling and genotype analysis</article-title><source>Nature Reviews Genetics</source><year>2006</year><volume>7</volume><fpage>200</fpage><lpage>210</lpage><pub-id pub-id-type="pmid">16485019</pub-id><pub-id pub-id-type="doi">10.1038/nrg1809</pub-id></citation></ref><ref id="B52"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Blanchette</surname><given-names>M</given-names></name><name><surname>Bataille</surname><given-names>A</given-names></name><name><surname>Chen</surname><given-names>X</given-names></name><name><surname>Poitras</surname><given-names>C</given-names></name><name><surname>Laganiere</surname><given-names>J</given-names></name></person-group><article-title>Genome-wide computational prediction of transcriptional regulatory modules reveals new insights into human gene expression</article-title><source>Genome Research</source><year>2006</year><volume>16</volume><fpage>656</fpage><lpage>668</lpage><pub-id pub-id-type="pmid">16606704</pub-id><pub-id pub-id-type="doi">10.1101/gr.4866006</pub-id></citation></ref><ref id="B53"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Martone</surname><given-names>R</given-names></name><name><surname>Euskirchen</surname><given-names>G</given-names></name><name><surname>Bertone</surname><given-names>P</given-names></name><name><surname>Hartman</surname><given-names>S</given-names></name><name><surname>Royce</surname><given-names>T</given-names></name><etal></etal></person-group><article-title>Distribution of NF-kappaB-binding sites across human chromosome 22</article-title><source>PNAS</source><year>2003</year><volume>100</volume><fpage>12247</fpage><lpage>12252</lpage><pub-id pub-id-type="pmid">14527995</pub-id><pub-id pub-id-type="doi">10.1073/pnas.2135255100</pub-id></citation></ref><ref id="B54"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Brown</surname><given-names>N</given-names></name><name><surname>Whittaker</surname><given-names>A</given-names></name><name><surname>Newell</surname><given-names>W</given-names></name><name><surname>Rawlings</surname><given-names>C</given-names></name><name><surname>Beck</surname><given-names>S</given-names></name></person-group><article-title>Identification and analysis of multigene families by comparison of exon fingerprints</article-title><source>Journal of Molecular Biology</source><year>1995</year><volume>249</volume><fpage>342</fpage><lpage>359</lpage><pub-id pub-id-type="pmid">7783198</pub-id><pub-id pub-id-type="doi">10.1006/jmbi.1995.0301</pub-id></citation></ref><ref id="B55"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Gross</surname><given-names>S</given-names></name><name><surname>Brent</surname><given-names>M</given-names></name></person-group><article-title>Using Multiple Alignments to Improve Gene Prediction</article-title><source>Journal of Computational Biology</source><year>2006</year><volume>13</volume><fpage>379</fpage><lpage>393</lpage><pub-id pub-id-type="pmid">16597247</pub-id><pub-id pub-id-type="doi">10.1089/cmb.2006.13.379</pub-id></citation></ref><ref id="B56"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Boffelli</surname><given-names>D</given-names></name><name><surname>McAuliffe</surname><given-names>J</given-names></name><name><surname>Ovcharenko</surname><given-names>D</given-names></name><name><surname>Lewis</surname><given-names>K</given-names></name><name><surname>Ovcharenko</surname><given-names>I</given-names></name><name><surname>Pachter</surname><given-names>L</given-names></name><name><surname>Rubin</surname><given-names>E</given-names></name></person-group><article-title>Phylogenetic shadowing of primate sequences to find functional regions of the human genome</article-title><source>Science</source><year>2003</year><volume>299</volume><fpage>1391</fpage><lpage>1394</lpage><pub-id pub-id-type="pmid">12610304</pub-id><pub-id pub-id-type="doi">10.1126/science.1081331</pub-id></citation></ref><ref id="B57"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Wasserman</surname><given-names>WW</given-names></name><name><surname>Sandelin</surname><given-names>A</given-names></name></person-group><article-title>Applied bioinformatics for the identification of regulatory elements</article-title><source>Nature Reviews Genetics</source><year>2004</year><volume>5</volume><fpage>276</fpage><lpage>286</lpage><pub-id pub-id-type="pmid">15131651</pub-id><pub-id pub-id-type="doi">10.1038/nrg1315</pub-id></citation></ref><ref id="B58"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Carninci</surname><given-names>P</given-names></name><name><surname>Sandelin</surname><given-names>A</given-names></name><name><surname>Lenhard</surname><given-names>B</given-names></name><name><surname>Katayama</surname><given-names>S</given-names></name><name><surname>Shimokawa</surname><given-names>K</given-names></name><etal></etal></person-group><article-title>Genome-wide analysis of mammalian promoter architecture and evolution</article-title><source>Nature Genetics</source><year>2006</year><volume>38</volume><fpage>626</fpage><lpage>635</lpage><pub-id pub-id-type="pmid">16645617</pub-id><pub-id pub-id-type="doi">10.1038/ng1789</pub-id></citation></ref><ref id="B59"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Waterman</surname><given-names>MS</given-names></name><name><surname>Smith</surname><given-names>TF</given-names></name><name><surname>Katcher</surname><given-names>HL</given-names></name></person-group><article-title>Algorithms for restriction map comparisons</article-title><source>Nucleic acids research</source><year>1984</year><volume>12</volume><fpage>237</fpage><lpage>242</lpage><pub-id pub-id-type="pmid">6320090</pub-id><pub-id pub-id-type="doi">10.1093/nar/12.1Part1.237</pub-id></citation></ref><ref id="B60"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Huang</surname><given-names>X</given-names></name><name><surname>Waterman</surname><given-names>MS</given-names></name></person-group><article-title>Dynamic programming algorithms for restriction map comparison</article-title><source>Bioinformatics</source><year>1992</year><volume>8</volume><fpage>511</fpage><lpage>520</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/8.5.511</pub-id></citation></ref><ref id="B61"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Buratti</surname><given-names>E</given-names></name><name><surname>Baralle</surname><given-names>M</given-names></name><name><surname>Baralle</surname><given-names>F</given-names></name></person-group><article-title>Defective splicing, disease and therapy: searching for master checkpoints in exon definition</article-title><source>Nucleic Acids Research</source><year>2006</year><volume>34</volume><fpage>3494</fpage><lpage>3510</lpage><pub-id pub-id-type="pmid">16855287</pub-id><pub-id pub-id-type="doi">10.1093/nar/gkl498</pub-id></citation></ref><ref id="B62"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Bateman</surname><given-names>A</given-names></name><name><surname>Coin</surname><given-names>L</given-names></name><name><surname>Durbin</surname><given-names>R</given-names></name><name><surname>Finn</surname><given-names>R</given-names></name><etal></etal></person-group><article-title>The Pfam protein families database</article-title><source>Nucleic Acids Research</source><year>2004</year><fpage>D138</fpage><lpage>D141</lpage><pub-id pub-id-type="pmid">14681378</pub-id><pub-id pub-id-type="doi">10.1093/nar/gkh121</pub-id></citation></ref><ref id="B63"><citation citation-type="journal"><person-group person-group-type="author"><collab>The Gene Ontology Consortium</collab></person-group><article-title>Gene ontology: tool for the unification of biology</article-title><source>Nature Genetics</source><year>2000</year><volume>25</volume><fpage>25</fpage><lpage>29</lpage><pub-id pub-id-type="pmid">10802651</pub-id><pub-id pub-id-type="doi">10.1038/75556</pub-id></citation></ref></ref-list></back></article> 